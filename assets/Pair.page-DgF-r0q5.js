import{a as ue,_ as ce}from"./TabItem.vue_vue_type_script_setup_true_lang-BZlBrymG.js";import{am as I,aJ as Z,d as D,at as ee,av as z,b as h,o as _,_ as S,e as b,an as q,f as m,m as k,j as R,g as d,k as T,aw as E,h as n,l as C,ai as te,c as $,t as O,ao as Y,u as pe,a as _e,w as me,n as be,aF as ge,aG as ve,ay as he,aI as H}from"./index-eREEKl5L.js";import{b as fe}from"./protocols-DhGlxhY5.js";import{p as ye}from"./util-CVNQ9WdU.js";import{t as W,b as j,f as U,a as A,g as $e,r as w,u as P}from"./timestamp-DcP9Bt_c.js";import{d as De,o as y,s as p,a as x,n as g,e as X,p as G,t as J,c as B,g as N,_ as M}from"./AsyncValue-IM55AzVv.js";import{p as Ce}from"./Pagination-vgbH7lYO.js";import{_ as ae}from"./NoData-DUtGQ1jC.js";import{_ as se}from"./Table-Dbh33w8a.js";import{a as oe,_ as re}from"./UsePagination-DIWvwju_.js";import{u as le}from"./UseRelativeTime-BUBU5iwX.js";import{_ as ne}from"./ChartApex-XJwIL3HG.js";import{c as ie}from"./ChartStylesApex-DbitbQGf.js";import{_ as Q}from"./KPI-CgyzPJO4.js";import{_ as ke}from"./ChartBalances-DdGhx-Md.js";import{u as we,c as Pe,a as Re,_ as Fe,D as qe}from"./UseLightweightChart-D2pZoVZ3.js";import{_ as Te}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-kfvPP31c.js";import{T as Le,u as Ie}from"./UseTabNavigation-C7dDLHud.js";import{a as de}from"./index-BHUplxzx.js";import"./Tooltip-BC3yTzdv.js";const Se=De(["borrow","add_collateral","remove_collateral","repay","redeem","liquidate","leveraged_position","repay_with_collateral"]),Ue=y({token_address:p(),token_symbol:p(),apr:p()}).transform(e=>({tokenAddress:e.token_address,tokenSymbol:e.token_symbol,apr:parseFloat(e.apr)})),Ae=y({date_timestamp:g(),total_collateral:p(),total_underlying:p(),exchange_rate:p(),total_debt:p(),active_positions_count:g(),borrow_limit:p(),utilization_rate:p(),interest_rate:p(),claimable_fees:p(),claimable_other_fees:p(),borrow_cost_apr:p(),base_apr:p(),rewards:x(Ue)}).transform(e=>({time:W(e.date_timestamp),totalCollateral:parseFloat(e.total_collateral),totalUnderlying:parseFloat(e.total_underlying),exchangeRate:parseFloat(e.exchange_rate),totalDebt:parseFloat(e.total_debt),activePositionsCount:e.active_positions_count,borrowLimit:parseFloat(e.borrow_limit),utilizationRate:parseFloat(e.utilization_rate),interestRate:parseFloat(e.interest_rate),claimableFees:parseFloat(e.claimable_fees),claimableOtherFees:parseFloat(e.claimable_other_fees),aprBorrowCost:parseFloat(e.borrow_cost_apr),aprBase:parseFloat(e.base_apr),rewards:e.rewards})),xe=y({snapshots:x(Ae),count:g(),page:g(),total_pages:g()}).transform(e=>({snapshots:e.snapshots,count:e.count,page:e.page,totalPages:e.total_pages})),Be=y({event_type:Se,block_timestamp:g(),tx_hash:p(),block_number:g(),collateral_change:p(),debt_change:p()}).transform(e=>({eventType:e.event_type,blockTime:W(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,collateralChange:parseFloat(e.collateral_change),debtChange:parseFloat(e.debt_change)})),Ne=y({events:x(Be),count:g(),page:g(),total_pages:g()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),Ke=y({block_timestamp:g(),tx_hash:p(),block_number:g(),caller:X,amount:p(),collateral_freed:p(),protocol_fee:p(),debt_reduction:p()}).transform(e=>({blockTime:W(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,caller:e.caller,amount:parseFloat(e.amount),collateralFreed:parseFloat(e.collateral_freed),protocolFee:parseFloat(e.protocol_fee),debtReduction:parseFloat(e.debt_reduction)})),Ve=y({events:x(Ke),count:g(),page:g(),total_pages:g()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),Me=y({block_timestamp:g(),tx_hash:p(),block_number:g(),borrower:X,liquidator:X,collateral_for_liquidator:p(),shares_liquidated:p(),amount_liquidator_to_repay:p()}).transform(e=>({blockTime:W(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,borrower:e.borrower,liquidator:e.liquidator,collateralForLiquidator:parseFloat(e.collateral_for_liquidator),sharesLiquidated:parseFloat(e.shares_liquidated),amountLiquidatorToRepay:parseFloat(e.amount_liquidator_to_repay)})),Ee=y({events:x(Me),count:g(),page:g(),total_pages:g()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),He=y({...B,...J,...G});async function Oe(e,s){const u=N(s),{pair_id:l,...t}=He.parse(e),a=j(t),o=await U(`${u}/v1/pairs/${l}/snapshots${a}`,void 0,s==null?void 0:s.signal);return xe.parse(o)}const ze=y({...B,...J,...G});async function We(e,s){const u=N(s),{pair_id:l,...t}=ze.parse(e),a=j(t),o=await U(`${u}/v1/pairs/${l}/collateral_events${a}`,void 0,s==null?void 0:s.signal);return Ne.parse(o)}const je=y({...B,...J,...G});async function Ge(e,s){const u=N(s),{pair_id:l,...t}=je.parse(e),a=j(t),o=await U(`${u}/v1/pairs/${l}/redemptions${a}`,void 0,s==null?void 0:s.signal);return Ve.parse(o)}const Je=y({...B,...J,...G});async function Qe(e,s){const u=N(s),{pair_id:l,...t}=Je.parse(e),a=j(t),o=await U(`${u}/v1/pairs/${l}/liquidations${a}`,void 0,s==null?void 0:s.signal);return Ee.parse(o)}function Ye(e){const{start:s,end:u}=$e({daysRange:90});return A({queryKey:["pairs-snapshots",e],queryFn:()=>Ce((t,a)=>Oe({...I(e),page:t,per_page:a,start:s,end:u}).then(o=>o.snapshots),1,100)})}function Xe(e){return A({queryKey:["pairs-collateral-events",e],queryFn:()=>We(I(e)),placeholderData:Z})}function Ze(e){return A({queryKey:["pairs-redemptions",e],queryFn:()=>Ge(I(e)),placeholderData:Z})}function et(e){return A({queryKey:["pairs-liquidations",e],queryFn:()=>Qe(I(e)),placeholderData:Z})}const tt={class:"end"},at={key:0,style:{display:"flex",gap:"1ch"}},st={class:"end"},ot={key:0,style:{display:"flex",gap:"1ch"}},rt={class:"end"},lt=["href"],nt=D({__name:"TableCollateralEvents",props:{events:{},count:{},pair:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:s}){const u=s,{page:l,onPage:t}=oe(),a=ee(l,200);z(a,i=>{u("page",i)});const{relativeTime:o}=le(),r=i=>{switch(i.eventType){case"add_collateral":return"Add collateral";case"borrow":return"Borrow";case"remove_collateral":return"Remove collateral";case"repay":return"Repay";case"redeem":return"Redeem";case"liquidate":return"Liquidate";case"leveraged_position":return"Lev. position";case"repay_with_collateral":return"Repay with col"}};return(i,c)=>{const v=re,L=M,F=se,K=ae,f=S;return _(),h(f,{title:"Events"},{actions:b(()=>[d(v,{"items-count":i.count,"items-per-page":10,page:n(l),onPage:n(t)},null,8,["items-count","page","onPage"])]),default:b(()=>[e.events.length>0?(_(),h(F,{key:0,rows:e.events,columns:["Type",{label:"Δ Debt",align:"end"},{label:"Δ Collateral",align:"end"},{label:"Time",align:"end"}]},{row:b(({item:V})=>[m("div",null,k(r(V)),1),m("div",tt,[V.debtChange!==0?(_(),R("div",at,[d(L,{type:"dollar",value:V.debtChange/10**18,precision:2,"show-symbol":!1},null,8,["value"]),T(" "+k(i.pair.tokenDebt.symbol),1)])):q("",!0)]),m("div",st,[V.collateralChange!==0?(_(),R("div",ot,[d(L,{type:"dollar",value:V.collateralChange/10**18,precision:2,"show-symbol":!1},null,8,["value"]),T(" "+k(i.pair.tokenCollateral.symbol),1)])):q("",!0)]),m("div",rt,[m("a",{target:"_blank",href:`https://etherscan.io/tx/${V.txHash}`,onClick:c[0]||(c[0]=E(()=>{},["stop"]))},k(n(o)(V.blockTime.getUTCTimestamp())),9,lt)])]),_:1},8,["rows"])):i.loading?q("",!0):(_(),h(K,{key:1,message:"There are no events"}))]),_:1})}}}),it=C(nt,[["__scopeId","data-v-f018f232"]]),dt={class:"dashboard-grid"},ut=D({__name:"Collateral",props:{pair:{}},setup(e){const s=te(1),{isFetching:u,data:l}=Xe($(()=>({pair_id:e.pair.pairId,page:s.value,per_page:15})));return(t,a)=>{var o,r;return _(),R("div",dt,[d(it,{events:((o=n(l))==null?void 0:o.events)??[],count:((r=n(l))==null?void 0:r.count)??0,loading:n(u),pair:t.pair,onPage:a[0]||(a[0]=i=>s.value=i)},null,8,["events","count","loading","pair"])])}}}),ct=C(ut,[["__scopeId","data-v-ff086716"]]),pt=y({range_label:p(),user_count:g(),total_debt:p()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),_t=y({bins:x(pt),total_users:g(),total_debt:p(),min_ratio:p(),max_ratio:p(),median_ratio:p()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),minRatio:parseFloat(e.min_ratio),maxRatio:parseFloat(e.max_ratio),medianRatio:parseFloat(e.median_ratio)})),mt=y({range_label:p(),user_count:g(),total_debt:p()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),bt=y({bins:x(mt),total_users:g(),total_debt:p(),min_debt:p(),max_debt:p(),median_debt:p()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),minDebt:parseFloat(e.min_debt),maxDebt:parseFloat(e.max_debt),medianDebt:parseFloat(e.median_debt)})),gt=y({leveraged_users_count:g(),non_leveraged_users_count:g(),leveraged_debt:p(),non_leveraged_debt:p(),total_users:g(),total_debt:p(),leveraged_users_percentage:p(),leveraged_debt_percentage:p()}).transform(e=>({leveragedUsersCount:e.leveraged_users_count,nonLeveragedUsersCount:e.non_leveraged_users_count,leveragedDebt:parseFloat(e.leveraged_debt),nonLeveragedDebt:parseFloat(e.non_leveraged_debt),totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),leveragedUsersPercentage:parseFloat(e.leveraged_users_percentage),leveragedDebtPercentage:parseFloat(e.leveraged_debt_percentage)})),vt=y({stats:gt}).transform(e=>({stats:e.stats})),ht=y({range_label:p(),user_count:g(),total_debt:p()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),ft=y({bins:x(ht),total_users:g(),total_debt:p()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt)})),yt=y(B);async function $t(e,s){const u=N(s),{pair_id:l}=yt.parse(e),t=await U(`${u}/v1/health/${l}/leverage_stats`,void 0,s==null?void 0:s.signal);return vt.parse(t)}const Dt=y(B);async function Ct(e,s){const u=N(s),{pair_id:l}=Dt.parse(e),t=await U(`${u}/v1/health/${l}/leverage_distribution`,void 0,s==null?void 0:s.signal);return ft.parse(t)}const kt=y(B);async function wt(e,s){const u=N(s),{pair_id:l}=kt.parse(e),t=await U(`${u}/v1/health/${l}/debt_distribution`,void 0,s==null?void 0:s.signal);return bt.parse(t)}const Pt=y(B);async function Rt(e,s){const u=N(s),{pair_id:l}=Pt.parse(e),t=await U(`${u}/v1/health/${l}/collateral_ratio_distribution`,void 0,s==null?void 0:s.signal);return _t.parse(t)}function Ft(e){return A({queryKey:["health-leverage-stats",e],queryFn:()=>$t(I(e))})}function qt(e){return A({queryKey:["health-leverage-distribution",e],queryFn:()=>Ct(I(e))})}function Tt(e){return A({queryKey:["health-debt-distribution",e],queryFn:()=>wt(I(e))})}function Lt(e){return A({queryKey:["health-collateral-ratio-distribution",e],queryFn:()=>Rt(I(e))})}const It=D({__name:"ChartCollateralRatioDistribution",props:{data:{}},setup(e){const s=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1},stacked:!1},xaxis:{categories:u.value,labels:{formatter:t=>t,rotate:-30,offsetY:10,rotateAlways:!0},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${w(t,0,"dollar")}${P(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const a=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${u.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${a}</div>
                <div><b>Debt:</b></div><div>$${w(o,2,"dollar")}${P(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${w(o/a,2,"dollar")}${P(o/a)}</div>
                </div>`}},legend:{show:!0}})),u=$(()=>{var t;return(((t=e.data)==null?void 0:t.bins)??[]).map(a=>{const[o,r]=a.rangeLabel.split(" - ").map(parseFloat),i=`${Math.round(o*100)}%`,c=`${Math.round(r*100)}%`;return`${i} - ${c}`})}),l=$(()=>{var t,a;return[{name:"Users",type:"column",data:(((t=e.data)==null?void 0:t.bins)??[]).map(o=>o.userCount)},{name:"Debt",type:"line",data:(((a=e.data)==null?void 0:a.bins)??[]).map(o=>o.totalDebt)}]});return(t,a)=>{const o=ne,r=S;return _(),h(r,null,{default:b(()=>[d(o,{options:n(s),series:n(l)},null,8,["options","series"])]),_:1})}}}),St=C(It,[["__scopeId","data-v-022e67af"]]),Ut=D({__name:"ChartDebtDistribution",props:{data:{}},setup(e){const s=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1},stacked:!1},xaxis:{categories:u.value,labels:{formatter:t=>t,rotate:-30,offsetY:10,rotateAlways:!0},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${w(t,0,"dollar")}${P(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const a=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${u.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${a}</div>
                <div><b>Debt:</b></div><div>$${w(o,2,"dollar")}${P(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${w(o/a,2,"dollar")}${P(o/a)}</div>
                </div>`}},legend:{show:!0}})),u=$(()=>{var t;return(((t=e.data)==null?void 0:t.bins)??[]).map(a=>{const[o,r]=a.rangeLabel.split(" - ").map(parseFloat),i=`$${w(o,0,"dollar")}${P(o)}`,c=`$${w(r,0,"dollar")}${P(r)}`;return`${i} - ${c}`})}),l=$(()=>{var t,a;return[{name:"Users",type:"column",data:(((t=e.data)==null?void 0:t.bins)??[]).map(o=>o.userCount)},{name:"Debt",type:"line",data:(((a=e.data)==null?void 0:a.bins)??[]).map(o=>o.totalDebt)}]});return(t,a)=>{const o=ne,r=S;return _(),h(r,null,{default:b(()=>[d(o,{options:n(s),series:n(l)},null,8,["options","series"])]),_:1})}}}),At=C(Ut,[["__scopeId","data-v-73ee7851"]]),xt=D({__name:"ChartLeverageDistribution",props:{data:{}},setup(e){const s=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},zoom:{enabled:!1}},xaxis:{categories:u.value,labels:{formatter:t=>t,rotate:-30},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${w(t,0,"dollar")}${P(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const a=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${u.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${a}</div>
                <div><b>Debt:</b></div><div>$${w(o,2,"dollar")}${P(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${w(o/a,2,"dollar")}${P(o/a)}</div>
                </div>`}},legend:{show:!0}})),u=$(()=>{var t;return(((t=e.data)==null?void 0:t.bins)??[]).map(a=>a.rangeLabel)}),l=$(()=>{var t,a;return[{name:"Users",type:"column",data:(((t=e.data)==null?void 0:t.bins)??[]).map(o=>o.userCount)},{name:"Debt",type:"line",data:(((a=e.data)==null?void 0:a.bins)??[]).map(o=>o.totalDebt)}]});return(t,a)=>{const o=ne,r=S;return _(),h(r,null,{default:b(()=>[d(o,{options:n(s),series:n(l)},null,8,["options","series"])]),_:1})}}}),Bt=C(xt,[["__scopeId","data-v-80deb86d"]]),Nt={class:"kpis"},Kt={class:"kpi-subvalue"},Vt=D({__name:"CollateralRatioKPIs",props:{collateralRatio:{}},setup(e){const s=$(()=>{if(!e.collateralRatio||e.collateralRatio.bins.length===0)return;const u=[...e.collateralRatio.bins].sort((o,r)=>r.userCount-o.userCount)[0],[l,t]=u.rangeLabel.split(" - ").map(parseFloat);return{range:`${Math.round(l*100)}% - ${Math.round(t*100)}%`,users:u.userCount}});return(u,l)=>{var o;const t=M,a=Q;return _(),R("div",Nt,[d(a,{label:"Median Collateral Ratio","has-value":!!((o=u.collateralRatio)!=null&&o.medianRatio)},{default:b(()=>{var r;return[d(t,{type:"percentage",value:(r=u.collateralRatio)!=null&&r.medianRatio?u.collateralRatio.medianRatio*100:"?",precision:2},null,8,["value"])]}),_:1},8,["has-value"]),d(a,{label:"Most Common Collateral Ratio","has-value":!!n(s)},{default:b(()=>{var r,i;return[m("div",null,k(((r=n(s))==null?void 0:r.range)??"N/A"),1),m("div",Kt,[d(t,{value:((i=n(s))==null?void 0:i.users)??"?",precision:0},null,8,["value"]),l[0]||(l[0]=T(" users "))])]}),_:1},8,["has-value"])])}}}),Mt=C(Vt,[["__scopeId","data-v-cd75baa0"]]),Et={class:"kpis"},Ht=D({__name:"DebtKPIs",props:{debt:{}},setup(e){return(s,u)=>{var a,o;const l=M,t=Q;return _(),R("div",Et,[d(t,{label:"Max Debt","has-value":!!((a=s.debt)!=null&&a.maxDebt)},{default:b(()=>{var r;return[d(l,{type:"dollar",value:(r=s.debt)==null?void 0:r.maxDebt,precision:2,"show-symbol":!1},null,8,["value"])]}),_:1},8,["has-value"]),d(t,{label:"Median Debt","has-value":!!((o=s.debt)!=null&&o.medianDebt)},{default:b(()=>{var r;return[d(l,{type:"dollar",value:(r=s.debt)==null?void 0:r.medianDebt,precision:2,"show-symbol":!1},null,8,["value"])]}),_:1},8,["has-value"])])}}}),Ot=C(Ht,[["__scopeId","data-v-8ffe283b"]]),zt={class:"kpis"},Wt={class:"kpi-subvalue"},jt={class:"kpi-subvalue"},Gt={class:"kpi-subvalue"},Jt={class:"kpi-subvalue"},Qt=D({__name:"LeverageKPIs",props:{leverage:{},leverageStats:{}},setup(e){const s=$(()=>{if(!e.leverage||e.leverage.bins.length===0)return;const l=[...e.leverage.bins].sort((t,a)=>a.userCount-t.userCount)[0];return{range:l.rangeLabel,users:l.userCount}}),u=$(()=>{if(!e.leverage||e.leverage.bins.length===0)return;const l=[...e.leverage.bins].sort((t,a)=>a.totalDebt-t.totalDebt)[0];return{range:l.rangeLabel,debt:l.totalDebt}});return(l,t)=>{var r,i;const a=M,o=Q;return _(),R("div",zt,[d(o,{label:"Most Common Range","has-value":!!n(s)},{default:b(()=>{var c,v;return[m("div",null,k(((c=n(s))==null?void 0:c.range)??"N/A"),1),m("div",Wt,[d(a,{value:((v=n(s))==null?void 0:v.users)??"?",precision:0},null,8,["value"]),t[0]||(t[0]=T(" users "))])]}),_:1},8,["has-value"]),d(o,{label:"Highest Debt Range","has-value":!!n(u)},{default:b(()=>{var c,v;return[m("div",null,k((c=n(u))==null?void 0:c.range),1),m("div",jt,[d(a,{type:"dollar",value:(v=n(u))==null?void 0:v.debt,precision:2},null,8,["value"])])]}),_:1},8,["has-value"]),d(o,{label:"Leveraged Users","has-value":!!((r=l.leverageStats)!=null&&r.stats)},{default:b(()=>{var c,v;return[d(a,{value:(c=l.leverageStats)==null?void 0:c.stats.leveragedUsersCount,precision:0},null,8,["value"]),m("div",Gt,[d(a,{type:"percentage",value:(v=l.leverageStats)==null?void 0:v.stats.leveragedUsersPercentage,precision:2},null,8,["value"]),t[1]||(t[1]=T(" of total "))])]}),_:1},8,["has-value"]),d(o,{label:"Leveraged Debt","has-value":!!((i=l.leverageStats)!=null&&i.stats)},{default:b(()=>{var c,v;return[d(a,{type:"dollar",value:(c=l.leverageStats)==null?void 0:c.stats.leveragedDebt,precision:2,"show-symbol":!1},null,8,["value"]),m("div",Jt,[d(a,{type:"percentage",value:(v=l.leverageStats)==null?void 0:v.stats.leveragedDebtPercentage,precision:2},null,8,["value"]),t[2]||(t[2]=T(" of total "))])]}),_:1},8,["has-value"])])}}}),Yt=C(Qt,[["__scopeId","data-v-ae4a0874"]]),Xt={class:"dashboard-grid"},Zt=D({__name:"Health",props:{pair:{}},setup(e){const{isFetching:s,data:u}=qt(O(()=>({pair_id:e.pair.pairId}))),{isFetching:l,data:t}=Tt(O(()=>({pair_id:e.pair.pairId}))),{data:a}=Ft(O(()=>({pair_id:e.pair.pairId}))),{isFetching:o,data:r}=Lt(O(()=>({pair_id:e.pair.pairId})));return(i,c)=>(_(),R("div",Xt,[c[0]||(c[0]=m("div",{style:{"grid-area":"title-leverage-distribution"},class:"title"}," Leverage Distribution ",-1)),d(Yt,{style:{"grid-area":"kpis-leverage"},leverage:n(u),"leverage-stats":n(a)},null,8,["leverage","leverage-stats"]),d(Bt,{style:{"grid-area":"chart-leverage-distribution"},data:n(u),loading:n(s)},null,8,["data","loading"]),c[1]||(c[1]=m("div",{style:{"grid-area":"title-debt-distribution"},class:"title"}," Debt Distribution ",-1)),d(Ot,{style:{"grid-area":"kpis-debt"},debt:n(t)},null,8,["debt"]),d(At,{style:{"grid-area":"chart-debt-distribution"},data:n(t),loading:n(l)},null,8,["data","loading"]),c[2]||(c[2]=m("div",{style:{"grid-area":"title-collateral-ratio-distribution"},class:"title"}," Collateral Ratio Distribution ",-1)),d(Mt,{style:{"grid-area":"kpis-collateral-ratio"},"collateral-ratio":n(r)},null,8,["collateral-ratio"]),d(St,{style:{"grid-area":"chart-collateral-ratio-distribution"},data:n(r),loading:n(o)},null,8,["data","loading"])]))}}),ea=C(Zt,[["__scopeId","data-v-aa4d047e"]]),ta=["href"],aa=["href"],sa={class:"end"},oa={class:"end"},ra={class:"end"},la={class:"end"},na=["href"],ia=D({__name:"TableLiquidations",props:{liquidations:{},count:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:s}){const u=s,{page:l,onPage:t}=oe(),a=ee(l,200);z(a,r=>{u("page",r)});const{relativeTime:o}=le();return(r,i)=>{const c=re,v=M,L=se,F=ae,K=S;return _(),h(K,{title:"Liquidations"},{actions:b(()=>[d(c,{"items-count":r.count,"items-per-page":10,page:n(l),onPage:n(t)},null,8,["items-count","page","onPage"])]),default:b(()=>[e.liquidations.length>0?(_(),h(L,{key:0,rows:e.liquidations,columns:["Borrower","Liquidator",{label:"Shares liquidated",align:"end"},{label:"Collat for liquidator",align:"end"},{label:"Amount to repay (reUSD)",align:"end"},{label:"Time",align:"end"}]},{row:b(({item:f})=>[m("div",null,[m("a",{target:"_blank",href:`https://etherscan.io/address/${f.borrower}`,onClick:i[0]||(i[0]=E(()=>{},["stop"]))},k(f.borrower.ens||("addressShort"in r?r.addressShort:n(Y))(f.borrower.address)),9,ta)]),m("div",null,[m("a",{target:"_blank",href:`https://etherscan.io/address/${f.liquidator}`,onClick:i[1]||(i[1]=E(()=>{},["stop"]))},k(f.liquidator.ens||("addressShort"in r?r.addressShort:n(Y))(f.liquidator.address)),9,aa)]),m("div",sa,[d(v,{type:"dollar",value:f.sharesLiquidated/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),m("div",oa,[d(v,{type:"dollar",value:f.collateralForLiquidator/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),m("div",ra,[d(v,{type:"dollar",value:f.amountLiquidatorToRepay/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),m("div",la,[m("a",{target:"_blank",href:`https://etherscan.io/tx/${f.txHash}`,onClick:i[2]||(i[2]=E(()=>{},["stop"]))},k(n(o)(f.blockTime.getUTCTimestamp())),9,na)])]),_:1},8,["rows"])):r.loading?q("",!0):(_(),h(F,{key:1,message:"There are no liquidations"}))]),_:1})}}}),da=C(ia,[["__scopeId","data-v-f3133012"]]),ua={class:"dashboard-grid"},ca=D({__name:"Liquidations",props:{pair:{}},setup(e){const s=te(1),{isFetching:u,data:l}=et($(()=>({pair_id:e.pair.pairId,page:s.value,per_page:15})));return(t,a)=>{var o,r;return _(),R("div",ua,[d(da,{liquidations:((o=n(l))==null?void 0:o.events)??[],count:((r=n(l))==null?void 0:r.count)??0,loading:n(u),onPage:a[0]||(a[0]=i=>s.value=i)},null,8,["liquidations","count","loading"])])}}}),pa=C(ca,[["__scopeId","data-v-0dd6af85"]]),_a={style:{display:"flex"}},ma={ref:"chartRef",class:"chart"},ba=D({__name:"ChartTvl",props:{tvl:{}},setup(e){const s=pe(),u=_e("card"),{chart:l,series:t}=we({createChartOptions:Re(),series:Pe({name:"tvl",color:$(()=>s.value.colors.blue),formatter:o=>`$${w(o,1,"dollar")}${P(o)}`})});me(a);function a(){if(!l.value||!t.tvl)return;const o=e.tvl.map(r=>({time:r.timestamp.getUTCTimestamp(),value:r.tvl})).uniqWith((r,i)=>r.time===i.time).orderBy(r=>r.time,"asc");o.length>0&&t.tvl.setData(o),l.value.timeScale().fitContent()}return(o,r)=>{const i=Te,c=Fe,v=S;return _(),h(v,{ref_key:"card",ref:u,title:"TVL"},{actions:b(()=>[m("div",_a,[d(i,{filename:"tvl",series:n(t)},null,8,["series"]),d(c,{chart:n(l),target:n(u)},null,8,["chart","target"])])]),default:b(()=>[m("div",ma,null,512)]),_:1},512)}}}),ga={class:"kpis"},va={class:"two-sides"},ha=D({__name:"OverviewKPIs",props:{pair:{}},setup(e){return(s,u)=>{const l=M,t=Q;return _(),R("div",ga,[d(t,{label:"Positions","has-value":!!s.pair},{default:b(()=>{var a;return[d(l,{precision:0,value:(a=s.pair)==null?void 0:a.activePositionsCount},null,8,["value"])]}),_:1},8,["has-value"]),d(t,{label:"TVL","has-value":!!s.pair},{default:b(()=>{var a;return[d(l,{type:"dollar",precision:2,value:(a=s.pair)==null?void 0:a.totalUnderlying,"show-symbol":!1},null,8,["value"]),T(" "+k(s.pair.tokenPairUnderyling.symbol),1)]}),_:1},8,["has-value"]),d(t,{label:"Debt","has-value":!!s.pair},{default:b(()=>{var a;return[d(l,{type:"dollar",precision:2,value:(a=s.pair)==null?void 0:a.totalDebt,"show-symbol":!1},null,8,["value"]),T(" "+k(s.pair.tokenDebt.symbol),1)]}),_:1},8,["has-value"]),d(t,{label:"Borrow Rate / Reward Rate","has-value":!!s.pair},{default:b(()=>{var a;return[m("div",va,[d(l,{type:"percentage",precision:2,value:(a=s.pair)==null?void 0:a.aprBorrowCost},null,8,["value"]),d(Le,{pair:s.pair},null,8,["pair"])])]}),_:1},8,["has-value"]),d(t,{label:"Utilization Rate","has-value":!!s.pair},{default:b(()=>{var a;return[d(l,{type:"percentage",precision:2,value:(a=s.pair)==null?void 0:a.utilizationRate},null,8,["value"])]}),_:1},8,["has-value"])])}}}),fa=C(ha,[["__scopeId","data-v-0b31edc7"]]),ya={class:"dashboard-grid"},$a=D({__name:"Overview",props:{pair:{}},setup(e){const{isFetching:s,data:u}=Ye(O(()=>({pair_id:e.pair.pairId}))),l=$(()=>(u.value??[]).map(a=>({timestamp:a.time,tvl:a.totalUnderlying}))),t=$(()=>{const a=(u.value??[]).filter(i=>i.rewards.length>0),o=a.map(i=>({timestamp:i.time,apr:i.aprBase,tokenAddress:"0x0",tokenSymbol:"Base APR"})),r=a.flatMap(i=>i.rewards.map(c=>({...c,timestamp:i.time})));return o.concat(r).groupBy(i=>i.tokenAddress).entries().filter(([,i])=>i.length>0&&i.sumBy(c=>c.apr)/i.length>=1).map(([,i])=>({symbol:i[0].tokenSymbol,balances:i.map(c=>({timestamp:c.timestamp,balance:c.apr,tokenPrice:1}))}))});return(a,o)=>{const r=ke,i=S;return _(),R("div",ya,[d(fa,{style:{"grid-area":"kpis"},pair:a.pair},null,8,["pair"]),d(ba,{style:{"grid-area":"tvl"},tvl:n(l),loading:n(s)},null,8,["tvl","loading"]),n(s)?(_(),h(i,{key:1,loading:"",title:"APR",style:be(`grid-area: apr; min-height: ${n(qe)}`)},null,8,["style"])):(_(),h(r,{key:0,style:{"grid-area":"apr"},title:"APR",balances:n(t),"show-dollars":!1},null,8,["balances"]))])}}}),Da=C($a,[["__scopeId","data-v-ed0ef6db"]]),Ca=["href"],ka={class:"end"},wa={class:"end"},Pa={class:"end",style:{display:"flex",gap:"1ch"}},Ra={class:"end"},Fa={class:"end"},qa=["href"],Ta=D({__name:"TableRedemptions",props:{redemptions:{},count:{},pair:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:s}){const u=s,{page:l,onPage:t}=oe(),a=ee(l,200);z(a,r=>{u("page",r)});const{relativeTime:o}=le();return(r,i)=>{const c=re,v=M,L=se,F=ae,K=S;return _(),h(K,{title:"Redemptions"},{actions:b(()=>[d(c,{"items-count":r.count,"items-per-page":10,page:n(l),onPage:n(t)},null,8,["items-count","page","onPage"])]),default:b(()=>[e.redemptions.length>0?(_(),h(L,{key:0,rows:e.redemptions,columns:["Caller",{label:"reUSD",align:"end"},{label:"Debt reduction",align:"end"},{label:"Collateral freed",align:"end"},{label:"Protocol fee",align:"end"},{label:"Time",align:"end"}]},{row:b(({item:f})=>[m("div",null,[m("a",{target:"_blank",href:`https://etherscan.io/address/${f.caller}`,onClick:i[0]||(i[0]=E(()=>{},["stop"]))},k(f.caller.ens||("addressShort"in r?r.addressShort:n(Y))(f.caller.address)),9,Ca)]),m("div",ka,[d(v,{type:"dollar",value:f.amount/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),m("div",wa,[d(v,{type:"dollar",value:f.debtReduction/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),m("div",Pa,[d(v,{type:"dollar",value:f.collateralFreed/10**18,precision:2,"show-symbol":!1},null,8,["value"]),T(" "+k(r.pair.tokenCollateral.symbol),1)]),m("div",Ra,[d(v,{type:"dollar",value:f.protocolFee/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),m("div",Fa,[m("a",{target:"_blank",href:`https://etherscan.io/tx/${f.txHash}`,onClick:i[1]||(i[1]=E(()=>{},["stop"]))},k(n(o)(f.blockTime.getUTCTimestamp())),9,qa)])]),_:1},8,["rows"])):r.loading?q("",!0):(_(),h(F,{key:1,message:"There are no redemptions"}))]),_:1})}}}),La=C(Ta,[["__scopeId","data-v-bbc74a72"]]),Ia={class:"dashboard-grid"},Sa=D({__name:"Redemptions",props:{pair:{}},setup(e){const s=te(1),{isFetching:u,data:l}=Ze($(()=>({pair_id:e.pair.pairId,page:s.value,per_page:15})));return(t,a)=>{var o,r;return _(),R("div",Ia,[d(La,{redemptions:((o=n(l))==null?void 0:o.events)??[],count:((r=n(l))==null?void 0:r.count)??0,loading:n(u),pair:t.pair,onPage:a[0]||(a[0]=i=>s.value=i)},null,8,["redemptions","count","loading","pair"])])}}}),Ua=C(Sa,[["__scopeId","data-v-eda307c4"]]),Aa={class:"dashboard"},xa=D({__name:"Pair.page",setup(e){const s=de("protocolName"),u=de("pairId",void 0,{transform:Number}),{isFetching:l,data:t}=fe($(()=>({chain:"ethereum",protocol_name:s.value})),$(()=>!!s.value)),a=$(()=>(t.value??[]).find(c=>c.pairId===u.value)),{crumbs:o}=ge(ve());z(a,c=>{o.value=[{id:"protocols",label:"Protocols",pathName:"protocols",params:()=>({protocolName:s.value})},{id:"protocol",label:s.value,pathName:"protocols",params:()=>({protocolName:s.value})},{id:"pair",label:`Pair: ${c!=null&&c.name?ye(c.name):"?"}`}]},{immediate:!0});const{tabActive:r,tabActiveIndex:i}=Ie(["overview","collateral","redemptions","liquidations","health"],"pair",void 0,{tabParamName:"pairTab"});return(c,v)=>{const L=he,F=ue,K=ce;return _(),R("div",Aa,[d(L,{loading:n(l)},null,8,["loading"]),!n(l)&&n(a)?(_(),h(K,{key:0,active:n(i),onTab:v[0]||(v[0]=f=>i.value=f.index)},{default:b(()=>[d(F,{header:"Overview"},{default:b(()=>[(_(),h(H,null,[n(r)==="overview"?(_(),h(Da,{key:0,pair:n(a)},null,8,["pair"])):q("",!0)],1024))]),_:1}),d(F,{header:"Collateral"},{default:b(()=>[(_(),h(H,null,[n(r)==="collateral"?(_(),h(ct,{key:0,pair:n(a)},null,8,["pair"])):q("",!0)],1024))]),_:1}),d(F,{header:"Redemptions"},{default:b(()=>[(_(),h(H,null,[n(r)==="redemptions"?(_(),h(Ua,{key:0,pair:n(a)},null,8,["pair"])):q("",!0)],1024))]),_:1}),d(F,{header:"Liquidation"},{default:b(()=>[(_(),h(H,null,[n(r)==="liquidations"?(_(),h(pa,{key:0,pair:n(a)},null,8,["pair"])):q("",!0)],1024))]),_:1}),d(F,{header:"Health"},{default:b(()=>[(_(),h(H,null,[n(r)==="health"?(_(),h(ea,{key:0,pair:n(a)},null,8,["pair"])):q("",!0)],1024))]),_:1})]),_:1},8,["active"])):q("",!0)])}}}),ss=C(xa,[["__scopeId","data-v-9fb4fef3"]]);export{ss as default};
