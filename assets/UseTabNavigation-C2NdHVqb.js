import{z as t,t as w,f as F,p as D,g as P}from"./UsePagination-AMK_SP_b.js";import{f as R,a as x,u as d}from"./fetch-7WrayJG1.js";import{p as z}from"./Pagination-vgbH7lYO.js";import{x as g,m as C,k as j,I as N,J as Q,L as S,p as h,r as T}from"./index-DsSu0Rud.js";const E=t.object({name:t.string(),protocol_id:t.number(),pairs_count:t.number(),active_positions_count:t.number(),total_collateral:t.string(),total_debt:t.string()}).transform(e=>({name:e.name,protocolId:e.protocol_id,pairsCount:e.pairs_count,activePositionsCount:e.active_positions_count,totalCollateral:parseFloat(e.total_collateral),totalDebt:parseFloat(e.total_debt)})),J=t.object({protocols:t.array(E),count:t.number()}).transform(e=>({protocols:e.protocols,count:e.count})),K=t.object({pair_id:t.number(),name:t.string(),address:t.string(),total_collateral:t.string(),total_underlying:t.string(),exchange_rate:t.string(),total_debt:t.string(),active_positions_count:t.number(),borrow_limit:t.string(),utilization_rate:t.string(),interest_rate:t.string(),claimable_fees:t.string(),claimable_other_fees:t.string(),block_timestamp:t.number(),last_redemption:t.number().nullable()}).transform(e=>({pairId:e.pair_id,name:e.name,address:e.address,totalCollateral:parseFloat(e.total_collateral),totalUnderlying:parseFloat(e.total_underlying),exchangeRate:parseFloat(e.exchange_rate),totalDebt:parseFloat(e.total_debt),activePositionsCount:e.active_positions_count,borrowLimit:parseFloat(e.borrow_limit),utilizationRate:parseFloat(e.utilization_rate),interestRate:parseFloat(e.interest_rate),claimableFees:parseFloat(e.claimable_fees),claimableOtherFees:parseFloat(e.claimable_other_fees),blockTime:w(e.block_timestamp),lastRedemption:e.last_redemption?w(e.last_redemption):null})),L=t.object({pairs:t.array(K),count:t.number(),page:t.number(),total_pages:t.number()}).transform(e=>({pairs:e.pairs,count:e.count,page:e.page,totalPages:e.total_pages})),M=t.object(F);async function G(e,a){const _=P(),{chain:r}=M.parse(e),s=await R(`${_}/v1/protocols/overview/${r}`,void 0,a==null?void 0:a.signal);return J.parse(s)}const H=t.object({...F,...D,protocol_name:t.string()});async function I(e,a){const _=P(),{chain:r,protocol_name:s,...n}=H.parse(e),o=x(n),l=await R(`${_}/v1/protocols/${r}/${s}/pairs${o}`,void 0,a==null?void 0:a.signal);return L.parse(l)}function Z(e){return d({queryKey:["protocols-overview",e],queryFn:()=>G(g(e))})}function A(e,a){return d({queryKey:["protocols-pairs",e],queryFn:()=>z((r,s)=>I({...g(e),page:r,per_page:s}).then(n=>n.pairs),1,100),enabled:a})}const v=new WeakMap;function U(e,a,_={}){const{mode:r="replace",route:s=C(),router:n=j(),transform:o}=_;let l=i=>i,m=i=>i;typeof o=="function"?l=o:o&&(o.get&&(l=o.get),o.set&&(m=o.set)),v.has(n)||v.set(n,new Map);const p=v.get(n);let u=s.params[e];N(()=>{u=void 0});let b;const y=Q((i,f)=>(b=f,{get(){return i(),l(u!==void 0&&u!==""?u:g(a))},set(c){c=m(c),u!==c&&(u=c===g(a)||c===null?void 0:c,p.set(e,c===g(a)||c===null?void 0:c),f(),S(()=>{if(p.size===0)return;const q=Object.fromEntries(p.entries());p.clear();const{params:O,query:$,hash:k}=s;n[g(r)]({params:{...O,...q},query:$,hash:k})}))}}));return h(()=>s.params[e],i=>{u!==l(i)&&(u=i,b())},{flush:"sync"}),y}function V(e,a,_,r){const s=j(),n=(r==null?void 0:r.tabParamName)||"tab",o=U(n,e[0]),l=T(-1);return h(o,m=>l.value=e.findIndex(p=>p===m),{immediate:!0}),h(l,async(m,p)=>{var i;m===-1&&(m=0);const u=p===-1||p===void 0||o.value==="",b=s.currentRoute.value.query,y=e[m];(i=r==null?void 0:r.beforeNavigate)==null||i.call(r,y),await s.push({name:a,params:{[n]:e[m],...Object.fromEntries(Object.entries({}).map(([f,c])=>[f,String(c)]))},query:b,replace:u})},{immediate:!0}),{tabActive:o,tabActiveIndex:l}}export{Z as a,V as b,U as c,A as u};
