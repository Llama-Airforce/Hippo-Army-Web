var ut=i=>{throw TypeError(i)};var G=(i,t,e)=>t.has(i)||ut("Cannot "+e);var s=(i,t,e)=>(G(i,t,"read from private field"),e?e.call(i):t.get(i)),p=(i,t,e)=>t.has(i)?ut("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),u=(i,t,e,n)=>(G(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e),l=(i,t,e)=>(G(i,t,"access private method"),e);import{aN as Ot,bI as lt,bJ as R,bK as Y,bL as Z,bM as St,bN as dt,bO as ft,bP as wt,bQ as Ct,bR as Tt,bS as pt,aO as Dt,aQ as It,c as Qt,aR as Et,bT as Ft,aq as V,bU as bt,ai as Ut,bV as gt,b7 as Mt}from"./index-C4bxLmri.js";var g,r,W,b,Q,j,w,C,z,L,P,E,F,T,_,o,A,X,q,tt,et,st,it,nt,Rt,vt,xt=(vt=class extends Ot{constructor(t,e){super();p(this,o);p(this,g);p(this,r);p(this,W);p(this,b);p(this,Q);p(this,j);p(this,w);p(this,C);p(this,z);p(this,L);p(this,P);p(this,E);p(this,F);p(this,T);p(this,_,new Set);this.options=e,u(this,g,t),u(this,C,null),u(this,w,lt()),this.options.experimental_prefetchInRender||s(this,w).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(s(this,r).addObserver(this),yt(s(this,r),this.options)?l(this,o,A).call(this):this.updateResult(),l(this,o,et).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return rt(s(this,r),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return rt(s(this,r),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,l(this,o,st).call(this),l(this,o,it).call(this),s(this,r).removeObserver(this)}setOptions(t){const e=this.options,n=s(this,r);if(this.options=s(this,g).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof R(this.options.enabled,s(this,r))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");l(this,o,nt).call(this),s(this,r).setOptions(this.options),e._defaulted&&!Y(this.options,e)&&s(this,g).getQueryCache().notify({type:"observerOptionsUpdated",query:s(this,r),observer:this});const h=this.hasListeners();h&&mt(s(this,r),n,this.options,e)&&l(this,o,A).call(this),this.updateResult(),h&&(s(this,r)!==n||R(this.options.enabled,s(this,r))!==R(e.enabled,s(this,r))||Z(this.options.staleTime,s(this,r))!==Z(e.staleTime,s(this,r)))&&l(this,o,X).call(this);const c=l(this,o,q).call(this);h&&(s(this,r)!==n||R(this.options.enabled,s(this,r))!==R(e.enabled,s(this,r))||c!==s(this,T))&&l(this,o,tt).call(this,c)}getOptimisticResult(t){const e=s(this,g).getQueryCache().build(s(this,g),t),n=this.createResult(e,t);return Lt(this,n)&&(u(this,b,n),u(this,j,this.options),u(this,Q,s(this,r).state)),n}getCurrentResult(){return s(this,b)}trackResult(t,e){const n={};return Object.keys(t).forEach(h=>{Object.defineProperty(n,h,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(h),e==null||e(h),t[h])})}),n}trackProp(t){s(this,_).add(t)}getCurrentQuery(){return s(this,r)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=s(this,g).defaultQueryOptions(t),n=s(this,g).getQueryCache().build(s(this,g),e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return l(this,o,A).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),s(this,b)))}createResult(t,e){var ct;const n=s(this,r),h=this.options,c=s(this,b),d=s(this,Q),O=s(this,j),N=t!==n?t.state:s(this,W),{state:$}=t;let f={...$},I=!1,a;if(e._optimisticResults){const y=this.hasListeners(),B=!y&&yt(t,e),x=y&&mt(t,n,e,h);(B||x)&&(f={...f,...Tt($.data,t.options)}),e._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:S,errorUpdatedAt:U,status:m}=f;a=f.data;let k=!1;if(e.placeholderData!==void 0&&a===void 0&&m==="pending"){let y;c!=null&&c.isPlaceholderData&&e.placeholderData===(O==null?void 0:O.placeholderData)?(y=c.data,k=!0):y=typeof e.placeholderData=="function"?e.placeholderData((ct=s(this,P))==null?void 0:ct.state.data,s(this,P)):e.placeholderData,y!==void 0&&(m="success",a=pt(c==null?void 0:c.data,y,e),I=!0)}if(e.select&&a!==void 0&&!k)if(c&&a===(d==null?void 0:d.data)&&e.select===s(this,z))a=s(this,L);else try{u(this,z,e.select),a=e.select(a),a=pt(c==null?void 0:c.data,a,e),u(this,L,a),u(this,C,null)}catch(y){u(this,C,y)}s(this,C)&&(S=s(this,C),a=s(this,L),U=Date.now(),m="error");const M=f.fetchStatus==="fetching",H=m==="pending",K=m==="error",ot=H&&M,ht=a!==void 0,v={status:m,fetchStatus:f.fetchStatus,isPending:H,isSuccess:m==="success",isError:K,isInitialLoading:ot,isLoading:ot,data:a,dataUpdatedAt:f.dataUpdatedAt,error:S,errorUpdatedAt:U,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>N.dataUpdateCount||f.errorUpdateCount>N.errorUpdateCount,isFetching:M,isRefetching:M&&!H,isLoadingError:K&&!ht,isPaused:f.fetchStatus==="paused",isPlaceholderData:I,isRefetchError:K&&ht,isStale:at(t,e),refetch:this.refetch,promise:s(this,w)};if(this.options.experimental_prefetchInRender){const y=J=>{v.status==="error"?J.reject(v.error):v.data!==void 0&&J.resolve(v.data)},B=()=>{const J=u(this,w,v.promise=lt());y(J)},x=s(this,w);switch(x.status){case"pending":t.queryHash===n.queryHash&&y(x);break;case"fulfilled":(v.status==="error"||v.data!==x.value)&&B();break;case"rejected":(v.status!=="error"||v.error!==x.reason)&&B();break}}return v}updateResult(){const t=s(this,b),e=this.createResult(s(this,r),this.options);if(u(this,Q,s(this,r).state),u(this,j,this.options),s(this,Q).data!==void 0&&u(this,P,s(this,r)),Y(e,t))return;u(this,b,e);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:h}=this.options,c=typeof h=="function"?h():h;if(c==="all"||!c&&!s(this,_).size)return!0;const d=new Set(c??s(this,_));return this.options.throwOnError&&d.add("error"),Object.keys(s(this,b)).some(O=>{const D=O;return s(this,b)[D]!==t[D]&&d.has(D)})};l(this,o,Rt).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&l(this,o,et).call(this)}},g=new WeakMap,r=new WeakMap,W=new WeakMap,b=new WeakMap,Q=new WeakMap,j=new WeakMap,w=new WeakMap,C=new WeakMap,z=new WeakMap,L=new WeakMap,P=new WeakMap,E=new WeakMap,F=new WeakMap,T=new WeakMap,_=new WeakMap,o=new WeakSet,A=function(t){l(this,o,nt).call(this);let e=s(this,r).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(St)),e},X=function(){l(this,o,st).call(this);const t=Z(this.options.staleTime,s(this,r));if(dt||s(this,b).isStale||!ft(t))return;const n=wt(s(this,b).dataUpdatedAt,t)+1;u(this,E,setTimeout(()=>{s(this,b).isStale||this.updateResult()},n))},q=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(s(this,r)):this.options.refetchInterval)??!1},tt=function(t){l(this,o,it).call(this),u(this,T,t),!(dt||R(this.options.enabled,s(this,r))===!1||!ft(s(this,T))||s(this,T)===0)&&u(this,F,setInterval(()=>{(this.options.refetchIntervalInBackground||Ct.isFocused())&&l(this,o,A).call(this)},s(this,T)))},et=function(){l(this,o,X).call(this),l(this,o,tt).call(this,l(this,o,q).call(this))},st=function(){s(this,E)&&(clearTimeout(s(this,E)),u(this,E,void 0))},it=function(){s(this,F)&&(clearInterval(s(this,F)),u(this,F,void 0))},nt=function(){const t=s(this,g).getQueryCache().build(s(this,g),this.options);if(t===s(this,r))return;const e=s(this,r);u(this,r,t),u(this,W,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},Rt=function(t){Dt.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(s(this,b))}),s(this,g).getQueryCache().notify({query:s(this,r),type:"observerResultsUpdated"})})},vt);function jt(i,t){return R(t.enabled,i)!==!1&&i.state.data===void 0&&!(i.state.status==="error"&&t.retryOnMount===!1)}function yt(i,t){return jt(i,t)||i.state.data!==void 0&&rt(i,t,t.refetchOnMount)}function rt(i,t,e){if(R(t.enabled,i)!==!1){const n=typeof e=="function"?e(i):e;return n==="always"||n!==!1&&at(i,t)}return!1}function mt(i,t,e,n){return(i!==t||R(n.enabled,i)===!1)&&(!e.suspense||i.state.status!=="error")&&at(i,e)}function at(i,t){return R(t.enabled,i)!==!1&&i.isStaleByTime(Z(t.staleTime,i))}function Lt(i,t){return!Y(i.getCurrentResult(),t)}function Pt(i,t,e){const n=It(),h=Qt(()=>{const a=Et(t);typeof a.enabled=="function"&&(a.enabled=a.enabled());const S=n.defaultQueryOptions(a);return S._optimisticResults=n.isRestoring.value?"isRestoring":"optimistic",S}),c=new i(n,h.value),d=Ft(c.getCurrentResult());let O=()=>{};V(n.isRestoring,a=>{a||(O(),O=c.subscribe(S=>{bt(d,S)}))},{immediate:!0});const D=()=>{c.setOptions(h.value),bt(d,c.getCurrentResult())};V(h,D),Ut(()=>{O()});const N=(...a)=>(D(),d.refetch(...a)),$=()=>new Promise((a,S)=>{let U=()=>{};const m=()=>{if(h.value.enabled!==!1){c.setOptions(h.value);const k=c.getOptimisticResult(h.value);k.isStale?(U(),c.fetchOptimistic(h.value).then(a,M=>{gt(h.value.throwOnError,[M,c.getCurrentQuery()])?S(M):a(c.getCurrentResult())})):(U(),a(k))}};m(),U=V(h,m)});V(()=>d.error,a=>{if(d.isError&&!d.isFetching&&gt(h.value.throwOnError,[a,c.getCurrentQuery()]))throw a});const I=Mt(d);for(const a in d)typeof d[a]=="function"&&(I[a]=d[a]);return I.suspense=$,I.refetch=N,I}function Bt(i,t){return Pt(xt,i)}const Jt=i=>{const t=new URLSearchParams(Object.entries(i).filter(([e,n])=>n!=null).map(([e,n])=>[e,n.toString()])).toString();return t&&`?${t}`};class _t extends Error{constructor(t,e){super(e),this.status=t}}async function Nt(i,t,e){const n=await fetch(i,{method:t?"POST":"GET",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t),signal:e});if(!n.ok)throw new _t(n.status,`Fetch error ${n.status} for URL: ${i}`);return n}async function Vt(i,t,e){return await(await Nt(i,t,e)).json()}const kt=/[+-]\d{2}:?\d{2}$/;function Zt(i){if(typeof i=="number")return new Date(i*1e3);const t=Number(i);if(!Number.isNaN(t))return new Date(t*1e3);const n=i.endsWith("Z")||kt.test(i)?i:`${i}Z`;return new Date(n)}const At=24*60*60;function Ht({end:i,start:t,daysRange:e=10}={}){return i??(i=Math.floor(Date.now()/1e3)),t??(t=i-e*At),{end:i,start:t}}function Kt(i){const t=["","k","m","b","t"],e=Math.max(0,Math.min(t.length-1,Math.floor(Math.log10(Math.abs(i))/3)));return t[e]}function Gt(i,t=0,e=""){if(e==="dollar"){const h=Math.floor(Math.log10(Math.abs(i))/3)*3;i/=h>0?10**h:1}const n=t===1/0?void 0:{minimumFractionDigits:t,maximumFractionDigits:t};return i.toLocaleString(void 0,n)}export{_t as F,xt as Q,Bt as a,Jt as b,Vt as f,Ht as g,Gt as r,Zt as t,Kt as u};
