import{a as he,_ as fe}from"./TabItem.vue_vue_type_script_setup_true_lang-DLhPEkiK.js";import{am as I,aJ as Z,d as D,at as ee,av as W,b as f,o as _,_ as S,e as b,an as q,f as m,m as k,j as R,g as d,k as T,aw as E,h as n,l as C,ai as te,c as $,t as H,ao as G,u as ue,a as ce,w as pe,aF as ye,aG as $e,ay as De,aI as O}from"./index-Dn4CPbex.js";import{b as Ce}from"./protocols-CKceb9Xt.js";import{p as ke}from"./util-CVNQ9WdU.js";import{t as z,b as j,f as U,a as x,g as we,r as w,u as P}from"./timestamp-DOqFwE4S.js";import{d as Pe,o as y,s as c,a as A,n as v,e as X,p as J,t as Q,c as B,g as N,_ as M}from"./AsyncValue-BiJ5akq4.js";import{p as Re}from"./Pagination-vgbH7lYO.js";import{_ as ae}from"./NoData-Bdj7ZiCw.js";import{_ as se}from"./Table-B5YLxs-C.js";import{a as oe,_ as re}from"./UsePagination-C1liwRbF.js";import{u as le}from"./UseRelativeTime-BIO5birU.js";import{_ as ne}from"./ChartApex-46JiMDhP.js";import{c as ie}from"./ChartStylesApex-C91zdj9J.js";import{_ as Y}from"./KPI-D3DUNtex.js";import{u as _e,c as me,a as be,_ as ge}from"./UseLightweightChart-COT6E8SK.js";import{_ as ve}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-D5IHEggT.js";import{a as de}from"./index-BUjoQgyy.js";import{u as Fe}from"./UseTabNavigation-Dqq9SIMe.js";import"./Tooltip-Cc6MF7Zs.js";const qe=Pe(["borrow","add_collateral","remove_collateral","repay","redeem","liquidate","leveraged_position","repay_with_collateral"]),Te=y({token_address:c(),token_symbol:c(),apr:c()}).transform(e=>({tokenAddress:e.token_address,tokenSymbol:e.token_symbol,apr:parseFloat(e.apr)})),Le=y({date_timestamp:v(),total_collateral:c(),total_underlying:c(),exchange_rate:c(),total_debt:c(),active_positions_count:v(),borrow_limit:c(),utilization_rate:c(),interest_rate:c(),claimable_fees:c(),claimable_other_fees:c(),borrow_cost_apr:c(),base_apr:c(),rewards:A(Te)}).transform(e=>({time:z(e.date_timestamp),totalCollateral:parseFloat(e.total_collateral),totalUnderlying:parseFloat(e.total_underlying),exchangeRate:parseFloat(e.exchange_rate),totalDebt:parseFloat(e.total_debt),activePositionsCount:e.active_positions_count,borrowLimit:parseFloat(e.borrow_limit),utilizationRate:parseFloat(e.utilization_rate),interestRate:parseFloat(e.interest_rate),claimableFees:parseFloat(e.claimable_fees),claimableOtherFees:parseFloat(e.claimable_other_fees),aprBorrowCost:parseFloat(e.borrow_cost_apr),aprBase:parseFloat(e.base_apr),rewards:e.rewards})),Ie=y({snapshots:A(Le),count:v(),page:v(),total_pages:v()}).transform(e=>({snapshots:e.snapshots,count:e.count,page:e.page,totalPages:e.total_pages})),Se=y({event_type:qe,block_timestamp:v(),tx_hash:c(),block_number:v(),collateral_change:c(),debt_change:c()}).transform(e=>({eventType:e.event_type,blockTime:z(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,collateralChange:parseFloat(e.collateral_change),debtChange:parseFloat(e.debt_change)})),Ue=y({events:A(Se),count:v(),page:v(),total_pages:v()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),xe=y({block_timestamp:v(),tx_hash:c(),block_number:v(),caller:X,amount:c(),collateral_freed:c(),protocol_fee:c(),debt_reduction:c()}).transform(e=>({blockTime:z(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,caller:e.caller,amount:parseFloat(e.amount),collateralFreed:parseFloat(e.collateral_freed),protocolFee:parseFloat(e.protocol_fee),debtReduction:parseFloat(e.debt_reduction)})),Ae=y({events:A(xe),count:v(),page:v(),total_pages:v()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),Be=y({block_timestamp:v(),tx_hash:c(),block_number:v(),borrower:X,liquidator:X,collateral_for_liquidator:c(),shares_liquidated:c(),amount_liquidator_to_repay:c()}).transform(e=>({blockTime:z(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,borrower:e.borrower,liquidator:e.liquidator,collateralForLiquidator:parseFloat(e.collateral_for_liquidator),sharesLiquidated:parseFloat(e.shares_liquidated),amountLiquidatorToRepay:parseFloat(e.amount_liquidator_to_repay)})),Ne=y({events:A(Be),count:v(),page:v(),total_pages:v()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),Ke=y({...B,...Q,...J});async function Ve(e,s){const i=N(s),{pair_id:l,...t}=Ke.parse(e),a=j(t),o=await U(`${i}/v1/pairs/${l}/snapshots${a}`,void 0,s==null?void 0:s.signal);return Ie.parse(o)}const Me=y({...B,...Q,...J});async function Ee(e,s){const i=N(s),{pair_id:l,...t}=Me.parse(e),a=j(t),o=await U(`${i}/v1/pairs/${l}/collateral_events${a}`,void 0,s==null?void 0:s.signal);return Ue.parse(o)}const Oe=y({...B,...Q,...J});async function He(e,s){const i=N(s),{pair_id:l,...t}=Oe.parse(e),a=j(t),o=await U(`${i}/v1/pairs/${l}/redemptions${a}`,void 0,s==null?void 0:s.signal);return Ae.parse(o)}const We=y({...B,...Q,...J});async function ze(e,s){const i=N(s),{pair_id:l,...t}=We.parse(e),a=j(t),o=await U(`${i}/v1/pairs/${l}/liquidations${a}`,void 0,s==null?void 0:s.signal);return Ne.parse(o)}function je(e){const{start:s,end:i}=we({daysRange:90});return x({queryKey:["pairs-snapshots",e],queryFn:()=>Re((t,a)=>Ve({...I(e),page:t,per_page:a,start:s,end:i}).then(o=>o.snapshots),1,100)})}function Je(e){return x({queryKey:["pairs-collateral-events",e],queryFn:()=>Ee(I(e)),placeholderData:Z})}function Qe(e){return x({queryKey:["pairs-redemptions",e],queryFn:()=>He(I(e)),placeholderData:Z})}function Ye(e){return x({queryKey:["pairs-liquidations",e],queryFn:()=>ze(I(e)),placeholderData:Z})}const Ge={class:"end"},Xe={key:0,style:{display:"flex",gap:"1ch"}},Ze={class:"end"},et={key:0,style:{display:"flex",gap:"1ch"}},tt={class:"end"},at=["href"],st=D({__name:"TableCollateralEvents",props:{events:{},count:{},pair:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:s}){const i=s,{page:l,onPage:t}=oe(),a=ee(l,200);W(a,u=>{i("page",u)});const{relativeTime:o}=le(),r=u=>{switch(u.eventType){case"add_collateral":return"Add collateral";case"borrow":return"Borrow";case"remove_collateral":return"Remove collateral";case"repay":return"Repay";case"redeem":return"Redeem";case"liquidate":return"Liquidate";case"leveraged_position":return"Lev. position";case"repay_with_collateral":return"Repay with col"}};return(u,p)=>{const g=re,L=M,F=se,K=ae,h=S;return _(),f(h,{title:"Events"},{actions:b(()=>[d(g,{"items-count":u.count,"items-per-page":10,page:n(l),onPage:n(t)},null,8,["items-count","page","onPage"])]),default:b(()=>[e.events.length>0?(_(),f(F,{key:0,rows:e.events,columns:["Type",{label:"Δ Debt",align:"end"},{label:"Δ Collateral",align:"end"},{label:"Time",align:"end"}]},{row:b(({item:V})=>[m("div",null,k(r(V)),1),m("div",Ge,[V.debtChange!==0?(_(),R("div",Xe,[d(L,{type:"dollar",value:V.debtChange/10**18,precision:2,"show-symbol":!1},null,8,["value"]),T(" "+k(u.pair.tokenDebt.symbol),1)])):q("",!0)]),m("div",Ze,[V.collateralChange!==0?(_(),R("div",et,[d(L,{type:"dollar",value:V.collateralChange/10**18,precision:2,"show-symbol":!1},null,8,["value"]),T(" "+k(u.pair.tokenCollateral.symbol),1)])):q("",!0)]),m("div",tt,[m("a",{target:"_blank",href:`https://etherscan.io/tx/${V.txHash}`,onClick:p[0]||(p[0]=E(()=>{},["stop"]))},k(n(o)(V.blockTime.getUTCTimestamp())),9,at)])]),_:1},8,["rows"])):u.loading?q("",!0):(_(),f(K,{key:1,message:"There are no events"}))]),_:1})}}}),ot=C(st,[["__scopeId","data-v-f018f232"]]),rt={class:"dashboard-grid"},lt=D({__name:"Collateral",props:{pair:{}},setup(e){const s=te(1),{isFetching:i,data:l}=Je($(()=>({pair_id:e.pair.pairId,page:s.value,per_page:15})));return(t,a)=>{var o,r;return _(),R("div",rt,[d(ot,{events:((o=n(l))==null?void 0:o.events)??[],count:((r=n(l))==null?void 0:r.count)??0,loading:n(i),pair:t.pair,onPage:a[0]||(a[0]=u=>s.value=u)},null,8,["events","count","loading","pair"])])}}}),nt=C(lt,[["__scopeId","data-v-ff086716"]]),it=y({range_label:c(),user_count:v(),total_debt:c()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),dt=y({bins:A(it),total_users:v(),total_debt:c(),min_ratio:c(),max_ratio:c(),median_ratio:c()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),minRatio:parseFloat(e.min_ratio),maxRatio:parseFloat(e.max_ratio),medianRatio:parseFloat(e.median_ratio)})),ut=y({range_label:c(),user_count:v(),total_debt:c()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),ct=y({bins:A(ut),total_users:v(),total_debt:c(),min_debt:c(),max_debt:c(),median_debt:c()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),minDebt:parseFloat(e.min_debt),maxDebt:parseFloat(e.max_debt),medianDebt:parseFloat(e.median_debt)})),pt=y({leveraged_users_count:v(),non_leveraged_users_count:v(),leveraged_debt:c(),non_leveraged_debt:c(),total_users:v(),total_debt:c(),leveraged_users_percentage:c(),leveraged_debt_percentage:c()}).transform(e=>({leveragedUsersCount:e.leveraged_users_count,nonLeveragedUsersCount:e.non_leveraged_users_count,leveragedDebt:parseFloat(e.leveraged_debt),nonLeveragedDebt:parseFloat(e.non_leveraged_debt),totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),leveragedUsersPercentage:parseFloat(e.leveraged_users_percentage),leveragedDebtPercentage:parseFloat(e.leveraged_debt_percentage)})),_t=y({stats:pt}).transform(e=>({stats:e.stats})),mt=y({range_label:c(),user_count:v(),total_debt:c()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),bt=y({bins:A(mt),total_users:v(),total_debt:c()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt)})),gt=y(B);async function vt(e,s){const i=N(s),{pair_id:l}=gt.parse(e),t=await U(`${i}/v1/health/${l}/leverage_stats`,void 0,s==null?void 0:s.signal);return _t.parse(t)}const ht=y(B);async function ft(e,s){const i=N(s),{pair_id:l}=ht.parse(e),t=await U(`${i}/v1/health/${l}/leverage_distribution`,void 0,s==null?void 0:s.signal);return bt.parse(t)}const yt=y(B);async function $t(e,s){const i=N(s),{pair_id:l}=yt.parse(e),t=await U(`${i}/v1/health/${l}/debt_distribution`,void 0,s==null?void 0:s.signal);return ct.parse(t)}const Dt=y(B);async function Ct(e,s){const i=N(s),{pair_id:l}=Dt.parse(e),t=await U(`${i}/v1/health/${l}/collateral_ratio_distribution`,void 0,s==null?void 0:s.signal);return dt.parse(t)}function kt(e){return x({queryKey:["health-leverage-stats",e],queryFn:()=>vt(I(e))})}function wt(e){return x({queryKey:["health-leverage-distribution",e],queryFn:()=>ft(I(e))})}function Pt(e){return x({queryKey:["health-debt-distribution",e],queryFn:()=>$t(I(e))})}function Rt(e){return x({queryKey:["health-collateral-ratio-distribution",e],queryFn:()=>Ct(I(e))})}const Ft=D({__name:"ChartCollateralRatioDistribution",props:{data:{}},setup(e){const s=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1},stacked:!1},xaxis:{categories:i.value,labels:{formatter:t=>t,rotate:-30,offsetY:10,rotateAlways:!0},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${w(t,0,"dollar")}${P(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const a=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${i.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${a}</div>
                <div><b>Debt:</b></div><div>$${w(o,2,"dollar")}${P(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${w(o/a,2,"dollar")}${P(o/a)}</div>
                </div>`}},legend:{show:!0}})),i=$(()=>{var t;return(((t=e.data)==null?void 0:t.bins)??[]).map(a=>{const[o,r]=a.rangeLabel.split(" - ").map(parseFloat),u=`${Math.round(o*100)}%`,p=`${Math.round(r*100)}%`;return`${u} - ${p}`})}),l=$(()=>{var t,a;return[{name:"Users",type:"column",data:(((t=e.data)==null?void 0:t.bins)??[]).map(o=>o.userCount)},{name:"Debt",type:"line",data:(((a=e.data)==null?void 0:a.bins)??[]).map(o=>o.totalDebt)}]});return(t,a)=>{const o=ne,r=S;return _(),f(r,null,{default:b(()=>[d(o,{options:n(s),series:n(l)},null,8,["options","series"])]),_:1})}}}),qt=C(Ft,[["__scopeId","data-v-022e67af"]]),Tt=D({__name:"ChartDebtDistribution",props:{data:{}},setup(e){const s=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1},stacked:!1},xaxis:{categories:i.value,labels:{formatter:t=>t,rotate:-30,offsetY:10,rotateAlways:!0},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${w(t,0,"dollar")}${P(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const a=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${i.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${a}</div>
                <div><b>Debt:</b></div><div>$${w(o,2,"dollar")}${P(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${w(o/a,2,"dollar")}${P(o/a)}</div>
                </div>`}},legend:{show:!0}})),i=$(()=>{var t;return(((t=e.data)==null?void 0:t.bins)??[]).map(a=>{const[o,r]=a.rangeLabel.split(" - ").map(parseFloat),u=`$${w(o,0,"dollar")}${P(o)}`,p=`$${w(r,0,"dollar")}${P(r)}`;return`${u} - ${p}`})}),l=$(()=>{var t,a;return[{name:"Users",type:"column",data:(((t=e.data)==null?void 0:t.bins)??[]).map(o=>o.userCount)},{name:"Debt",type:"line",data:(((a=e.data)==null?void 0:a.bins)??[]).map(o=>o.totalDebt)}]});return(t,a)=>{const o=ne,r=S;return _(),f(r,null,{default:b(()=>[d(o,{options:n(s),series:n(l)},null,8,["options","series"])]),_:1})}}}),Lt=C(Tt,[["__scopeId","data-v-73ee7851"]]),It=D({__name:"ChartLeverageDistribution",props:{data:{}},setup(e){const s=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},zoom:{enabled:!1}},xaxis:{categories:i.value,labels:{formatter:t=>t,rotate:-30},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${w(t,0,"dollar")}${P(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const a=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${i.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${a}</div>
                <div><b>Debt:</b></div><div>$${w(o,2,"dollar")}${P(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${w(o/a,2,"dollar")}${P(o/a)}</div>
                </div>`}},legend:{show:!0}})),i=$(()=>{var t;return(((t=e.data)==null?void 0:t.bins)??[]).map(a=>a.rangeLabel)}),l=$(()=>{var t,a;return[{name:"Users",type:"column",data:(((t=e.data)==null?void 0:t.bins)??[]).map(o=>o.userCount)},{name:"Debt",type:"line",data:(((a=e.data)==null?void 0:a.bins)??[]).map(o=>o.totalDebt)}]});return(t,a)=>{const o=ne,r=S;return _(),f(r,null,{default:b(()=>[d(o,{options:n(s),series:n(l)},null,8,["options","series"])]),_:1})}}}),St=C(It,[["__scopeId","data-v-80deb86d"]]),Ut={class:"kpis"},xt={class:"kpi-subvalue"},At=D({__name:"CollateralRatioKPIs",props:{collateralRatio:{}},setup(e){const s=$(()=>{if(!e.collateralRatio||e.collateralRatio.bins.length===0)return;const i=[...e.collateralRatio.bins].sort((o,r)=>r.userCount-o.userCount)[0],[l,t]=i.rangeLabel.split(" - ").map(parseFloat);return{range:`${Math.round(l*100)}% - ${Math.round(t*100)}%`,users:i.userCount}});return(i,l)=>{var o;const t=M,a=Y;return _(),R("div",Ut,[d(a,{label:"Median Collateral Ratio","has-value":!!((o=i.collateralRatio)!=null&&o.medianRatio)},{default:b(()=>{var r;return[d(t,{type:"percentage",value:(r=i.collateralRatio)!=null&&r.medianRatio?i.collateralRatio.medianRatio*100:"?",precision:2},null,8,["value"])]}),_:1},8,["has-value"]),d(a,{label:"Most Common Collateral Ratio","has-value":!!n(s)},{default:b(()=>{var r,u;return[m("div",null,k(((r=n(s))==null?void 0:r.range)??"N/A"),1),m("div",xt,[d(t,{value:((u=n(s))==null?void 0:u.users)??"?",precision:0},null,8,["value"]),l[0]||(l[0]=T(" users "))])]}),_:1},8,["has-value"])])}}}),Bt=C(At,[["__scopeId","data-v-cd75baa0"]]),Nt={class:"kpis"},Kt=D({__name:"DebtKPIs",props:{debt:{}},setup(e){return(s,i)=>{var a,o;const l=M,t=Y;return _(),R("div",Nt,[d(t,{label:"Max Debt","has-value":!!((a=s.debt)!=null&&a.maxDebt)},{default:b(()=>{var r;return[d(l,{type:"dollar",value:(r=s.debt)==null?void 0:r.maxDebt,precision:2,"show-symbol":!1},null,8,["value"])]}),_:1},8,["has-value"]),d(t,{label:"Median Debt","has-value":!!((o=s.debt)!=null&&o.medianDebt)},{default:b(()=>{var r;return[d(l,{type:"dollar",value:(r=s.debt)==null?void 0:r.medianDebt,precision:2,"show-symbol":!1},null,8,["value"])]}),_:1},8,["has-value"])])}}}),Vt=C(Kt,[["__scopeId","data-v-8ffe283b"]]),Mt={class:"kpis"},Et={class:"kpi-subvalue"},Ot={class:"kpi-subvalue"},Ht={class:"kpi-subvalue"},Wt={class:"kpi-subvalue"},zt=D({__name:"LeverageKPIs",props:{leverage:{},leverageStats:{}},setup(e){const s=$(()=>{if(!e.leverage||e.leverage.bins.length===0)return;const l=[...e.leverage.bins].sort((t,a)=>a.userCount-t.userCount)[0];return{range:l.rangeLabel,users:l.userCount}}),i=$(()=>{if(!e.leverage||e.leverage.bins.length===0)return;const l=[...e.leverage.bins].sort((t,a)=>a.totalDebt-t.totalDebt)[0];return{range:l.rangeLabel,debt:l.totalDebt}});return(l,t)=>{var r,u;const a=M,o=Y;return _(),R("div",Mt,[d(o,{label:"Most Common Range","has-value":!!n(s)},{default:b(()=>{var p,g;return[m("div",null,k(((p=n(s))==null?void 0:p.range)??"N/A"),1),m("div",Et,[d(a,{value:((g=n(s))==null?void 0:g.users)??"?",precision:0},null,8,["value"]),t[0]||(t[0]=T(" users "))])]}),_:1},8,["has-value"]),d(o,{label:"Highest Debt Range","has-value":!!n(i)},{default:b(()=>{var p,g;return[m("div",null,k((p=n(i))==null?void 0:p.range),1),m("div",Ot,[d(a,{type:"dollar",value:(g=n(i))==null?void 0:g.debt,precision:2},null,8,["value"])])]}),_:1},8,["has-value"]),d(o,{label:"Leveraged Users","has-value":!!((r=l.leverageStats)!=null&&r.stats)},{default:b(()=>{var p,g;return[d(a,{value:(p=l.leverageStats)==null?void 0:p.stats.leveragedUsersCount,precision:0},null,8,["value"]),m("div",Ht,[d(a,{type:"percentage",value:(g=l.leverageStats)==null?void 0:g.stats.leveragedUsersPercentage,precision:2},null,8,["value"]),t[1]||(t[1]=T(" of total "))])]}),_:1},8,["has-value"]),d(o,{label:"Leveraged Debt","has-value":!!((u=l.leverageStats)!=null&&u.stats)},{default:b(()=>{var p,g;return[d(a,{type:"dollar",value:(p=l.leverageStats)==null?void 0:p.stats.leveragedDebt,precision:2,"show-symbol":!1},null,8,["value"]),m("div",Wt,[d(a,{type:"percentage",value:(g=l.leverageStats)==null?void 0:g.stats.leveragedDebtPercentage,precision:2},null,8,["value"]),t[2]||(t[2]=T(" of total "))])]}),_:1},8,["has-value"])])}}}),jt=C(zt,[["__scopeId","data-v-ae4a0874"]]),Jt={class:"dashboard-grid"},Qt=D({__name:"Health",props:{pair:{}},setup(e){const{isFetching:s,data:i}=wt(H(()=>({pair_id:e.pair.pairId}))),{isFetching:l,data:t}=Pt(H(()=>({pair_id:e.pair.pairId}))),{data:a}=kt(H(()=>({pair_id:e.pair.pairId}))),{isFetching:o,data:r}=Rt(H(()=>({pair_id:e.pair.pairId})));return(u,p)=>(_(),R("div",Jt,[p[0]||(p[0]=m("div",{style:{"grid-area":"title-leverage-distribution"},class:"title"}," Leverage Distribution ",-1)),d(jt,{style:{"grid-area":"kpis-leverage"},leverage:n(i),"leverage-stats":n(a)},null,8,["leverage","leverage-stats"]),d(St,{style:{"grid-area":"chart-leverage-distribution"},data:n(i),loading:n(s)},null,8,["data","loading"]),p[1]||(p[1]=m("div",{style:{"grid-area":"title-debt-distribution"},class:"title"}," Debt Distribution ",-1)),d(Vt,{style:{"grid-area":"kpis-debt"},debt:n(t)},null,8,["debt"]),d(Lt,{style:{"grid-area":"chart-debt-distribution"},data:n(t),loading:n(l)},null,8,["data","loading"]),p[2]||(p[2]=m("div",{style:{"grid-area":"title-collateral-ratio-distribution"},class:"title"}," Collateral Ratio Distribution ",-1)),d(Bt,{style:{"grid-area":"kpis-collateral-ratio"},"collateral-ratio":n(r)},null,8,["collateral-ratio"]),d(qt,{style:{"grid-area":"chart-collateral-ratio-distribution"},data:n(r),loading:n(o)},null,8,["data","loading"])]))}}),Yt=C(Qt,[["__scopeId","data-v-aa4d047e"]]),Gt=["href"],Xt=["href"],Zt={class:"end"},ea={class:"end"},ta={class:"end"},aa={class:"end"},sa=["href"],oa=D({__name:"TableLiquidations",props:{liquidations:{},count:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:s}){const i=s,{page:l,onPage:t}=oe(),a=ee(l,200);W(a,r=>{i("page",r)});const{relativeTime:o}=le();return(r,u)=>{const p=re,g=M,L=se,F=ae,K=S;return _(),f(K,{title:"Liquidations"},{actions:b(()=>[d(p,{"items-count":r.count,"items-per-page":10,page:n(l),onPage:n(t)},null,8,["items-count","page","onPage"])]),default:b(()=>[e.liquidations.length>0?(_(),f(L,{key:0,rows:e.liquidations,columns:["Borrower","Liquidator",{label:"Shares liquidated",align:"end"},{label:"Collat for liquidator",align:"end"},{label:"Amount to repay (reUSD)",align:"end"},{label:"Time",align:"end"}]},{row:b(({item:h})=>[m("div",null,[m("a",{target:"_blank",href:`https://etherscan.io/address/${h.borrower}`,onClick:u[0]||(u[0]=E(()=>{},["stop"]))},k(h.borrower.ens||("addressShort"in r?r.addressShort:n(G))(h.borrower.address)),9,Gt)]),m("div",null,[m("a",{target:"_blank",href:`https://etherscan.io/address/${h.liquidator}`,onClick:u[1]||(u[1]=E(()=>{},["stop"]))},k(h.liquidator.ens||("addressShort"in r?r.addressShort:n(G))(h.liquidator.address)),9,Xt)]),m("div",Zt,[d(g,{type:"dollar",value:h.sharesLiquidated/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),m("div",ea,[d(g,{type:"dollar",value:h.collateralForLiquidator/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),m("div",ta,[d(g,{type:"dollar",value:h.amountLiquidatorToRepay/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),m("div",aa,[m("a",{target:"_blank",href:`https://etherscan.io/tx/${h.txHash}`,onClick:u[2]||(u[2]=E(()=>{},["stop"]))},k(n(o)(h.blockTime.getUTCTimestamp())),9,sa)])]),_:1},8,["rows"])):r.loading?q("",!0):(_(),f(F,{key:1,message:"There are no liquidations"}))]),_:1})}}}),ra=C(oa,[["__scopeId","data-v-f3133012"]]),la={class:"dashboard-grid"},na=D({__name:"Liquidations",props:{pair:{}},setup(e){const s=te(1),{isFetching:i,data:l}=Ye($(()=>({pair_id:e.pair.pairId,page:s.value,per_page:15})));return(t,a)=>{var o,r;return _(),R("div",la,[d(ra,{liquidations:((o=n(l))==null?void 0:o.events)??[],count:((r=n(l))==null?void 0:r.count)??0,loading:n(i),onPage:a[0]||(a[0]=u=>s.value=u)},null,8,["liquidations","count","loading"])])}}}),ia=C(na,[["__scopeId","data-v-0dd6af85"]]),da={style:{display:"flex"}},ua={ref:"chartRef",class:"chart"},ca=D({__name:"ChartApr",props:{apr:{}},setup(e){const s=ue(),i=ce("card"),{chart:l,series:t}=_e({createChartOptions:be(),series:me({name:"apr",color:$(()=>s.value.colors.blue),formatter:o=>`$${w(o,1,"dollar")}${P(o)}`,minMove:.01})});pe(a);function a(){if(!l.value||!t.apr)return;const o=e.apr.map(r=>({time:r.timestamp.getUTCTimestamp(),value:r.apr})).uniqWith((r,u)=>r.time===u.time).orderBy(r=>r.time,"asc");o.length>0&&t.apr.setData(o),l.value.timeScale().fitContent()}return(o,r)=>{const u=ve,p=ge,g=S;return _(),f(g,{ref_key:"card",ref:i,title:"APR"},{actions:b(()=>[m("div",da,[d(u,{filename:"apr",series:n(t)},null,8,["series"]),d(p,{chart:n(l),target:n(i)},null,8,["chart","target"])])]),default:b(()=>[m("div",ua,null,512)]),_:1},512)}}}),pa={style:{display:"flex"}},_a={ref:"chartRef",class:"chart"},ma=D({__name:"ChartTvl",props:{tvl:{}},setup(e){const s=ue(),i=ce("card"),{chart:l,series:t}=_e({createChartOptions:be(),series:me({name:"tvl",color:$(()=>s.value.colors.blue),formatter:o=>`$${w(o,1,"dollar")}${P(o)}`})});pe(a);function a(){if(!l.value||!t.tvl)return;const o=e.tvl.map(r=>({time:r.timestamp.getUTCTimestamp(),value:r.tvl})).uniqWith((r,u)=>r.time===u.time).orderBy(r=>r.time,"asc");o.length>0&&t.tvl.setData(o),l.value.timeScale().fitContent()}return(o,r)=>{const u=ve,p=ge,g=S;return _(),f(g,{ref_key:"card",ref:i,title:"TVL"},{actions:b(()=>[m("div",pa,[d(u,{filename:"tvl",series:n(t)},null,8,["series"]),d(p,{chart:n(l),target:n(i)},null,8,["chart","target"])])]),default:b(()=>[m("div",_a,null,512)]),_:1},512)}}}),ba={class:"kpis"},ga=D({__name:"OverviewKPIs",props:{pair:{}},setup(e){return(s,i)=>{const l=M,t=Y;return _(),R("div",ba,[d(t,{label:"Positions","has-value":!!s.pair},{default:b(()=>{var a;return[d(l,{precision:0,value:(a=s.pair)==null?void 0:a.activePositionsCount},null,8,["value"])]}),_:1},8,["has-value"]),d(t,{label:"TVL","has-value":!!s.pair},{default:b(()=>{var a;return[d(l,{type:"dollar",precision:2,value:(a=s.pair)==null?void 0:a.totalUnderlying,"show-symbol":!1},null,8,["value"]),T(" "+k(s.pair.tokenPairUnderyling.symbol),1)]}),_:1},8,["has-value"]),d(t,{label:"Debt","has-value":!!s.pair},{default:b(()=>{var a;return[d(l,{type:"dollar",precision:2,value:(a=s.pair)==null?void 0:a.totalDebt,"show-symbol":!1},null,8,["value"]),T(" "+k(s.pair.tokenDebt.symbol),1)]}),_:1},8,["has-value"]),d(t,{label:"Interest Rate","has-value":!!s.pair},{default:b(()=>{var a;return[d(l,{type:"percentage",precision:2,value:(a=s.pair)==null?void 0:a.aprBorrowCost},null,8,["value"])]}),_:1},8,["has-value"]),d(t,{label:"Utilization Rate","has-value":!!s.pair},{default:b(()=>{var a;return[d(l,{type:"percentage",precision:2,value:(a=s.pair)==null?void 0:a.utilizationRate},null,8,["value"])]}),_:1},8,["has-value"])])}}}),va=C(ga,[["__scopeId","data-v-f9c74313"]]),ha={class:"dashboard-grid"},fa=D({__name:"Overview",props:{pair:{}},setup(e){const{isFetching:s,data:i}=je(H(()=>({pair_id:e.pair.pairId}))),l=$(()=>(i.value??[]).map(a=>({timestamp:a.time,tvl:a.totalUnderlying}))),t=$(()=>(i.value??[]).map(a=>({timestamp:a.time,apr:a.aprBase})));return(a,o)=>(_(),R("div",ha,[d(va,{style:{"grid-area":"kpis"},pair:a.pair},null,8,["pair"]),d(ma,{style:{"grid-area":"tvl"},tvl:n(l),loading:n(s)},null,8,["tvl","loading"]),d(ca,{style:{"grid-area":"apr"},apr:n(t),loading:n(s)},null,8,["apr","loading"])]))}}),ya=C(fa,[["__scopeId","data-v-4cf4f302"]]),$a=["href"],Da={class:"end"},Ca={class:"end"},ka={class:"end",style:{display:"flex",gap:"1ch"}},wa={class:"end"},Pa={class:"end"},Ra=["href"],Fa=D({__name:"TableRedemptions",props:{redemptions:{},count:{},pair:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:s}){const i=s,{page:l,onPage:t}=oe(),a=ee(l,200);W(a,r=>{i("page",r)});const{relativeTime:o}=le();return(r,u)=>{const p=re,g=M,L=se,F=ae,K=S;return _(),f(K,{title:"Redemptions"},{actions:b(()=>[d(p,{"items-count":r.count,"items-per-page":10,page:n(l),onPage:n(t)},null,8,["items-count","page","onPage"])]),default:b(()=>[e.redemptions.length>0?(_(),f(L,{key:0,rows:e.redemptions,columns:["Caller",{label:"reUSD",align:"end"},{label:"Debt reduction",align:"end"},{label:"Collateral freed",align:"end"},{label:"Protocol fee",align:"end"},{label:"Time",align:"end"}]},{row:b(({item:h})=>[m("div",null,[m("a",{target:"_blank",href:`https://etherscan.io/address/${h.caller}`,onClick:u[0]||(u[0]=E(()=>{},["stop"]))},k(h.caller.ens||("addressShort"in r?r.addressShort:n(G))(h.caller.address)),9,$a)]),m("div",Da,[d(g,{type:"dollar",value:h.amount/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),m("div",Ca,[d(g,{type:"dollar",value:h.debtReduction/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),m("div",ka,[d(g,{type:"dollar",value:h.collateralFreed/10**18,precision:2,"show-symbol":!1},null,8,["value"]),T(" "+k(r.pair.tokenCollateral.symbol),1)]),m("div",wa,[d(g,{type:"dollar",value:h.protocolFee/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),m("div",Pa,[m("a",{target:"_blank",href:`https://etherscan.io/tx/${h.txHash}`,onClick:u[1]||(u[1]=E(()=>{},["stop"]))},k(n(o)(h.blockTime.getUTCTimestamp())),9,Ra)])]),_:1},8,["rows"])):r.loading?q("",!0):(_(),f(F,{key:1,message:"There are no redemptions"}))]),_:1})}}}),qa=C(Fa,[["__scopeId","data-v-bbc74a72"]]),Ta={class:"dashboard-grid"},La=D({__name:"Redemptions",props:{pair:{}},setup(e){const s=te(1),{isFetching:i,data:l}=Qe($(()=>({pair_id:e.pair.pairId,page:s.value,per_page:15})));return(t,a)=>{var o,r;return _(),R("div",Ta,[d(qa,{redemptions:((o=n(l))==null?void 0:o.events)??[],count:((r=n(l))==null?void 0:r.count)??0,loading:n(i),pair:t.pair,onPage:a[0]||(a[0]=u=>s.value=u)},null,8,["redemptions","count","loading","pair"])])}}}),Ia=C(La,[["__scopeId","data-v-eda307c4"]]),Sa={class:"dashboard"},Ua=D({__name:"Pair.page",setup(e){const s=de("protocolName"),i=de("pairId",void 0,{transform:Number}),{isFetching:l,data:t}=Ce($(()=>({chain:"ethereum",protocol_name:s.value})),$(()=>!!s.value)),a=$(()=>(t.value??[]).find(p=>p.pairId===i.value)),{crumbs:o}=ye($e());W(a,p=>{o.value=[{id:"protocols",label:"Protocols",pathName:"protocols",params:()=>({protocolName:s.value})},{id:"protocol",label:s.value,pathName:"protocols",params:()=>({protocolName:s.value})},{id:"pair",label:`Pair: ${p!=null&&p.name?ke(p.name):"?"}`}]},{immediate:!0});const{tabActive:r,tabActiveIndex:u}=Fe(["overview","collateral","redemptions","liquidations","health"],"pair",void 0,{tabParamName:"pairTab"});return(p,g)=>{const L=De,F=he,K=fe;return _(),R("div",Sa,[d(L,{loading:n(l)},null,8,["loading"]),!n(l)&&n(a)?(_(),f(K,{key:0,active:n(u),onTab:g[0]||(g[0]=h=>u.value=h.index)},{default:b(()=>[d(F,{header:"Overview"},{default:b(()=>[(_(),f(O,null,[n(r)==="overview"?(_(),f(ya,{key:0,pair:n(a)},null,8,["pair"])):q("",!0)],1024))]),_:1}),d(F,{header:"Collateral"},{default:b(()=>[(_(),f(O,null,[n(r)==="collateral"?(_(),f(nt,{key:0,pair:n(a)},null,8,["pair"])):q("",!0)],1024))]),_:1}),d(F,{header:"Redemptions"},{default:b(()=>[(_(),f(O,null,[n(r)==="redemptions"?(_(),f(Ia,{key:0,pair:n(a)},null,8,["pair"])):q("",!0)],1024))]),_:1}),d(F,{header:"Liquidation"},{default:b(()=>[(_(),f(O,null,[n(r)==="liquidations"?(_(),f(ia,{key:0,pair:n(a)},null,8,["pair"])):q("",!0)],1024))]),_:1}),d(F,{header:"Health"},{default:b(()=>[(_(),f(O,null,[n(r)==="health"?(_(),f(Yt,{key:0,pair:n(a)},null,8,["pair"])):q("",!0)],1024))]),_:1})]),_:1},8,["active"])):q("",!0)])}}}),es=C(Ua,[["__scopeId","data-v-9fb4fef3"]]);export{es as default};
