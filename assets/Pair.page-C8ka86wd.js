import{a as he,_ as fe}from"./TabItem.vue_vue_type_script_setup_true_lang-C5Ot3N1j.js";import{al as I,aI as Z,d as D,as as ee,au as W,b as f,o as p,_ as S,e as m,am as F,f as b,m as k,j as R,g as i,k as T,av as H,h as l,l as C,ah as te,c as $,t as M,an as G,u as ue,a as de,w as pe,aE as ye,aF as $e,ax as De,aH as O}from"./index-BgPU8Sw7.js";import{a as Ce}from"./protocols-ChmxaRVP.js";import{p as ke}from"./util-CVNQ9WdU.js";import{t as z,b as j,f as x,a as U,g as we,r as w,u as P}from"./Number-DpAK-pXX.js";import{d as Pe,o as y,s as d,a as A,n as v,e as X,p as Q,t as Y,c as B,g as N,_ as E}from"./AsyncValue-iTYOvWr4.js";import{p as Re}from"./Pagination-vgbH7lYO.js";import{_ as ae}from"./NoData-DqQQgcUL.js";import{_ as se}from"./Table-CvXFjjfl.js";import{a as oe,_ as re}from"./UsePagination-CVTD_cJr.js";import{u as ne}from"./UseRelativeTime-nGpi85-e.js";import{_ as le}from"./ChartApex-ChAnXxxG.js";import{c as ie}from"./ChartStylesApex-DrUXJIUA.js";import{_ as J}from"./KPI-CngUDtHK.js";import{u as _e,c as me,a as be,_ as ge}from"./UseLightweightChart-Bx3pg8jN.js";import{_ as ve}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-BmD2VBda.js";import{a as ce}from"./index-BAU3YeOn.js";import{u as qe}from"./UseTabNavigation-DQ-6j0tw.js";import"./Tooltip-DzxxnI9b.js";const Fe=Pe(["borrow","add_collateral","remove_collateral","repay","redeem","liquidate","leveraged_position","repay_with_collateral"]),Te=y({token_address:d(),token_symbol:d(),apr:d()}).transform(e=>({tokenAddress:e.token_address,tokenSymbol:e.token_symbol,apr:parseFloat(e.apr)})),Le=y({date_timestamp:v(),total_collateral:d(),total_underlying:d(),exchange_rate:d(),total_debt:d(),active_positions_count:v(),borrow_limit:d(),utilization_rate:d(),interest_rate:d(),claimable_fees:d(),claimable_other_fees:d(),borrow_cost_apr:d(),base_apr:d(),rewards:A(Te)}).transform(e=>({time:z(e.date_timestamp),totalCollateral:parseFloat(e.total_collateral),totalUnderlying:parseFloat(e.total_underlying),exchangeRate:parseFloat(e.exchange_rate),totalDebt:parseFloat(e.total_debt),activePositionsCount:e.active_positions_count,borrowLimit:parseFloat(e.borrow_limit),utilizationRate:parseFloat(e.utilization_rate),interestRate:parseFloat(e.interest_rate),claimableFees:parseFloat(e.claimable_fees),claimableOtherFees:parseFloat(e.claimable_other_fees),aprBorrowCost:parseFloat(e.borrow_cost_apr),aprBase:parseFloat(e.base_apr),rewards:e.rewards})),Ie=y({snapshots:A(Le),count:v(),page:v(),total_pages:v()}).transform(e=>({snapshots:e.snapshots,count:e.count,page:e.page,totalPages:e.total_pages})),Se=y({event_type:Fe,block_timestamp:v(),tx_hash:d(),block_number:v(),collateral_change:d(),debt_change:d()}).transform(e=>({eventType:e.event_type,blockTime:z(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,collateralChange:parseFloat(e.collateral_change),debtChange:parseFloat(e.debt_change)})),xe=y({events:A(Se),count:v(),page:v(),total_pages:v()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),Ue=y({block_timestamp:v(),tx_hash:d(),block_number:v(),caller:X,amount:d(),collateral_freed:d(),protocol_fee:d(),debt_reduction:d()}).transform(e=>({blockTime:z(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,caller:e.caller,amount:parseFloat(e.amount),collateralFreed:parseFloat(e.collateral_freed),protocolFee:parseFloat(e.protocol_fee),debtReduction:parseFloat(e.debt_reduction)})),Ae=y({events:A(Ue),count:v(),page:v(),total_pages:v()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),Be=y({block_timestamp:v(),tx_hash:d(),block_number:v(),borrower:X,liquidator:X,collateral_for_liquidator:d(),shares_liquidated:d(),amount_liquidator_to_repay:d()}).transform(e=>({blockTime:z(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,borrower:e.borrower,liquidator:e.liquidator,collateralForLiquidator:parseFloat(e.collateral_for_liquidator),sharesLiquidated:parseFloat(e.shares_liquidated),amountLiquidatorToRepay:parseFloat(e.amount_liquidator_to_repay)})),Ne=y({events:A(Be),count:v(),page:v(),total_pages:v()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),Ke=y({...B,...Y,...Q});async function Ve(e,s){const c=N(s),{pair_id:r,...t}=Ke.parse(e),a=j(t),o=await x(`${c}/v1/pairs/${r}/snapshots${a}`,void 0,s==null?void 0:s.signal);return Ie.parse(o)}const Ee=y({...B,...Y,...Q});async function He(e,s){const c=N(s),{pair_id:r,...t}=Ee.parse(e),a=j(t),o=await x(`${c}/v1/pairs/${r}/collateral_events${a}`,void 0,s==null?void 0:s.signal);return xe.parse(o)}const Oe=y({...B,...Y,...Q});async function Me(e,s){const c=N(s),{pair_id:r,...t}=Oe.parse(e),a=j(t),o=await x(`${c}/v1/pairs/${r}/redemptions${a}`,void 0,s==null?void 0:s.signal);return Ae.parse(o)}const We=y({...B,...Y,...Q});async function ze(e,s){const c=N(s),{pair_id:r,...t}=We.parse(e),a=j(t),o=await x(`${c}/v1/pairs/${r}/liquidations${a}`,void 0,s==null?void 0:s.signal);return Ne.parse(o)}function je(e){const{start:s,end:c}=we({daysRange:90});return U({queryKey:["pairs-snapshots",e],queryFn:()=>Re((t,a)=>Ve({...I(e),page:t,per_page:a,start:s,end:c}).then(o=>o.snapshots),1,100)})}function Qe(e){return U({queryKey:["pairs-collateral-events",e],queryFn:()=>He(I(e)),placeholderData:Z})}function Ye(e){return U({queryKey:["pairs-redemptions",e],queryFn:()=>Me(I(e)),placeholderData:Z})}function Je(e){return U({queryKey:["pairs-liquidations",e],queryFn:()=>ze(I(e)),placeholderData:Z})}const Ge={class:"end"},Xe={key:0,style:{display:"flex",gap:"1ch"}},Ze={class:"end"},et={key:0,style:{display:"flex",gap:"1ch"}},tt={class:"end"},at=["href"],st=D({__name:"TableCollateralEvents",props:{events:{},count:{},pair:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:s}){const c=s,{page:r,onPage:t}=oe(),a=ee(r,200);W(a,u=>{c("page",u)});const{relativeTime:o}=ne(),n=u=>{switch(u.eventType){case"add_collateral":return"Add collateral";case"borrow":return"Borrow";case"remove_collateral":return"Remove collateral";case"repay":return"Repay";case"redeem":return"Redeem";case"liquidate":return"Liquidate";case"leveraged_position":return"Lev. position";case"repay_with_collateral":return"Repay with col"}};return(u,_)=>{const g=re,L=E,q=se,K=ae,h=S;return p(),f(h,{title:"Events"},{actions:m(()=>[i(g,{"items-count":u.count,"items-per-page":10,page:l(r),onPage:l(t)},null,8,["items-count","page","onPage"])]),default:m(()=>[e.events.length>0?(p(),f(q,{key:0,rows:e.events,columns:["Type",{label:"Δ Debt",align:"end"},{label:"Δ Collateral",align:"end"},{label:"Time",align:"end"}]},{row:m(({item:V})=>[b("div",null,k(n(V)),1),b("div",Ge,[V.debtChange!==0?(p(),R("div",Xe,[i(L,{type:"dollar",value:V.debtChange/10**18,precision:2,"show-symbol":!1},null,8,["value"]),T(" "+k(u.pair.tokenDebt.symbol),1)])):F("",!0)]),b("div",Ze,[V.collateralChange!==0?(p(),R("div",et,[i(L,{type:"dollar",value:V.collateralChange/10**18,precision:2,"show-symbol":!1},null,8,["value"]),T(" "+k(u.pair.tokenCollateral.symbol),1)])):F("",!0)]),b("div",tt,[b("a",{target:"_blank",href:`https://etherscan.io/tx/${V.txHash}`,onClick:_[0]||(_[0]=H(()=>{},["stop"]))},k(l(o)(V.blockTime.getUTCTimestamp())),9,at)])]),_:1},8,["rows"])):u.loading?F("",!0):(p(),f(K,{key:1,message:"There are no events"}))]),_:1})}}}),ot=C(st,[["__scopeId","data-v-f018f232"]]),rt={class:"dashboard-grid"},nt=D({__name:"Collateral",props:{pair:{}},setup(e){const s=te(1),{isFetching:c,data:r}=Qe($(()=>({pair_id:e.pair.pairId,page:s.value,per_page:15})));return(t,a)=>{var o,n;return p(),R("div",rt,[i(ot,{events:((o=l(r))==null?void 0:o.events)??[],count:((n=l(r))==null?void 0:n.count)??0,loading:l(c),pair:t.pair,onPage:a[0]||(a[0]=u=>s.value=u)},null,8,["events","count","loading","pair"])])}}}),lt=C(nt,[["__scopeId","data-v-ff086716"]]),it=y({range_label:d(),user_count:v(),total_debt:d()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),ct=y({bins:A(it),total_users:v(),total_debt:d(),min_ratio:d(),max_ratio:d(),median_ratio:d()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),minRatio:parseFloat(e.min_ratio),maxRatio:parseFloat(e.max_ratio),medianRatio:parseFloat(e.median_ratio)})),ut=y({range_label:d(),user_count:v(),total_debt:d()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),dt=y({bins:A(ut),total_users:v(),total_debt:d(),min_debt:d(),max_debt:d(),median_debt:d()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),minDebt:parseFloat(e.min_debt),maxDebt:parseFloat(e.max_debt),medianDebt:parseFloat(e.median_debt)})),pt=y({leveraged_users_count:v(),non_leveraged_users_count:v(),leveraged_debt:d(),non_leveraged_debt:d(),total_users:v(),total_debt:d(),leveraged_users_percentage:d(),leveraged_debt_percentage:d()}).transform(e=>({leveragedUsersCount:e.leveraged_users_count,nonLeveragedUsersCount:e.non_leveraged_users_count,leveragedDebt:parseFloat(e.leveraged_debt),nonLeveragedDebt:parseFloat(e.non_leveraged_debt),totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),leveragedUsersPercentage:parseFloat(e.leveraged_users_percentage),leveragedDebtPercentage:parseFloat(e.leveraged_debt_percentage)})),_t=y({stats:pt}).transform(e=>({stats:e.stats})),mt=y({range_label:d(),user_count:v(),total_debt:d()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),bt=y({bins:A(mt),total_users:v(),total_debt:d()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt)})),gt=y(B);async function vt(e,s){const c=N(s),{pair_id:r}=gt.parse(e),t=await x(`${c}/v1/health/${r}/leverage_stats`,void 0,s==null?void 0:s.signal);return _t.parse(t)}const ht=y(B);async function ft(e,s){const c=N(s),{pair_id:r}=ht.parse(e),t=await x(`${c}/v1/health/${r}/leverage_distribution`,void 0,s==null?void 0:s.signal);return bt.parse(t)}const yt=y(B);async function $t(e,s){const c=N(s),{pair_id:r}=yt.parse(e),t=await x(`${c}/v1/health/${r}/debt_distribution`,void 0,s==null?void 0:s.signal);return dt.parse(t)}const Dt=y(B);async function Ct(e,s){const c=N(s),{pair_id:r}=Dt.parse(e),t=await x(`${c}/v1/health/${r}/collateral_ratio_distribution`,void 0,s==null?void 0:s.signal);return ct.parse(t)}function kt(e){return U({queryKey:["health-leverage-stats",e],queryFn:()=>vt(I(e))})}function wt(e){return U({queryKey:["health-leverage-distribution",e],queryFn:()=>ft(I(e))})}function Pt(e){return U({queryKey:["health-debt-distribution",e],queryFn:()=>$t(I(e))})}function Rt(e){return U({queryKey:["health-collateral-ratio-distribution",e],queryFn:()=>Ct(I(e))})}const qt=D({__name:"ChartCollateralRatioDistribution",props:{data:{}},setup(e){const s=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1},stacked:!1},xaxis:{categories:c.value,labels:{formatter:t=>t,rotate:-30,offsetY:10,rotateAlways:!0},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${w(t,0,"dollar")}${P(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const a=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${c.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${a}</div>
                <div><b>Debt:</b></div><div>$${w(o,2,"dollar")}${P(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${w(o/a,2,"dollar")}${P(o/a)}</div>
                </div>`}},legend:{show:!0}})),c=$(()=>{var t;return(((t=e.data)==null?void 0:t.bins)??[]).map(a=>{const[o,n]=a.rangeLabel.split(" - ").map(parseFloat),u=`${Math.round(o*100)}%`,_=`${Math.round(n*100)}%`;return`${u} - ${_}`})}),r=$(()=>{var t,a;return[{name:"Users",type:"column",data:(((t=e.data)==null?void 0:t.bins)??[]).map(o=>o.userCount)},{name:"Debt",type:"line",data:(((a=e.data)==null?void 0:a.bins)??[]).map(o=>o.totalDebt)}]});return(t,a)=>{const o=le,n=S;return p(),f(n,{title:"Collateral Ratio Distribution"},{default:m(()=>[i(o,{options:l(s),series:l(r)},null,8,["options","series"])]),_:1})}}}),Ft=C(qt,[["__scopeId","data-v-12a4a7ca"]]),Tt=D({__name:"ChartDebtDistribution",props:{data:{}},setup(e){const s=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1},stacked:!1},xaxis:{categories:c.value,labels:{formatter:t=>t,rotate:-30,offsetY:10,rotateAlways:!0},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${w(t,0,"dollar")}${P(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const a=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${c.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${a}</div>
                <div><b>Debt:</b></div><div>$${w(o,2,"dollar")}${P(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${w(o/a,2,"dollar")}${P(o/a)}</div>
                </div>`}},legend:{show:!0}})),c=$(()=>{var t;return(((t=e.data)==null?void 0:t.bins)??[]).map(a=>{const[o,n]=a.rangeLabel.split(" - ").map(parseFloat),u=`$${w(o,0,"dollar")}${P(o)}`,_=`$${w(n,0,"dollar")}${P(n)}`;return`${u} - ${_}`})}),r=$(()=>{var t,a;return[{name:"Users",type:"column",data:(((t=e.data)==null?void 0:t.bins)??[]).map(o=>o.userCount)},{name:"Debt",type:"line",data:(((a=e.data)==null?void 0:a.bins)??[]).map(o=>o.totalDebt)}]});return(t,a)=>{const o=le,n=S;return p(),f(n,{title:"Debt Distribution"},{default:m(()=>[i(o,{options:l(s),series:l(r)},null,8,["options","series"])]),_:1})}}}),Lt=C(Tt,[["__scopeId","data-v-4e9af251"]]),It=D({__name:"ChartLeverageDistribution",props:{data:{}},setup(e){const s=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},zoom:{enabled:!1}},xaxis:{categories:c.value,labels:{formatter:t=>t,rotate:-30},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${w(t,0,"dollar")}${P(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const a=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${c.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${a}</div>
                <div><b>Debt:</b></div><div>$${w(o,2,"dollar")}${P(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${w(o/a,2,"dollar")}${P(o/a)}</div>
                </div>`}},legend:{show:!0}})),c=$(()=>{var t;return(((t=e.data)==null?void 0:t.bins)??[]).map(a=>a.rangeLabel)}),r=$(()=>{var t,a;return[{name:"Users",type:"column",data:(((t=e.data)==null?void 0:t.bins)??[]).map(o=>o.userCount)},{name:"Debt",type:"line",data:(((a=e.data)==null?void 0:a.bins)??[]).map(o=>o.totalDebt)}]});return(t,a)=>{const o=le,n=S;return p(),f(n,{title:"Leverage Distribution"},{default:m(()=>[i(o,{options:l(s),series:l(r)},null,8,["options","series"])]),_:1})}}}),St=C(It,[["__scopeId","data-v-a155220c"]]),xt={class:"kpis"},Ut={class:"kpi-subvalue"},At=D({__name:"CollateralRatioKPIs",props:{collateralRatio:{}},setup(e){const s=$(()=>{if(!e.collateralRatio||e.collateralRatio.bins.length===0)return;const c=[...e.collateralRatio.bins].sort((r,t)=>t.userCount-r.userCount)[0];return{range:c.rangeLabel,users:c.userCount}});return(c,r)=>{var o;const t=E,a=J;return p(),R("div",xt,[i(a,{label:"Median Collateral Ratio","has-value":!!((o=c.collateralRatio)!=null&&o.medianRatio)},{default:m(()=>{var n;return[i(t,{type:"percentage",value:(n=c.collateralRatio)==null?void 0:n.medianRatio,precision:2},null,8,["value"])]}),_:1},8,["has-value"]),i(a,{label:"Most Common Collateral Ratio","has-value":!!l(s)},{default:m(()=>{var n,u;return[b("div",null,k(((n=l(s))==null?void 0:n.range)??"N/A"),1),b("div",Ut,[i(t,{value:((u=l(s))==null?void 0:u.users)??"?",precision:0},null,8,["value"]),r[0]||(r[0]=T(" users "))])]}),_:1},8,["has-value"])])}}}),Bt=C(At,[["__scopeId","data-v-b6a9aae9"]]),Nt={class:"kpis"},Kt=D({__name:"DebtKPIs",props:{debt:{}},setup(e){return(s,c)=>{var a,o;const r=E,t=J;return p(),R("div",Nt,[i(t,{label:"Max Debt","has-value":!!((a=s.debt)!=null&&a.maxDebt)},{default:m(()=>{var n;return[i(r,{type:"dollar",value:(n=s.debt)==null?void 0:n.maxDebt,precision:2,"show-symbol":!1},null,8,["value"])]}),_:1},8,["has-value"]),i(t,{label:"Median Debt","has-value":!!((o=s.debt)!=null&&o.medianDebt)},{default:m(()=>{var n;return[i(r,{type:"dollar",value:(n=s.debt)==null?void 0:n.medianDebt,precision:2,"show-symbol":!1},null,8,["value"])]}),_:1},8,["has-value"])])}}}),Vt=C(Kt,[["__scopeId","data-v-8ffe283b"]]),Et={class:"kpis"},Ht={class:"kpi-subvalue"},Ot={class:"kpi-subvalue"},Mt={class:"kpi-subvalue"},Wt={class:"kpi-subvalue"},zt=D({__name:"LeverageKPIs",props:{leverage:{},leverageStats:{}},setup(e){const s=$(()=>{if(!e.leverage||e.leverage.bins.length===0)return;const r=[...e.leverage.bins].sort((t,a)=>a.userCount-t.userCount)[0];return{range:r.rangeLabel,users:r.userCount}}),c=$(()=>{if(!e.leverage||e.leverage.bins.length===0)return;const r=[...e.leverage.bins].sort((t,a)=>a.totalDebt-t.totalDebt)[0];return{range:r.rangeLabel,debt:r.totalDebt}});return(r,t)=>{var n,u;const a=E,o=J;return p(),R("div",Et,[i(o,{label:"Most Common Range","has-value":!!l(s)},{default:m(()=>{var _,g;return[b("div",null,k(((_=l(s))==null?void 0:_.range)??"N/A"),1),b("div",Ht,[i(a,{value:((g=l(s))==null?void 0:g.users)??"?",precision:0},null,8,["value"]),t[0]||(t[0]=T(" users "))])]}),_:1},8,["has-value"]),i(o,{label:"Highest Debt Range","has-value":!!l(c)},{default:m(()=>{var _,g;return[b("div",null,k((_=l(c))==null?void 0:_.range),1),b("div",Ot,[i(a,{type:"dollar",value:(g=l(c))==null?void 0:g.debt,precision:2},null,8,["value"])])]}),_:1},8,["has-value"]),i(o,{label:"Leveraged Users","has-value":!!((n=r.leverageStats)!=null&&n.stats)},{default:m(()=>{var _,g;return[i(a,{value:(_=r.leverageStats)==null?void 0:_.stats.leveragedUsersCount,precision:0},null,8,["value"]),b("div",Mt,[i(a,{type:"percentage",value:(g=r.leverageStats)==null?void 0:g.stats.leveragedUsersPercentage,precision:2},null,8,["value"]),t[1]||(t[1]=T(" of total "))])]}),_:1},8,["has-value"]),i(o,{label:"Leveraged Debt","has-value":!!((u=r.leverageStats)!=null&&u.stats)},{default:m(()=>{var _,g;return[i(a,{type:"dollar",value:(_=r.leverageStats)==null?void 0:_.stats.leveragedDebt,precision:2,"show-symbol":!1},null,8,["value"]),b("div",Wt,[i(a,{type:"percentage",value:(g=r.leverageStats)==null?void 0:g.stats.leveragedDebtPercentage,precision:2},null,8,["value"]),t[2]||(t[2]=T(" of total "))])]}),_:1},8,["has-value"])])}}}),jt=C(zt,[["__scopeId","data-v-ae4a0874"]]),Qt={class:"dashboard-grid"},Yt=D({__name:"Health",props:{pair:{}},setup(e){const{isFetching:s,data:c}=wt(M(()=>({pair_id:e.pair.pairId}))),{isFetching:r,data:t}=Pt(M(()=>({pair_id:e.pair.pairId}))),{data:a}=kt(M(()=>({pair_id:e.pair.pairId}))),{isFetching:o,data:n}=Rt(M(()=>({pair_id:e.pair.pairId})));return(u,_)=>(p(),R("div",Qt,[i(jt,{style:{"grid-area":"kpis-leverage"},leverage:l(c),"leverage-stats":l(a)},null,8,["leverage","leverage-stats"]),i(St,{style:{"grid-area":"chart-leverage-distribution"},data:l(c),loading:l(s)},null,8,["data","loading"]),i(Vt,{style:{"grid-area":"kpis-debt"},debt:l(t)},null,8,["debt"]),i(Lt,{style:{"grid-area":"chart-debt-distribution"},data:l(t),loading:l(r)},null,8,["data","loading"]),i(Bt,{style:{"grid-area":"kpis-collateral-ratio"},"collateral-ratio":l(n)},null,8,["collateral-ratio"]),i(Ft,{style:{"grid-area":"chart-collateral-ratio-distribution"},data:l(n),loading:l(o)},null,8,["data","loading"])]))}}),Jt=C(Yt,[["__scopeId","data-v-f2964c3a"]]),Gt=["href"],Xt=["href"],Zt={class:"end"},ea={class:"end"},ta={class:"end"},aa={class:"end"},sa=["href"],oa=D({__name:"TableLiquidations",props:{liquidations:{},count:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:s}){const c=s,{page:r,onPage:t}=oe(),a=ee(r,200);W(a,n=>{c("page",n)});const{relativeTime:o}=ne();return(n,u)=>{const _=re,g=E,L=se,q=ae,K=S;return p(),f(K,{title:"Liquidations"},{actions:m(()=>[i(_,{"items-count":n.count,"items-per-page":10,page:l(r),onPage:l(t)},null,8,["items-count","page","onPage"])]),default:m(()=>[e.liquidations.length>0?(p(),f(L,{key:0,rows:e.liquidations,columns:["Borrower","Liquidator",{label:"Shares liquidated",align:"end"},{label:"Collat for liquidator",align:"end"},{label:"Amount to repay",align:"end"},{label:"Time",align:"end"}]},{row:m(({item:h})=>[b("div",null,[b("a",{target:"_blank",href:`https://etherscan.io/address/${h.borrower}`,onClick:u[0]||(u[0]=H(()=>{},["stop"]))},k(h.borrower.ens||("addressShort"in n?n.addressShort:l(G))(h.borrower.address)),9,Gt)]),b("div",null,[b("a",{target:"_blank",href:`https://etherscan.io/address/${h.liquidator}`,onClick:u[1]||(u[1]=H(()=>{},["stop"]))},k(h.liquidator.ens||("addressShort"in n?n.addressShort:l(G))(h.liquidator.address)),9,Xt)]),b("div",Zt,[i(g,{type:"dollar",value:h.sharesLiquidated,precision:2,"show-symbol":!1},null,8,["value"])]),b("div",ea,[i(g,{type:"dollar",value:h.collateralForLiquidator,precision:2,"show-symbol":!1},null,8,["value"])]),b("div",ta,[i(g,{type:"dollar",value:h.amountLiquidatorToRepay,precision:2,"show-symbol":!1},null,8,["value"])]),b("div",aa,[b("a",{target:"_blank",href:`https://etherscan.io/tx/${h.txHash}`,onClick:u[2]||(u[2]=H(()=>{},["stop"]))},k(l(o)(h.blockTime.getUTCTimestamp())),9,sa)])]),_:1},8,["rows"])):n.loading?F("",!0):(p(),f(q,{key:1,message:"There are no liquidations"}))]),_:1})}}}),ra=C(oa,[["__scopeId","data-v-1e2df879"]]),na={class:"dashboard-grid"},la=D({__name:"Liquidations",props:{pair:{}},setup(e){const s=te(1),{isFetching:c,data:r}=Je($(()=>({pair_id:e.pair.pairId,page:s.value,per_page:15})));return(t,a)=>{var o,n;return p(),R("div",na,[i(ra,{liquidations:((o=l(r))==null?void 0:o.events)??[],count:((n=l(r))==null?void 0:n.count)??0,loading:l(c),onPage:a[0]||(a[0]=u=>s.value=u)},null,8,["liquidations","count","loading"])])}}}),ia=C(la,[["__scopeId","data-v-0dd6af85"]]),ca={style:{display:"flex"}},ua={ref:"chartRef",class:"chart"},da=D({__name:"ChartApr",props:{apr:{}},setup(e){const s=ue(),c=de("card"),{chart:r,series:t}=_e({createChartOptions:be(),series:me({name:"apr",color:$(()=>s.value.colors.blue),formatter:o=>`$${w(o,1,"dollar")}${P(o)}`,minMove:.01})});pe(a);function a(){if(!r.value||!t.apr)return;const o=e.apr.map(n=>({time:n.timestamp.getUTCTimestamp(),value:n.apr})).uniqWith((n,u)=>n.time===u.time).orderBy(n=>n.time,"asc");o.length>0&&t.apr.setData(o),r.value.timeScale().fitContent()}return(o,n)=>{const u=ve,_=ge,g=S;return p(),f(g,{ref_key:"card",ref:c,title:"APR"},{actions:m(()=>[b("div",ca,[i(u,{filename:"apr",series:l(t)},null,8,["series"]),i(_,{chart:l(r),target:l(c)},null,8,["chart","target"])])]),default:m(()=>[b("div",ua,null,512)]),_:1},512)}}}),pa={style:{display:"flex"}},_a={ref:"chartRef",class:"chart"},ma=D({__name:"ChartTvl",props:{tvl:{}},setup(e){const s=ue(),c=de("card"),{chart:r,series:t}=_e({createChartOptions:be(),series:me({name:"tvl",color:$(()=>s.value.colors.blue),formatter:o=>`$${w(o,1,"dollar")}${P(o)}`})});pe(a);function a(){if(!r.value||!t.tvl)return;const o=e.tvl.map(n=>({time:n.timestamp.getUTCTimestamp(),value:n.tvl})).uniqWith((n,u)=>n.time===u.time).orderBy(n=>n.time,"asc");o.length>0&&t.tvl.setData(o),r.value.timeScale().fitContent()}return(o,n)=>{const u=ve,_=ge,g=S;return p(),f(g,{ref_key:"card",ref:c,title:"TVL"},{actions:m(()=>[b("div",pa,[i(u,{filename:"tvl",series:l(t)},null,8,["series"]),i(_,{chart:l(r),target:l(c)},null,8,["chart","target"])])]),default:m(()=>[b("div",_a,null,512)]),_:1},512)}}}),ba={class:"kpis"},ga=D({__name:"OverviewKPIs",props:{pair:{}},setup(e){return(s,c)=>{const r=E,t=J;return p(),R("div",ba,[i(t,{label:"Positions","has-value":!!s.pair},{default:m(()=>{var a;return[i(r,{precision:0,value:(a=s.pair)==null?void 0:a.activePositionsCount},null,8,["value"])]}),_:1},8,["has-value"]),i(t,{label:"TVL","has-value":!!s.pair},{default:m(()=>{var a;return[i(r,{type:"dollar",precision:2,value:(a=s.pair)==null?void 0:a.totalUnderlying,"show-symbol":!1},null,8,["value"]),T(" "+k(s.pair.tokenPairUnderyling.symbol),1)]}),_:1},8,["has-value"]),i(t,{label:"Debt","has-value":!!s.pair},{default:m(()=>{var a;return[i(r,{type:"dollar",precision:2,value:(a=s.pair)==null?void 0:a.totalDebt,"show-symbol":!1},null,8,["value"]),T(" "+k(s.pair.tokenDebt.symbol),1)]}),_:1},8,["has-value"]),i(t,{label:"Interest Rate","has-value":!!s.pair},{default:m(()=>{var a;return[i(r,{type:"percentage",precision:2,value:(a=s.pair)==null?void 0:a.aprBorrowCost},null,8,["value"])]}),_:1},8,["has-value"]),i(t,{label:"Utilization Rate","has-value":!!s.pair},{default:m(()=>{var a;return[i(r,{type:"percentage",precision:2,value:(a=s.pair)==null?void 0:a.utilizationRate},null,8,["value"])]}),_:1},8,["has-value"])])}}}),va=C(ga,[["__scopeId","data-v-f9c74313"]]),ha={class:"dashboard-grid"},fa=D({__name:"Overview",props:{pair:{}},setup(e){const{isFetching:s,data:c}=je(M(()=>({pair_id:e.pair.pairId}))),r=$(()=>(c.value??[]).map(a=>({timestamp:a.time,tvl:a.totalUnderlying}))),t=$(()=>(c.value??[]).map(a=>({timestamp:a.time,apr:a.aprBase})));return(a,o)=>(p(),R("div",ha,[i(va,{style:{"grid-area":"kpis"},pair:a.pair},null,8,["pair"]),i(ma,{style:{"grid-area":"tvl"},tvl:l(r),loading:l(s)},null,8,["tvl","loading"]),i(da,{style:{"grid-area":"apr"},apr:l(t),loading:l(s)},null,8,["apr","loading"])]))}}),ya=C(fa,[["__scopeId","data-v-4cf4f302"]]),$a=["href"],Da={class:"end"},Ca={class:"end"},ka={class:"end",style:{display:"flex",gap:"1ch"}},wa={class:"end"},Pa={class:"end"},Ra=["href"],qa=D({__name:"TableRedemptions",props:{redemptions:{},count:{},pair:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:s}){const c=s,{page:r,onPage:t}=oe(),a=ee(r,200);W(a,n=>{c("page",n)});const{relativeTime:o}=ne();return(n,u)=>{const _=re,g=E,L=se,q=ae,K=S;return p(),f(K,{title:"Redemptions"},{actions:m(()=>[i(_,{"items-count":n.count,"items-per-page":10,page:l(r),onPage:l(t)},null,8,["items-count","page","onPage"])]),default:m(()=>[e.redemptions.length>0?(p(),f(L,{key:0,rows:e.redemptions,columns:["Caller",{label:"reUSD",align:"end"},{label:"Debt reduction",align:"end"},{label:"Collateral freed",align:"end"},{label:"Protocol fee",align:"end"},{label:"Time",align:"end"}]},{row:m(({item:h})=>[b("div",null,[b("a",{target:"_blank",href:`https://etherscan.io/address/${h.caller}`,onClick:u[0]||(u[0]=H(()=>{},["stop"]))},k(h.caller.ens||("addressShort"in n?n.addressShort:l(G))(h.caller.address)),9,$a)]),b("div",Da,[i(g,{type:"dollar",value:h.amount/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),b("div",Ca,[i(g,{type:"dollar",value:h.debtReduction/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),b("div",ka,[i(g,{type:"dollar",value:h.collateralFreed/10**18,precision:2,"show-symbol":!1},null,8,["value"]),T(" "+k(n.pair.tokenCollateral.symbol),1)]),b("div",wa,[i(g,{type:"dollar",value:h.protocolFee/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),b("div",Pa,[b("a",{target:"_blank",href:`https://etherscan.io/tx/${h.txHash}`,onClick:u[1]||(u[1]=H(()=>{},["stop"]))},k(l(o)(h.blockTime.getUTCTimestamp())),9,Ra)])]),_:1},8,["rows"])):n.loading?F("",!0):(p(),f(q,{key:1,message:"There are no redemptions"}))]),_:1})}}}),Fa=C(qa,[["__scopeId","data-v-bbc74a72"]]),Ta={class:"dashboard-grid"},La=D({__name:"Redemptions",props:{pair:{}},setup(e){const s=te(1),{isFetching:c,data:r}=Ye($(()=>({pair_id:e.pair.pairId,page:s.value,per_page:15})));return(t,a)=>{var o,n;return p(),R("div",Ta,[i(Fa,{redemptions:((o=l(r))==null?void 0:o.events)??[],count:((n=l(r))==null?void 0:n.count)??0,loading:l(c),pair:t.pair,onPage:a[0]||(a[0]=u=>s.value=u)},null,8,["redemptions","count","loading","pair"])])}}}),Ia=C(La,[["__scopeId","data-v-eda307c4"]]),Sa={class:"dashboard"},xa=D({__name:"Pair.page",setup(e){const s=ce("protocolName"),c=ce("pairId",void 0,{transform:Number}),{isFetching:r,data:t}=Ce($(()=>({chain:"ethereum",protocol_name:s.value})),$(()=>!!s.value)),a=$(()=>(t.value??[]).find(_=>_.pairId===c.value)),{crumbs:o}=ye($e());W(a,_=>{o.value=[{id:"protocols",label:"Protocols",pathName:"protocols",params:()=>({protocolName:s.value})},{id:"protocol",label:s.value,pathName:"protocols",params:()=>({protocolName:s.value})},{id:"pair",label:`Pair: ${_!=null&&_.name?ke(_.name):"?"}`}]},{immediate:!0});const{tabActive:n,tabActiveIndex:u}=qe(["overview","collateral","redemptions","liquidations","health"],"pair",void 0,{tabParamName:"pairTab"});return(_,g)=>{const L=De,q=he,K=fe;return p(),R("div",Sa,[i(L,{loading:l(r)},null,8,["loading"]),!l(r)&&l(a)?(p(),f(K,{key:0,active:l(u),onTab:g[0]||(g[0]=h=>u.value=h.index)},{default:m(()=>[i(q,{header:"Overview"},{default:m(()=>[(p(),f(O,null,[l(n)==="overview"?(p(),f(ya,{key:0,pair:l(a)},null,8,["pair"])):F("",!0)],1024))]),_:1}),i(q,{header:"Collateral"},{default:m(()=>[(p(),f(O,null,[l(n)==="collateral"?(p(),f(lt,{key:0,pair:l(a)},null,8,["pair"])):F("",!0)],1024))]),_:1}),i(q,{header:"Redemptions"},{default:m(()=>[(p(),f(O,null,[l(n)==="redemptions"?(p(),f(Ia,{key:0,pair:l(a)},null,8,["pair"])):F("",!0)],1024))]),_:1}),i(q,{header:"Liquidation"},{default:m(()=>[(p(),f(O,null,[l(n)==="liquidations"?(p(),f(ia,{key:0,pair:l(a)},null,8,["pair"])):F("",!0)],1024))]),_:1}),i(q,{header:"Health"},{default:m(()=>[(p(),f(O,null,[l(n)==="health"?(p(),f(Jt,{key:0,pair:l(a)},null,8,["pair"])):F("",!0)],1024))]),_:1})]),_:1},8,["active"])):F("",!0)])}}}),es=C(xa,[["__scopeId","data-v-9fb4fef3"]]);export{es as default};
