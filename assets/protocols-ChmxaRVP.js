var K=e=>{throw TypeError(e)};var M=(e,t,s)=>t.has(e)||K("Cannot "+s);var a=(e,t,s)=>(M(e,t,"read from private field"),s?s.call(e):t.get(e)),f=(e,t,s)=>t.has(e)?K("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),h=(e,t,s,r)=>(M(e,t,"write to private field"),r?r.call(e,s):t.set(e,s),s),d=(e,t,s)=>(M(e,t,"access private method"),s);import{Q as ee,t as S,f as J,b as te,a as T}from"./Number-DpAK-pXX.js";import{aJ as se,aK as N,aL as re,aM as oe,c as k,h as ne,aN as ie,aO as ae,au as j,ai as le,aP as ce,aj as ue,al as V}from"./index-BgPU8Sw7.js";import{o as g,s as i,n as u,a as E,f as I,p as G,t as pe,g as W}from"./AsyncValue-iTYOvWr4.js";import{p as he}from"./Pagination-vgbH7lYO.js";function A(e,t){return e.filter(s=>!t.includes(s))}function me(e,t,s){const r=e.slice(0);return r[t]=s,r}var w,m,O,R,_,y,C,P,q,p,U,$,z,L,H,B,_e=(B=class extends se{constructor(t,s,r){super();f(this,p);f(this,w);f(this,m);f(this,O);f(this,R);f(this,_);f(this,y);f(this,C);f(this,P);f(this,q,[]);h(this,w,t),h(this,R,r),h(this,O,[]),h(this,_,[]),h(this,m,[]),this.setQueries(s)}onSubscribe(){this.listeners.size===1&&a(this,_).forEach(t=>{t.subscribe(s=>{d(this,p,L).call(this,t,s)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,a(this,_).forEach(t=>{t.destroy()})}setQueries(t,s){h(this,O,t),h(this,R,s),N.batch(()=>{const r=a(this,_),n=d(this,p,z).call(this,a(this,O));h(this,q,n),n.forEach(c=>c.observer.setOptions(c.defaultedQueryOptions));const o=n.map(c=>c.observer),l=o.map(c=>c.getCurrentResult()),b=o.some((c,v)=>c!==r[v]);r.length===o.length&&!b||(h(this,_,o),h(this,m,l),this.hasListeners()&&(A(r,o).forEach(c=>{c.destroy()}),A(o,r).forEach(c=>{c.subscribe(v=>{d(this,p,L).call(this,c,v)})}),d(this,p,H).call(this)))})}getCurrentResult(){return a(this,m)}getQueries(){return a(this,_).map(t=>t.getCurrentQuery())}getObservers(){return a(this,_)}getOptimisticResult(t,s){const r=d(this,p,z).call(this,t),n=r.map(o=>o.observer.getOptimisticResult(o.defaultedQueryOptions));return[n,o=>d(this,p,$).call(this,o??n,s),()=>d(this,p,U).call(this,n,r)]}},w=new WeakMap,m=new WeakMap,O=new WeakMap,R=new WeakMap,_=new WeakMap,y=new WeakMap,C=new WeakMap,P=new WeakMap,q=new WeakMap,p=new WeakSet,U=function(t,s){return s.map((r,n)=>{const o=t[n];return r.defaultedQueryOptions.notifyOnChangeProps?o:r.observer.trackResult(o,l=>{s.forEach(b=>{b.observer.trackProp(l)})})})},$=function(t,s){return s?((!a(this,y)||a(this,m)!==a(this,P)||s!==a(this,C))&&(h(this,C,s),h(this,P,a(this,m)),h(this,y,re(a(this,y),s(t)))),a(this,y)):t},z=function(t){const s=new Map(a(this,_).map(n=>[n.options.queryHash,n])),r=[];return t.forEach(n=>{const o=a(this,w).defaultQueryOptions(n),l=s.get(o.queryHash);l?r.push({defaultedQueryOptions:o,observer:l}):r.push({defaultedQueryOptions:o,observer:new ee(a(this,w),o)})}),r},L=function(t,s){const r=a(this,_).indexOf(t);r!==-1&&(h(this,m,me(a(this,m),r,s)),d(this,p,H).call(this))},H=function(){var t;if(this.hasListeners()){const s=a(this,y),r=d(this,p,U).call(this,a(this,m),a(this,q)),n=d(this,p,$).call(this,r,(t=a(this,R))==null?void 0:t.combine);s!==n&&N.batch(()=>{this.listeners.forEach(o=>{o(a(this,m))})})}},B);function be({queries:e,...t},s){const r=oe(),n=k(()=>ne(e).map(D=>{const F=ie(D);typeof F.enabled=="function"&&(F.enabled=D.enabled());const x=r.defaultQueryOptions(F);return x._optimisticResults=r.isRestoring.value?"isRestoring":"optimistic",x})),o=new _e(r,n.value,t),l=()=>{const[v,D]=o.getOptimisticResult(n.value,t.combine);return D(v.map((F,x)=>({...F,refetch:async(...Y)=>{const[{[x]:Z}]=o.getOptimisticResult(n.value,t.combine);return Z.refetch(...Y)}})))},b=ae(l());let c=()=>{};return j(r.isRestoring,v=>{v||(c(),c=o.subscribe(()=>{b.value=l()}),b.value=l())},{immediate:!0}),j(n,v=>{o.setQueries(v,t),b.value=l()}),le(()=>{c()}),t.shallow?ce(b):ue(b)}const fe=g({name:i(),protocol_id:u(),pairs_count:u(),active_positions_count:u(),total_collateral:i(),total_underlying:i(),total_debt:i()}).transform(e=>({name:e.name,protocolId:e.protocol_id,pairsCount:e.pairs_count,activePositionsCount:e.active_positions_count,totalCollateral:parseFloat(e.total_collateral),totalUnderlying:parseFloat(e.total_underlying),totalDebt:parseFloat(e.total_debt)})),de=g({protocols:E(fe),count:u()}).transform(e=>({protocols:e.protocols,count:e.count})),Q=g({symbol:i(),name:i(),address:i(),precision:u()}).transform(e=>({symbol:e.symbol,name:e.name,address:e.address,precision:e.precision})),ge=g({token_address:i(),token_symbol:i(),apr:i()}).transform(e=>({tokenAddress:e.token_address,tokenSymbol:e.token_symbol,apr:parseFloat(e.apr)})),ve=g({pair_id:u(),name:i(),address:i(),total_collateral:i(),total_underlying:i(),exchange_rate:i(),total_debt:i(),active_positions_count:u(),borrow_limit:i(),utilization_rate:i(),interest_rate:i(),claimable_fees:i(),claimable_other_fees:i(),block_timestamp:u(),last_redemption:u().nullable(),redemption_fee_10k:i(),borrow_cost_apr:i(),base_apr:i(),rewards:E(ge),collateral_token:Q,debt_token:Q,underlying_token:Q,pair_collateral_token:Q,pair_underlying_token:Q}).transform(e=>({pairId:e.pair_id,name:e.name,address:e.address,totalCollateral:parseFloat(e.total_collateral),totalUnderlying:parseFloat(e.total_underlying),exchangeRate:parseFloat(e.exchange_rate),totalDebt:parseFloat(e.total_debt),activePositionsCount:e.active_positions_count,borrowLimit:parseFloat(e.borrow_limit),utilizationRate:parseFloat(e.utilization_rate),interestRate:parseFloat(e.interest_rate),claimableFees:parseFloat(e.claimable_fees),claimableOtherFees:parseFloat(e.claimable_other_fees),blockTime:S(e.block_timestamp),lastRedemption:e.last_redemption?S(e.last_redemption):null,redemptionFee10k:parseFloat(e.redemption_fee_10k),aprBorrowCost:parseFloat(e.borrow_cost_apr),aprBase:parseFloat(e.base_apr),rewards:e.rewards,tokenCollateral:e.collateral_token,tokenDebt:e.debt_token,tokenUnderlying:e.underlying_token,tokenPairCollateral:e.pair_collateral_token,tokenPairUnderyling:e.pair_underlying_token})),ye=g({pairs:E(ve),count:u(),page:u(),total_pages:u()}).transform(e=>({pairs:e.pairs,count:e.count,page:e.page,totalPages:e.total_pages})),ke=g({crvusd_price:i(),frxusd_price:i(),block_number:u(),block_timestamp:u()}).transform(e=>({crvusd:parseFloat(e.crvusd_price),frxusd:parseFloat(e.frxusd_price),blockNumber:e.block_number,timestamp:S(e.block_timestamp)}));g({prices:E(ke),count:u(),page:u(),total_pages:u()}).transform(e=>({prices:e.prices,count:e.count,page:e.page,totalPages:e.total_pages}));const we=g(I);async function Oe(e,t){const s=W(t),{chain:r}=we.parse(e),n=await J(`${s}/v1/protocols/overview/${r}`,void 0,t==null?void 0:t.signal);return de.parse(n)}const Re=g({...I,...G,protocol_name:i()});async function Fe(e,t){const s=W(t),{chain:r,protocol_name:n,...o}=Re.parse(e),l=te(o),b=await J(`${s}/v1/protocols/${r}/${n}/pairs${l}`,void 0,t==null?void 0:t.signal);return ye.parse(b)}g({...I,...pe,...G});function Qe(e){return T({queryKey:["protocols-overview",e],queryFn:()=>Oe(V(e))})}function X(e){return{queryKey:["protocols-pairs",e],queryFn:()=>he((s,r)=>Fe({...V(e),page:s,per_page:r}).then(n=>n.pairs),1,100)}}function Ee(e,t){return T({...X(e),enabled:t})}function Me(){const{data:e}=Qe({chain:"ethereum"}),t=k(()=>{var o;return(((o=e.value)==null?void 0:o.protocols)??[]).map(l=>l.name)}),s=k(()=>{var o;return(((o=e.value)==null?void 0:o.count)??0)>0}),r=k(()=>t.value.map(o=>({...X({chain:"ethereum",protocol_name:o}),enabled:s}))),n=be({queries:r,combine:o=>({data:o.map(l=>l.data).filter(l=>l!==void 0).flat(),pending:o.some(l=>l.isPending)})});return{data:k(()=>n.value.data),pending:k(()=>n.value.pending)}}export{Ee as a,Qe as b,Me as u};
