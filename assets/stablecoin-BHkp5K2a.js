import{a as o,f as y,j as m,t as v}from"./timestamp-DOR7_23P.js";import{c as i,i as f}from"./index-BbdM5O_n.js";const u=e=>"https://prices.curve.finance";class h extends Error{constructor(t,a){super(a),this.status=t}}async function c(e,t,a){const s=await fetch(e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t),signal:a});if(!s.ok)throw new h(s.status,`Fetch error ${s.status} for URL: ${e}`);return await s.json()}const _=/[+-]\d{2}:?\d{2}$/;function l(e){if(typeof e=="number")return new Date(e*1e3);const t=Number(e);if(!Number.isNaN(t))return new Date(t*1e3);const s=e.endsWith("Z")||_.test(e)?e:`${e}Z`;return new Date(s)}const $=24*60*60;function p({end:e,start:t,daysRange:a=10}={}){return e??(e=Math.floor(Date.now()/1e3)),t??(t=e-a*$),{end:e,start:t}}const b=e=>({name:e.name,address:e.address,numCoins:e.n_coins,tvlUsd:e.tvl_usd,tradingVolume24h:e.trading_volume_24h,tradingFee24h:e.trading_fee_24h,liquidityVolume24h:e.liquidity_volume_24h,liquidityFee24h:e.liquidity_fee_24h,coins:e.coins?.map(t=>({poolIndex:t.pool_index,symbol:t.symbol,address:t.address}))??[],baseDailyApr:e.base_daily_apr,baseWeeklyApr:e.base_weekly_apr,virtualPrice:e.virtual_price,poolMethods:e.pool_methods?.map(t=>t)??[]}),g=e=>({timestamp:l(e.timestamp),volume:e.volume,fees:e.fees}),D=e=>({timestamp:l(e.timestamp),tvlUSD:e.tvl_usd??0,balances:[...e.balances],tokenPrices:[...e.token_prices]});async function q(e,t,a){const s=u(),n=await c(`${s}/v1/pools/${e}/${t}`);return b(n)}async function w(e,t,a){const s=u(),{start:n,end:r}=p({daysRange:90});return(await c(`${s}/v1/volume/usd/${e}/${t}?interval=day&start=${n}&end=${r}`)).data.map(g)}async function T(e,t,a){const s=u(),{start:n,end:r}=p({daysRange:90});return(await c(`${s}/v1/snapshots/${e}/${t}/tvl?interval=day&start=${n}&end=${r}`)).data.map(D)}function K(){return o({queryKey:["reusd-price-history"],queryFn:async()=>{const{start:e,end:t}=m({daysRange:90}),a=`https://prices.curve.finance/v1/usd_price/ethereum/${f}/history?interval=day&start=${e}&end=${t}`;return(await y(a)).data.map(n=>({price:n.price,timestamp:v(n.timestamp)}))},initialData:[],initialDataUpdatedAt:0})}function P(e,t){return o({queryKey:["curve-pool",t],queryFn:async({queryKey:[,a]})=>q(e.value,a),enabled:i(()=>!!e.value)})}function R(e,t){return o({queryKey:["curve-pool-volume",t],queryFn:async({queryKey:[,a]})=>w(e.value,a),enabled:i(()=>!!e.value&&!!t.value),initialData:[],initialDataUpdatedAt:0})}function U(e,t){return o({queryKey:["curve-pool-tvl",t],queryFn:async({queryKey:[,a]})=>T(e.value,a),enabled:i(()=>!!e.value&&!!t.value),initialData:[],initialDataUpdatedAt:0})}export{R as a,U as b,P as c,K as u};
