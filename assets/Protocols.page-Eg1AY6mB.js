import{a as G,_ as H}from"./TabItem.vue_vue_type_script_setup_true_lang-6Qd4Idn7.js";import{_ as q}from"./DashboardHeader-CN43-LqW.js";import{_ as K}from"./KPI-uoTtNFz4.js";import{_ as V}from"./AsyncValue-Sj7pBrIC.js";import{b as j,c as M,a as J}from"./protocols-Booka_0q.js";import{d as T,u as Q,a as X,c as y,w as Y,b as f,o as p,e as u,f as _,g as a,h as t,_ as A,aD as Z,ar as ee,l as $,t as te,aE as oe,m as L,k as D,j as F,aF as ae,aG as ne,aA as se,av as re,aH as le,aI as k,an as B}from"./index-BYo41Xup.js";import{u as ie,_ as ce}from"./UseLegend-DtEHLPBI.js";import{u as ue,c as de,G as pe,r as me,a as _e,_ as ve}from"./UseLightweightChart-CFtEm1oP.js";import{_ as ge}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-CKpR4_i0.js";import{r as N,u as R}from"./timestamp-DbzQYZiw.js";import{_ as he}from"./Table-DT-aBDRh.js";import{_ as fe}from"./TokenIcon-aVlIfgro.js";import{u as be,_ as ye}from"./UsePagination-3nFYvzXg.js";import{p as S}from"./util-CVNQ9WdU.js";import{T as we,u as Ce}from"./UseTabNavigation-BRcpNIV7.js";import{u as Pe}from"./UseSort-D4hxLGlr.js";import"./Tooltip-DWyUKFfl.js";import"./Pagination-vgbH7lYO.js";import"./index-DI346r_k.js";const Te={style:{display:"flex"}},$e={ref:"chartRef",class:"chart"},xe=T({__name:"ChartTvl",props:{tvl:{}},setup(d){const l=Q(),{items:v,toggles:s,disabled:w}=ie(()=>[{id:"underlying",label:"Underlying",color:l.value.colorsArray[0],togglable:!0},{id:"debt",label:"Debt",color:l.value.colorsArray[1],togglable:!0}]),c=X("card"),{chart:m,series:i}=ue({createChartOptions:_e(),series:[de({name:"underlying",color:y(()=>l.value.colors.blue),formatter:e=>`$${N(e,1,"dollar")}${R(e)}`}),{type:pe,name:"debt",options:y(()=>({priceFormat:{type:"custom",formatter:e=>`$${N(e,1,"dollar")}${R(e)}`},lineWidth:2,lineType:me.WithSteps,color:l.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});Y(r);function r(){!m.value||!i.underlying||!i.debt||(i.underlying.setData(d.tvl.map(e=>({time:e.timestamp.getUTCTimestamp(),value:e.underlying})).uniqWith((e,n)=>e.time===n.time).orderBy(e=>e.time,"asc")),i.debt.setData(d.tvl.map(e=>({time:e.timestamp.getUTCTimestamp(),value:e.debt})).uniqWith((e,n)=>e.time===n.time).orderBy(e=>e.time,"asc")),i.underlying.applyOptions({visible:s.underlying.value}),i.debt.applyOptions({visible:s.debt.value}),m.value.timeScale().fitContent())}return(e,n)=>{const g=ge,C=ve,o=ce,h=A;return p(),f(h,{ref_key:"card",ref:c,title:"TVL"},{actions:u(()=>[_("div",Te,[a(g,{filename:"tvl",series:t(i)},null,8,["series"]),a(C,{chart:t(m),target:t(c)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[a(o,{items:t(v),disabled:t(w),onToggle:n[0]||(n[0]=P=>t(s)[P].value=!t(s)[P].value)},null,8,["items","disabled"])]),default:u(()=>[_("div",$e,null,512)]),_:1},512)}}}),Le=T({__name:"IconExpander",props:{expanded:{type:Boolean,default:!1}},setup(d){return(l,v)=>{const s=Z;return p(),f(s,{class:ee(["expander",{expanded:l.expanded}])},null,8,["class"])}}}),ke=$(Le,[["__scopeId","data-v-7caf48cb"]]),Be={class:"token"},Ne={class:"end",style:{display:"flex",gap:"1ch"}},Re={class:"end"},Se={class:"end"},Ie={class:"end"},I=20,Ue=T({__name:"TablePairs",props:{protocolName:{}},setup(d){const{isFetching:l,data:v}=j(te(()=>({chain:"ethereum",protocol_name:d.protocolName||""})),y(()=>!!d.protocolName)),s=y(()=>{var o;return(o=v.value)==null?void 0:o.filter(h=>h.borrowLimit>0)}),w=["","",{id:"name",label:"Name",sort:!0},{id:"tvl",label:"TVL",sort:!0,align:"end"},{id:"rewardRate",label:"Reward Rate",sort:!0,align:"end"},{id:"borrowRate",label:"Borrow Rate",sort:!0,align:"end"},{id:"util",label:"Util",sort:!0,align:"end"}],{sorting:c,onSort:m}=Pe("tvl"),i=y(()=>(s.value??[]).orderBy(o=>{switch(c.value.column){case"name":return S(o.name);case"tvl":return o.totalUnderlying;case"rewardRate":return o.aprBase+o.rewards.reduce((h,P)=>h+P.apr,0);case"borrowRate":return o.aprBorrowCost;case"util":return o.utilizationRate}},c.value.order)),{page:r,rowsPage:e,onPage:n}=be(i,I),g=oe(),C=async o=>{var h;await g.push({name:"pair",params:{protocolName:(h=d.protocolName)==null?void 0:h.toLocaleLowerCase(),pairId:o.pairId.toString()}})};return(o,h)=>{const P=ye,z=ke,E=fe,x=V,W=he,O=A;return p(),f(O,{title:"Pairs",loading:t(l)},{actions:u(()=>[a(P,{"items-count":t(i).length,"items-per-page":I,page:t(r),onPage:t(n)},null,8,["items-count","page","onPage"])]),default:u(()=>[a(W,{class:"pairs-table",rows:t(e),columns:w,sorting:t(c),onSortColumn:t(m),onSelect:C},{row:u(({item:b})=>[a(z),_("div",Be,[(p(),f(E,{key:b.tokenPairCollateral.symbol,chain:"ethereum",address:b.tokenPairCollateral.address},null,8,["address"]))]),_("div",null,L(t(S)(b.name)),1),_("div",Ne,[a(x,{"show-zero":"",type:"dollar",value:b.totalUnderlying,precision:2,"show-symbol":!1},null,8,["value"]),D(" "+L(b.tokenPairUnderyling.symbol),1)]),_("div",Re,[a(we,{pair:b},null,8,["pair"])]),_("div",Se,[a(x,{"show-zero":"",type:"percentage",value:b.aprBorrowCost,precision:2},null,8,["value"])]),_("div",Ie,[a(x,{"show-zero":"",type:"percentage",value:b.utilizationRate,precision:2},null,8,["value"])])]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),Ve=$(Ue,[["__scopeId","data-v-d3859ba6"]]),Ae={class:"dashboard-grid root"},De={class:"kpis"},Fe={class:"dashboard-grid charts"},ze=T({__name:"Protocol",props:{protocol:{}},setup(d){const{isFetching:l,data:v}=M({chain:"ethereum"}),s=y(()=>{var r;return(((r=v.value)==null?void 0:r.protocols)??[]).find(e=>e.name.toLocaleLowerCase()===d.protocol)}),{isFetching:w,data:c}=J({chain:"ethereum"}),m=y(()=>{var r;return(((r=c.value)==null?void 0:r.snapshots)??[]).filter(e=>e.name.toLocaleLowerCase()===d.protocol).groupBy(e=>e.timestamp.getTime()).entries()}),i=y(()=>m.value.flatMap(([,r])=>({timestamp:r[0].timestamp,underlying:r.reduce((e,n)=>e+n.totalUnderlying,0),debt:r.reduce((e,n)=>e+n.totalDebt,0)})));return(r,e)=>{var C;const n=V,g=K;return p(),F("div",Ae,[_("div",De,[a(g,{label:"Pairs","has-value":!t(l)},{default:u(()=>{var o;return[a(n,{value:(o=t(s))==null?void 0:o.pairsCount,precision:0},null,8,["value"])]}),_:1},8,["has-value"]),a(g,{label:"Total collateral","has-value":!t(l)},{default:u(()=>{var o;return[a(n,{type:"dollar",value:(o=t(s))!=null&&o.totalUnderlying?t(s).totalUnderlying:void 0,precision:2},null,8,["value"])]}),_:1},8,["has-value"]),a(g,{label:"Total debt","has-value":!t(l)},{default:u(()=>{var o;return[a(n,{value:(o=t(s))==null?void 0:o.totalDebt,precision:0},null,8,["value"]),e[0]||(e[0]=D(" reUSD "))]}),_:1,__:[0]},8,["has-value"])]),a(Ve,{"protocol-name":(C=t(s))==null?void 0:C.name},null,8,["protocol-name"]),_("div",Fe,[a(xe,{style:{"grid-area":"chart-tvl"},tvl:t(i),loading:t(w)},null,8,["tvl","loading"])])])}}}),U=$(ze,[["__scopeId","data-v-c77b921b"]]),Ee={key:1,class:"dashboard"},We=T({__name:"Protocols.page",setup(d){const{tabActive:l,tabActiveIndex:v}=Ce(["curvelend","fraxlend"],"protocols",void 0,{tabParamName:"protocolName"}),{crumbs:s}=ae(ne()),w=se();return re(()=>w.name,c=>{c!=="pair"&&(s.value=[{id:"protocols",label:"Protocols",pathName:"protocols"}])},{immediate:!0}),(c,m)=>{const i=le("router-view"),r=q,e=G,n=H;return c.$route.name==="pair"?(p(),f(i,{key:0})):(p(),F("div",Ee,[a(r,{style:{"grid-area":"header"},title:"Protocols",description:"Lending markets metrics for Curve Lend and Frax Lend protocols"}),a(n,{active:t(v),onTab:m[0]||(m[0]=g=>v.value=g.index)},{default:u(()=>[a(e,{header:"Curve Lend"},{default:u(()=>[(p(),f(k,null,[t(l)==="curvelend"?(p(),f(U,{key:0,protocol:"curvelend"})):B("",!0)],1024))]),_:1}),a(e,{header:"Frax Lend"},{default:u(()=>[(p(),f(k,null,[t(l)==="fraxlend"?(p(),f(U,{key:0,protocol:"fraxlend"})):B("",!0)],1024))]),_:1})]),_:1},8,["active"])]))}}}),lt=$(We,[["__scopeId","data-v-90d9b0e2"]]);export{lt as default};
