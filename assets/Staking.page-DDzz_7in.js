import{_ as he}from"./DashboardHeader-D9I1fKJE.js";import{t as P,b as Q,f as S,a as x,g as te,r as A,u as I}from"./Number-BHD65MO0.js";import{o as m,e as se,s as n,n as d,d as ve,a as w,p as O,t as K,f as $,j as fe,g as V,_ as j}from"./AsyncValue-DhIyIA2R.js";import{p as ae}from"./Pagination-vgbH7lYO.js";import{aI as ye,al as R,d as U,u as ne,a as oe,c as k,w as re,b as q,o as F,e as f,f as _,g as p,h as o,_ as D,l as B,t as W,av as E,m as C,an as N,as as be,au as ke,aq as we,ah as $e,j as Te}from"./index-B_NxFp7S.js";import{u as le,c as ie,a as ce,_ as ue,G as Pe,r as Ue}from"./UseLightweightChart-Bbfq5fOn.js";import{_ as pe}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-Sx3n9OCS.js";import{_ as Fe}from"./ChartApex-CDPFypb1.js";import{c as Ce}from"./ChartStylesApex-DVuQyR5G.js";import{u as Se,_ as xe}from"./UseLegend-CFXxz6re.js";import{_ as z}from"./Table-CJ5VQAMe.js";import{u as Ve,_ as de,a as Re}from"./UsePagination-S9IasDbG.js";import{u as me}from"./UseRelativeTime-DV61XGDw.js";const qe=m({event_type:ve(["stake","unstake"]),block_timestamp:d(),tx_hash:n(),block_number:d(),amount:n(),amount_usd:n(),account:se}).transform(e=>({eventType:e.event_type,blockTime:P(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,amount:parseFloat(e.amount),amountUsd:parseFloat(e.amount_usd),account:e.account})),De=m({events:w(qe),count:d(),page:d(),total_pages:d()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),He=m({account:se,amount:n(),amount_usd:n(),end_timestamp:d(),block_timestamp:d(),tx_hash:n()}).transform(e=>({account:e.account,amount:parseFloat(e.amount),amountUsd:parseFloat(e.amount_usd),end:P(e.end_timestamp),blockTime:P(e.block_timestamp),txHash:e.tx_hash})),Ae=m({entries:w(He)}).transform(e=>({entries:e.entries})),Ee=m({timestamp:d(),token_address:n(),token_symbol:n(),apr:n()}).transform(e=>({timestamp:P(e.timestamp),tokenAddress:e.token_address,tokenSymbol:e.token_symbol,apr:parseFloat(e.apr)})),Be=m({snapshots:w(Ee),count:d(),page:d(),total_pages:d()}).transform(e=>({snapshots:e.snapshots,count:e.count,page:e.page,totalPages:e.total_pages})),Le=m({timestamp:d(),tvl:n(),tvl_usd:n()}).transform(e=>({timestamp:P(e.timestamp),tvl:parseFloat(e.tvl),tvlUsd:parseFloat(e.tvl_usd)})),We=m({data:w(Le),count:d(),page:d(),total_pages:d()}).transform(e=>({data:e.data,count:e.count,page:e.page,totalPages:e.total_pages})),Ie=m({address:n(),label:n().nullable(),ens:n().nullable(),position_value:n(),position_value_usd:n()}).transform(e=>({address:e.address,label:e.label,ens:e.ens,positionValue:parseFloat(e.position_value),positionValueUsd:parseFloat(e.position_value_usd)})),Qe=m({total_tvl:n(),total_tvl_usd:n(),top_users_tvl:n(),top_users_tvl_usd:n(),others_tvl:n(),others_tvl_usd:n(),users:w(Ie)}).transform(e=>({totalTvl:parseFloat(e.total_tvl),totalTvlUsd:parseFloat(e.total_tvl_usd),topUsersTvl:parseFloat(e.top_users_tvl),topUsersTvlUsd:parseFloat(e.top_users_tvl_usd),othersTvl:parseFloat(e.others_tvl),othersTvlUsd:parseFloat(e.others_tvl_usd),users:e.users})),Oe=m({min_value_usd:n(),max_value_usd:n(),count:d()}).transform(e=>({minValueUsd:parseFloat(e.min_value_usd),maxValueUsd:parseFloat(e.max_value_usd),count:e.count})),Ke=m({bins:w(Oe),total_users:d()}).transform(e=>({bins:e.bins,totalUsers:e.total_users})),je=m({epoch:d(),timestamp:d(),weight:n(),relative_weight:n()}).transform(e=>({epoch:e.epoch,timestamp:P(e.timestamp),weight:parseFloat(e.weight),weightRelative:parseFloat(e.relative_weight)}));m({address:n(),weights:w(je)}).transform(e=>({adress:e.address,weights:e.weights}));const Ne=m({timestamp:d(),total_staked:n(),cooldown_amount:n(),cooldown_percentage:n(),regular_staked_amount:n(),regular_staked_percentage:n(),perma_staked_amount:n(),perma_staked_percentage:n(),cooldown_percentage_excluding_perma:n(),regular_staked_percentage_excluding_perma:n()}).transform(e=>({timestamp:P(e.timestamp),totalStaked:parseFloat(e.total_staked),cooldownAmount:parseFloat(e.cooldown_amount),cooldownPercentage:parseFloat(e.cooldown_percentage),regularStakedAmount:parseFloat(e.regular_staked_amount),regularStakedPercentage:parseFloat(e.regular_staked_percentage),permaStakedAmount:parseFloat(e.perma_staked_amount),permaStakedPercentage:parseFloat(e.perma_staked_percentage),cooldownPercentageExcludingPerma:parseFloat(e.cooldown_percentage_excluding_perma),regularStakedPercentageExcludingPerma:parseFloat(e.regular_staked_percentage_excluding_perma)}));m({data:w(Ne),count:d(),page:d(),total_pages:d()}).transform(e=>({data:e.data,count:e.count,page:e.page,totalPages:e.total_pages}));const ze=m({...$,...K,...O});async function Ge(e,t){const l=V(t),{chain:r,...s}=ze.parse(e),i=Q(s),a=await S(`${l}/v1/staking/${r}/events${i}`,void 0,t==null?void 0:t.signal);return De.parse(a)}const Me=m($);async function Je(e,t){const l=V(t),{chain:r}=Me.parse(e),s=await S(`${l}/v1/staking/${r}/cooldown_queue`,void 0,t==null?void 0:t.signal);return Ae.parse(s)}const Xe=m({...$,...K,...O});async function Ye(e,t){const l=V(t),{chain:r,...s}=Xe.parse(e),i=Q(s),a=await S(`${l}/v1/staking/${r}/apr_history${i}`,void 0,t==null?void 0:t.signal);return Be.parse(a)}const Ze=m({...$,...K,...O});async function et(e,t){const l=V(t),{chain:r,...s}=Ze.parse(e),i=Q(s),a=await S(`${l}/v1/staking/${r}/tvl_history${i}`,void 0,t==null?void 0:t.signal);return We.parse(a)}const tt=m($);async function st(e,t){const l=V(t),{chain:r}=tt.parse(e),s=await S(`${l}/v1/staking/${r}/top_users`,void 0,t==null?void 0:t.signal);return Qe.parse(s)}const at=m({...$,bin_count:d().int().positive().optional()});async function nt(e,t){const l=V(t),{chain:r,...s}=at.parse(e),i=Q(s),a=await S(`${l}/v1/staking/${r}/position_histogram${i}`,void 0,t==null?void 0:t.signal);return Ke.parse(a)}m({...$,...fe});m({...$,...K,...O});function ot(e){return x({queryKey:["staking-events",e],queryFn:()=>Ge(R(e)),placeholderData:ye})}function rt(e){return x({queryKey:["staking-cooldown-queue",e],queryFn:()=>Je(R(e))})}function lt(e){const{start:t,end:l}=te({daysRange:90});return x({queryKey:["staking-apr-history",e],queryFn:()=>ae((s,i)=>Ye({...R(e),page:s,per_page:i,start:t,end:l}).then(a=>a.snapshots),1,100)})}function it(e){const{start:t,end:l}=te({daysRange:90});return x({queryKey:["staking-tvl-history",e],queryFn:()=>ae((s,i)=>et({...R(e),page:s,per_page:i,start:t,end:l}).then(a=>a.data),1,100)})}function ct(e){return x({queryKey:["staking-top-users",e],queryFn:()=>st(R(e))})}function ut(e){return x({queryKey:["staking-position-hist",e],queryFn:()=>nt(R(e))})}const pt={style:{display:"flex"}},dt={ref:"chartRef",class:"chart"},mt=U({__name:"ChartApr",props:{apr:{}},setup(e){const t=ne(),l=oe("card"),{chart:r,series:s}=le({createChartOptions:ce(),series:ie({name:"apr",color:k(()=>t.value.colors.blue),formatter:a=>`${A(a,0,"percentage")}%`,minMove:.01})});re(i);function i(){if(!r.value||!s.apr)return;const a=e.apr.map(u=>({time:u.timestamp.getUTCTimestamp(),value:u.apr})).uniqWith((u,h)=>u.time===h.time).orderBy(u=>u.time,"asc");a.length>0&&s.apr.setData(a),r.value.timeScale().fitContent()}return(a,u)=>{const h=pe,g=ue,y=D;return F(),q(y,{ref_key:"card",ref:l,title:"APR"},{actions:f(()=>[_("div",pt,[p(h,{filename:"apr",series:o(s)},null,8,["series"]),p(g,{chart:o(r),target:o(l)},null,8,["chart","target"])])]),default:f(()=>[_("div",dt,null,512)]),_:1},512)}}}),_t=U({__name:"ChartPositions",props:{bins:{}},setup(e){const t=k(()=>Ce({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1}},xaxis:{categories:l.value,labels:{formatter:s=>s,rotate:-60},tickPlacement:"on"},yaxis:{labels:{formatter:s=>s}},plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:s=>{const i=s.series[0][s.dataPointIndex];return`<div><b>Range</b>: ${l.value[s.dataPointIndex]}</div><div><b>Users</b>: ${i}</div>`}}})),l=k(()=>e.bins.map(s=>{const i=s.minValueUsd?`${A(s.minValueUsd,0,"dollar")}${I(s.minValueUsd)}`:"0",a=s.maxValueUsd?`${A(s.maxValueUsd,0,"dollar")}${I(s.maxValueUsd)}`:"0";return`${i} - ${a}`})),r=k(()=>[{name:"Users",data:e.bins.map(s=>s.count)}]);return(s,i)=>{const a=Fe,u=D;return F(),q(u,{title:"User positions"},{default:f(()=>[p(a,{options:o(t),series:o(r)},null,8,["options","series"])]),_:1})}}}),gt=B(_t,[["__scopeId","data-v-791d1a3d"]]),ht={style:{display:"flex"}},vt={ref:"chartRef",class:"chart"},ft=U({__name:"ChartTvl",props:{tvl:{}},setup(e){const t=ne(),{items:l,toggles:r,disabled:s}=Se(()=>[{id:"rsup",label:"RSUP",color:t.value.colorsArray[0],togglable:!0},{id:"dollars",label:"Dollars",color:t.value.colorsArray[1],togglable:!0}]),i=oe("card"),{chart:a,series:u}=le({createChartOptions:ce(),series:[ie({name:"rsup",color:k(()=>t.value.colors.blue),formatter:g=>`${A(g,1,"dollar")}${I(g)}`}),{type:Pe,name:"dollars",options:k(()=>({priceFormat:{type:"custom",formatter:g=>`$${A(g,1,"dollar")}${I(g)}`},lineWidth:2,lineType:Ue.WithSteps,color:t.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});re(h);function h(){if(!a.value||!u.rsup||!u.dollars)return;const g=e.tvl.map(c=>({time:c.timestamp.getUTCTimestamp(),value:c.tvl})).uniqWith((c,b)=>c.time===b.time).orderBy(c=>c.time,"asc"),y=e.tvl.map(c=>({time:c.timestamp.getUTCTimestamp(),value:c.tvlUsd})).uniqWith((c,b)=>c.time===b.time).orderBy(c=>c.time,"asc");u.rsup.setData(g),u.dollars.setData(y),u.rsup.applyOptions({visible:r.rsup.value}),u.dollars.applyOptions({visible:r.dollars.value}),a.value.timeScale().fitContent()}return(g,y)=>{const c=pe,b=ue,H=xe,v=D;return F(),q(v,{ref_key:"card",ref:i,title:"TVL"},{actions:f(()=>[_("div",ht,[p(c,{filename:"tvl",series:o(u)},null,8,["series"]),p(b,{chart:o(a),target:o(i)},null,8,["chart","target"])])]),"actions-secondary":f(()=>[p(H,{items:o(l),disabled:o(s),onToggle:y[0]||(y[0]=L=>o(r)[L].value=!o(r)[L].value)},null,8,["items","disabled"])]),default:f(()=>[_("div",vt,null,512)]),_:1},512)}}}),yt=["href"],bt={class:"end"},kt={class:"end"},wt={class:"end"},$t=["href"],ee=10,Tt=U({__name:"TableCooldowns",props:{cooldowns:{}},setup(e){const{page:t,rowsPage:l,onPage:r}=Ve(W(()=>e.cooldowns),ee),{relativeTime:s}=me();return(i,a)=>{const u=de,h=j,g=z,y=D;return F(),q(y,{title:"Cooldown Queue"},{actions:f(()=>[p(u,{"items-count":i.cooldowns.length,"items-per-page":ee,page:o(t),onPage:o(r)},null,8,["items-count","page","onPage"])]),default:f(()=>[p(g,{rows:o(l),columns:["User",{label:"RSUP",align:"end"},{label:"Dollars",align:"end"},{label:"Time",align:"end"}]},{row:f(({item:c})=>[_("div",null,[_("a",{target:"_blank",href:`https://etherscan.io/address/${c.account.address}`,onClick:a[0]||(a[0]=E(()=>{},["stop"]))},C(c.account.ens||("addressShort"in i?i.addressShort:o(N))(c.account.address)),9,yt)]),_("div",bt,[p(h,{type:"dollar",value:c.amount,precision:2,"show-symbol":!1},null,8,["value"])]),_("div",kt,[p(h,{type:"dollar",value:c.amountUsd,precision:2},null,8,["value"])]),_("div",wt,[_("a",{target:"_blank",href:`https://etherscan.io/tx/${c.txHash}`,onClick:a[1]||(a[1]=E(()=>{},["stop"]))},C(o(s)(c.end.getUTCTimestamp())),9,$t)])]),_:1},8,["rows"])]),_:1})}}}),Pt=B(Tt,[["__scopeId","data-v-6228b228"]]),Ut=["href"],Ft={class:"end"},Ct={class:"end"},St={class:"end"},xt=["href"],Vt=U({__name:"TableEvents",props:{events:{},count:{}},emits:["page"],setup(e,{emit:t}){const l=t,{page:r,onPage:s}=Re(),i=be(r,200);ke(i,h=>{l("page",h)});const{relativeTime:a}=me(),u=h=>{switch(h.eventType){case"stake":return"Stake";case"unstake":return"Unstake"}};return(h,g)=>{const y=de,c=j,b=z,H=D;return F(),q(H,{title:"Events"},{actions:f(()=>[p(y,{"items-count":h.count,"items-per-page":10,page:o(r),onPage:o(s)},null,8,["items-count","page","onPage"])]),default:f(()=>[p(b,{rows:h.events,columns:["Type","Owner",{label:"RSUP",align:"end"},{label:"Dollars",align:"end"},{label:"Time",align:"end"}]},{row:f(({item:v})=>[_("div",{class:we({green:v.eventType==="stake",red:v.eventType==="unstake"})},C(u(v)),3),_("div",null,[_("a",{target:"_blank",href:`https://etherscan.io/address/${v.account.address}`,onClick:g[0]||(g[0]=E(()=>{},["stop"]))},C(v.account.ens||("addressShort"in h?h.addressShort:o(N))(v.account.address)),9,Ut)]),_("div",Ft,[p(c,{type:"dollar",value:v.amount,precision:2,"show-symbol":!1},null,8,["value"])]),_("div",Ct,[p(c,{type:"dollar",value:v.amountUsd,precision:2},null,8,["value"])]),_("div",St,[_("a",{target:"_blank",href:`https://etherscan.io/tx/${v.txHash}`,onClick:g[1]||(g[1]=E(()=>{},["stop"]))},C(o(a)(v.blockTime.getUTCTimestamp())),9,xt)])]),_:1},8,["rows"])]),_:1})}}}),Rt=B(Vt,[["__scopeId","data-v-a959b9d4"]]),qt=["href"],Dt={class:"end"},Ht={class:"end"},At=U({__name:"TableTopUsers",props:{topUsers:{}},setup(e){return(t,l)=>{const r=j,s=z,i=D;return F(),q(i,{title:"Top Users"},{default:f(()=>[p(s,{rows:t.topUsers,columns:["Address",{label:"RSUP",align:"end"},{label:"Dollars",align:"end"}]},{row:f(({item:a})=>[_("div",null,[_("a",{target:"_blank",href:`https://etherscan.io/address/${a.address}`,onClick:l[0]||(l[0]=E(()=>{},["stop"]))},C(a.ens||("addressShort"in t?t.addressShort:o(N))(a.address)),9,qt)]),_("div",Dt,[p(r,{type:"dollar",value:a.positionValue,precision:2,"show-symbol":!1},null,8,["value"])]),_("div",Ht,[p(r,{type:"dollar",value:a.positionValueUsd,precision:2},null,8,["value"])])]),_:1},8,["rows"])]),_:1})}}}),Et=B(At,[["__scopeId","data-v-d5d8af2d"]]),Bt={class:"dashboard"},Lt=U({__name:"Staking.page",setup(e){const{isFetching:t,data:l}=lt({chain:"ethereum"}),r=k(()=>(l.value??[]).map(T=>({timestamp:T.timestamp,apr:T.apr}))),{isFetching:s,data:i}=it({chain:"ethereum"}),a=k(()=>(i.value??[]).map(T=>({timestamp:T.timestamp,tvl:T.tvl,tvlUsd:T.tvlUsd}))),u=$e(1),{isFetching:h,data:g}=ot(k(()=>({chain:"ethereum",page:u.value,per_page:10}))),{isFetching:y,data:c}=ct(W(()=>({chain:"ethereum"}))),{isFetching:b,data:H}=rt(W(()=>({chain:"ethereum"}))),{isFetching:v,data:L}=ut(W(()=>({chain:"ethereum"})));return(T,G)=>{var M,J,X,Y,Z;const _e=he;return F(),Te("div",Bt,[p(_e,{style:{"grid-area":"header"},title:"Staking",description:"User governance staking metrics (RSUP)"}),p(mt,{style:{"grid-area":"apr"},apr:o(r),loading:o(t)},null,8,["apr","loading"]),p(ft,{style:{"grid-area":"tvl"},tvl:o(a),loading:o(s)},null,8,["tvl","loading"]),p(Rt,{style:{"grid-area":"events"},events:((M=o(g))==null?void 0:M.events)??[],count:((J=o(g))==null?void 0:J.count)??0,loading:o(h),onPage:G[0]||(G[0]=ge=>u.value=ge)},null,8,["events","count","loading"]),p(Et,{style:{"grid-area":"top-users"},"top-users":((X=o(c))==null?void 0:X.users)??[],loading:o(y)},null,8,["top-users","loading"]),p(Pt,{style:{"grid-area":"cooldowns"},cooldowns:((Y=o(H))==null?void 0:Y.entries)??[],loading:o(b)},null,8,["cooldowns","loading"]),p(gt,{style:{"grid-area":"positions"},bins:((Z=o(L))==null?void 0:Z.bins)??[],loading:o(v)},null,8,["bins","loading"])])}}}),Zt=B(Lt,[["__scopeId","data-v-247d8a25"]]);export{Zt as default};
