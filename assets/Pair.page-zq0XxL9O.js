import{a as he,_ as fe}from"./TabItem.vue_vue_type_script_setup_true_lang-CitRpzKi.js";import{am as S,aJ as Z,d as C,at as ee,av as z,b as h,o as m,_ as I,e as g,an as q,f as b,m as w,j as P,g as d,k as L,aw as E,h as l,l as D,ai as te,c as $,t as O,ao as Y,u as ce,a as ue,w as pe,n as ye,aF as $e,aG as Ce,ay as De,aI as H}from"./index-DwSotjAb.js";import{b as we}from"./protocols-BopcUmaZ.js";import{p as ke}from"./util-CVNQ9WdU.js";import{_ as Re,o as y,s as p,b as A,n as v,t as W,k as X,p as j,d as G,h as U,g as B,i as J,f as x,a as N,j as Pe,r as k,u as R}from"./timestamp-BYVxXSJt.js";import{p as Fe}from"./Pagination-vgbH7lYO.js";import{_ as ae}from"./NoData-CKRMLntH.js";import{_ as se}from"./Table-DsnJIl-C.js";import{_ as V}from"./AsyncValue-Dbxinhn4.js";import{a as oe,_ as re}from"./UsePagination-CuCgqoAz.js";import{u as ne}from"./UseRelativeTime-CwSOiZDW.js";import{_ as le}from"./ChartApex-BJN0Sfxc.js";import{c as ie}from"./ChartStylesApex-BkAOWzzc.js";import{_ as Q}from"./KPI-BbDo3yd5.js";import{_ as qe}from"./ChartBalances-CT7zD_fR.js";import{u as me,c as _e,a as be,_ as ge,D as Te}from"./UseLightweightChart-fT5MLJif.js";import{_ as ve}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-DBJxZk61.js";import{T as Le,u as Ie}from"./UseTabNavigation-BiWtD0MZ.js";import{a as de}from"./index-Bkhjjd7F.js";import"./Tooltip-dGeKlIzS.js";const Se=Re(["borrow","add_collateral","remove_collateral","repay","redeem","liquidate","leveraged_position","repay_with_collateral"]),Ae=y({token_address:p(),token_symbol:p(),apr:p()}).transform(e=>({tokenAddress:e.token_address,tokenSymbol:e.token_symbol,apr:parseFloat(e.apr)})),Ue=y({date_timestamp:v(),total_collateral:p(),total_underlying:p(),exchange_rate:p(),total_debt:p(),active_positions_count:v(),borrow_limit:p(),utilization_rate:p(),interest_rate:p(),claimable_fees:p(),claimable_other_fees:p(),borrow_cost_apr:p(),base_apr:p(),rewards:A(Ae)}).transform(e=>({time:W(e.date_timestamp),totalCollateral:parseFloat(e.total_collateral),totalUnderlying:parseFloat(e.total_underlying),exchangeRate:parseFloat(e.exchange_rate),totalDebt:parseFloat(e.total_debt),activePositionsCount:e.active_positions_count,borrowLimit:parseFloat(e.borrow_limit),utilizationRate:parseFloat(e.utilization_rate),interestRate:parseFloat(e.interest_rate),claimableFees:parseFloat(e.claimable_fees),claimableOtherFees:parseFloat(e.claimable_other_fees),aprBorrowCost:parseFloat(e.borrow_cost_apr),aprBase:parseFloat(e.base_apr),rewards:e.rewards})),Be=y({snapshots:A(Ue),count:v(),page:v(),total_pages:v()}).transform(e=>({snapshots:e.snapshots,count:e.count,page:e.page,totalPages:e.total_pages})),xe=y({event_type:Se,block_timestamp:v(),tx_hash:p(),block_number:v(),collateral_change:p(),debt_change:p()}).transform(e=>({eventType:e.event_type,blockTime:W(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,collateralChange:parseFloat(e.collateral_change),debtChange:parseFloat(e.debt_change)})),Ne=y({events:A(xe),count:v(),page:v(),total_pages:v()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),Ke=y({block_timestamp:v(),tx_hash:p(),block_number:v(),caller:X,amount:p(),collateral_freed:p(),protocol_fee:p(),debt_reduction:p()}).transform(e=>({blockTime:W(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,caller:e.caller,amount:parseFloat(e.amount),collateralFreed:parseFloat(e.collateral_freed),protocolFee:parseFloat(e.protocol_fee),debtReduction:parseFloat(e.debt_reduction)})),Me=y({events:A(Ke),count:v(),page:v(),total_pages:v()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),Ve=y({block_timestamp:v(),tx_hash:p(),block_number:v(),borrower:X,liquidator:X,collateral_for_liquidator:p(),shares_liquidated:p(),amount_liquidator_to_repay:p()}).transform(e=>({blockTime:W(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,borrower:e.borrower,liquidator:e.liquidator,collateralForLiquidator:parseFloat(e.collateral_for_liquidator),sharesLiquidated:parseFloat(e.shares_liquidated),amountLiquidatorToRepay:parseFloat(e.amount_liquidator_to_repay)})),Ee=y({events:A(Ve),count:v(),page:v(),total_pages:v()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),He=y({...U,...G,...j});async function Oe(e,a){const i=B(a),{pair_id:n,...t}=He.parse(e),s=J(t),o=await x(`${i}/v1/pairs/${n}/snapshots${s}`,void 0,a==null?void 0:a.signal);return Be.parse(o)}const ze=y({...U,...G,...j});async function We(e,a){const i=B(a),{pair_id:n,...t}=ze.parse(e),s=J(t),o=await x(`${i}/v1/pairs/${n}/collateral_events${s}`,void 0,a==null?void 0:a.signal);return Ne.parse(o)}const je=y({...U,...G,...j});async function Ge(e,a){const i=B(a),{pair_id:n,...t}=je.parse(e),s=J(t),o=await x(`${i}/v1/pairs/${n}/redemptions${s}`,void 0,a==null?void 0:a.signal);return Me.parse(o)}const Je=y({...U,...G,...j});async function Qe(e,a){const i=B(a),{pair_id:n,...t}=Je.parse(e),s=J(t),o=await x(`${i}/v1/pairs/${n}/liquidations${s}`,void 0,a==null?void 0:a.signal);return Ee.parse(o)}function Ye(e){const{start:a,end:i}=Pe({daysRange:90});return N({queryKey:["pairs-snapshots",e],queryFn:()=>Fe((t,s)=>Oe({...S(e),page:t,per_page:s,start:a,end:i}).then(o=>o.snapshots),1,100)})}function Xe(e){return N({queryKey:["pairs-collateral-events",e],queryFn:()=>We(S(e)),placeholderData:Z})}function Ze(e){return N({queryKey:["pairs-redemptions",e],queryFn:()=>Ge(S(e)),placeholderData:Z})}function et(e){return N({queryKey:["pairs-liquidations",e],queryFn:()=>Qe(S(e)),placeholderData:Z})}const tt={class:"end"},at={key:0,style:{display:"flex",gap:"1ch"}},st={class:"end"},ot={key:0,style:{display:"flex",gap:"1ch"}},rt={class:"end"},nt=["href"],lt=C({__name:"TableCollateralEvents",props:{events:{},count:{},pair:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:a}){const i=a,{page:n,onPage:t}=oe(),s=ee(n,200);z(s,u=>{i("page",u)});const{relativeTime:o}=ne(),r=u=>{switch(u.eventType){case"add_collateral":return"Add collateral";case"borrow":return"Borrow";case"remove_collateral":return"Remove collateral";case"repay":return"Repay";case"redeem":return"Redeem";case"liquidate":return"Liquidate";case"leveraged_position":return"Lev. position";case"repay_with_collateral":return"Repay with col"}};return(u,c)=>{const _=re,T=V,F=se,K=ae,f=I;return m(),h(f,{title:"Events"},{actions:g(()=>[d(_,{"items-count":u.count,"items-per-page":10,page:l(n),onPage:l(t)},null,8,["items-count","page","onPage"])]),default:g(()=>[e.events.length>0?(m(),h(F,{key:0,rows:e.events,columns:["Type",{label:"Δ Debt",align:"end"},{label:"Δ Collateral",align:"end"},{label:"Time",align:"end"}]},{row:g(({item:M})=>[b("div",null,w(r(M)),1),b("div",tt,[M.debtChange!==0?(m(),P("div",at,[d(T,{type:"dollar",value:M.debtChange/10**18,precision:2,"show-symbol":!1},null,8,["value"]),L(" "+w(u.pair.tokenDebt.symbol),1)])):q("",!0)]),b("div",st,[M.collateralChange!==0?(m(),P("div",ot,[d(T,{type:"dollar",value:M.collateralChange/10**18,precision:2,"show-symbol":!1},null,8,["value"]),L(" "+w(u.pair.tokenCollateral.symbol),1)])):q("",!0)]),b("div",rt,[b("a",{target:"_blank",href:`https://etherscan.io/tx/${M.txHash}`,onClick:c[0]||(c[0]=E(()=>{},["stop"]))},w(l(o)(M.blockTime.getUTCTimestamp())),9,nt)])]),_:1},8,["rows"])):u.loading?q("",!0):(m(),h(K,{key:1,message:"There are no events"}))]),_:1})}}}),it=D(lt,[["__scopeId","data-v-f018f232"]]),dt={class:"dashboard-grid"},ct=C({__name:"Collateral",props:{pair:{}},setup(e){const a=te(1),{isFetching:i,data:n}=Xe($(()=>({pair_id:e.pair.pairId,page:a.value,per_page:15})));return(t,s)=>{var o,r;return m(),P("div",dt,[d(it,{events:((o=l(n))==null?void 0:o.events)??[],count:((r=l(n))==null?void 0:r.count)??0,loading:l(i),pair:t.pair,onPage:s[0]||(s[0]=u=>a.value=u)},null,8,["events","count","loading","pair"])])}}}),ut=D(ct,[["__scopeId","data-v-ff086716"]]),pt=y({range_label:p(),user_count:v(),total_debt:p()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),mt=y({bins:A(pt),total_users:v(),total_debt:p(),min_ratio:p(),max_ratio:p(),median_ratio:p()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),minRatio:parseFloat(e.min_ratio),maxRatio:parseFloat(e.max_ratio),medianRatio:parseFloat(e.median_ratio)})),_t=y({range_label:p(),user_count:v(),total_debt:p()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),bt=y({bins:A(_t),total_users:v(),total_debt:p(),min_debt:p(),max_debt:p(),median_debt:p()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),minDebt:parseFloat(e.min_debt),maxDebt:parseFloat(e.max_debt),medianDebt:parseFloat(e.median_debt)})),gt=y({leveraged_users_count:v(),non_leveraged_users_count:v(),leveraged_debt:p(),non_leveraged_debt:p(),total_users:v(),total_debt:p(),leveraged_users_percentage:p(),leveraged_debt_percentage:p()}).transform(e=>({leveragedUsersCount:e.leveraged_users_count,nonLeveragedUsersCount:e.non_leveraged_users_count,leveragedDebt:parseFloat(e.leveraged_debt),nonLeveragedDebt:parseFloat(e.non_leveraged_debt),totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),leveragedUsersPercentage:parseFloat(e.leveraged_users_percentage),leveragedDebtPercentage:parseFloat(e.leveraged_debt_percentage)})),vt=y({stats:gt}).transform(e=>({stats:e.stats})),ht=y({range_label:p(),user_count:v(),total_debt:p()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),ft=y({bins:A(ht),total_users:v(),total_debt:p()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt)})),yt=y(U);async function $t(e,a){const i=B(a),{pair_id:n}=yt.parse(e),t=await x(`${i}/v1/health/${n}/leverage_stats`,void 0,a==null?void 0:a.signal);return vt.parse(t)}const Ct=y(U);async function Dt(e,a){const i=B(a),{pair_id:n}=Ct.parse(e),t=await x(`${i}/v1/health/${n}/leverage_distribution`,void 0,a==null?void 0:a.signal);return ft.parse(t)}const wt=y(U);async function kt(e,a){const i=B(a),{pair_id:n}=wt.parse(e),t=await x(`${i}/v1/health/${n}/debt_distribution`,void 0,a==null?void 0:a.signal);return bt.parse(t)}const Rt=y(U);async function Pt(e,a){const i=B(a),{pair_id:n}=Rt.parse(e),t=await x(`${i}/v1/health/${n}/collateral_ratio_distribution`,void 0,a==null?void 0:a.signal);return mt.parse(t)}function Ft(e){return N({queryKey:["health-leverage-stats",e],queryFn:()=>$t(S(e))})}function qt(e){return N({queryKey:["health-leverage-distribution",e],queryFn:()=>Dt(S(e))})}function Tt(e){return N({queryKey:["health-debt-distribution",e],queryFn:()=>kt(S(e))})}function Lt(e){return N({queryKey:["health-collateral-ratio-distribution",e],queryFn:()=>Pt(S(e))})}const It=C({__name:"ChartCollateralRatioDistribution",props:{data:{}},setup(e){const a=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1},stacked:!1},xaxis:{categories:i.value,labels:{formatter:t=>t,rotate:-30,offsetY:10,rotateAlways:!0},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${k(t,0,"dollar")}${R(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const s=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${i.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${s}</div>
                <div><b>Debt:</b></div><div>$${k(o,2,"dollar")}${R(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${k(o/s,2,"dollar")}${R(o/s)}</div>
                </div>`}},legend:{show:!0}})),i=$(()=>{var t;return(((t=e.data)==null?void 0:t.bins)??[]).map(s=>{const[o,r]=s.rangeLabel.split(" - ").map(parseFloat),u=`${Math.round(o*100)}%`,c=`${Math.round(r*100)}%`;return`${u} - ${c}`})}),n=$(()=>{var t,s;return[{name:"Users",type:"column",data:(((t=e.data)==null?void 0:t.bins)??[]).map(o=>o.userCount)},{name:"Debt",type:"line",data:(((s=e.data)==null?void 0:s.bins)??[]).map(o=>o.totalDebt)}]});return(t,s)=>{const o=le,r=I;return m(),h(r,null,{default:g(()=>[d(o,{options:l(a),series:l(n)},null,8,["options","series"])]),_:1})}}}),St=D(It,[["__scopeId","data-v-022e67af"]]),At=C({__name:"ChartDebtDistribution",props:{data:{}},setup(e){const a=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1},stacked:!1},xaxis:{categories:i.value,labels:{formatter:t=>t,rotate:-30,offsetY:10,rotateAlways:!0},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${k(t,0,"dollar")}${R(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const s=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${i.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${s}</div>
                <div><b>Debt:</b></div><div>$${k(o,2,"dollar")}${R(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${k(o/s,2,"dollar")}${R(o/s)}</div>
                </div>`}},legend:{show:!0}})),i=$(()=>{var t;return(((t=e.data)==null?void 0:t.bins)??[]).map(s=>{const[o,r]=s.rangeLabel.split(" - ").map(parseFloat),u=`$${k(o,0,"dollar")}${R(o)}`,c=`$${k(r,0,"dollar")}${R(r)}`;return`${u} - ${c}`})}),n=$(()=>{var t,s;return[{name:"Users",type:"column",data:(((t=e.data)==null?void 0:t.bins)??[]).map(o=>o.userCount)},{name:"Debt",type:"line",data:(((s=e.data)==null?void 0:s.bins)??[]).map(o=>o.totalDebt)}]});return(t,s)=>{const o=le,r=I;return m(),h(r,null,{default:g(()=>[d(o,{options:l(a),series:l(n)},null,8,["options","series"])]),_:1})}}}),Ut=D(At,[["__scopeId","data-v-73ee7851"]]),Bt=C({__name:"ChartLeverageDistribution",props:{data:{}},setup(e){const a=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},zoom:{enabled:!1}},xaxis:{categories:i.value,labels:{formatter:t=>t,rotate:-30},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${k(t,0,"dollar")}${R(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const s=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${i.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${s}</div>
                <div><b>Debt:</b></div><div>$${k(o,2,"dollar")}${R(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${k(o/s,2,"dollar")}${R(o/s)}</div>
                </div>`}},legend:{show:!0}})),i=$(()=>{var t;return(((t=e.data)==null?void 0:t.bins)??[]).map(s=>s.rangeLabel)}),n=$(()=>{var t,s;return[{name:"Users",type:"column",data:(((t=e.data)==null?void 0:t.bins)??[]).map(o=>o.userCount)},{name:"Debt",type:"line",data:(((s=e.data)==null?void 0:s.bins)??[]).map(o=>o.totalDebt)}]});return(t,s)=>{const o=le,r=I;return m(),h(r,null,{default:g(()=>[d(o,{options:l(a),series:l(n)},null,8,["options","series"])]),_:1})}}}),xt=D(Bt,[["__scopeId","data-v-80deb86d"]]),Nt={class:"kpis"},Kt={class:"kpi-subvalue"},Mt=C({__name:"CollateralRatioKPIs",props:{collateralRatio:{}},setup(e){const a=$(()=>{if(!e.collateralRatio||e.collateralRatio.bins.length===0)return;const i=[...e.collateralRatio.bins].sort((o,r)=>r.userCount-o.userCount)[0],[n,t]=i.rangeLabel.split(" - ").map(parseFloat);return{range:`${Math.round(n*100)}% - ${Math.round(t*100)}%`,users:i.userCount}});return(i,n)=>{var o;const t=V,s=Q;return m(),P("div",Nt,[d(s,{label:"Median Collateral Ratio","has-value":!!((o=i.collateralRatio)!=null&&o.medianRatio)},{default:g(()=>{var r;return[d(t,{type:"percentage",value:(r=i.collateralRatio)!=null&&r.medianRatio?i.collateralRatio.medianRatio*100:"?",precision:2},null,8,["value"])]}),_:1},8,["has-value"]),d(s,{label:"Most Common Collateral Ratio","has-value":!!l(a)},{default:g(()=>{var r,u;return[b("div",null,w(((r=l(a))==null?void 0:r.range)??"N/A"),1),b("div",Kt,[d(t,{value:((u=l(a))==null?void 0:u.users)??"?",precision:0},null,8,["value"]),n[0]||(n[0]=L(" users "))])]}),_:1},8,["has-value"])])}}}),Vt=D(Mt,[["__scopeId","data-v-cd75baa0"]]),Et={class:"kpis"},Ht=C({__name:"DebtKPIs",props:{debt:{}},setup(e){return(a,i)=>{var s,o;const n=V,t=Q;return m(),P("div",Et,[d(t,{label:"Max Debt","has-value":!!((s=a.debt)!=null&&s.maxDebt)},{default:g(()=>{var r;return[d(n,{type:"dollar",value:(r=a.debt)==null?void 0:r.maxDebt,precision:2,"show-symbol":!1},null,8,["value"])]}),_:1},8,["has-value"]),d(t,{label:"Median Debt","has-value":!!((o=a.debt)!=null&&o.medianDebt)},{default:g(()=>{var r;return[d(n,{type:"dollar",value:(r=a.debt)==null?void 0:r.medianDebt,precision:2,"show-symbol":!1},null,8,["value"])]}),_:1},8,["has-value"])])}}}),Ot=D(Ht,[["__scopeId","data-v-8ffe283b"]]),zt={class:"kpis"},Wt={class:"kpi-subvalue"},jt={class:"kpi-subvalue"},Gt={class:"kpi-subvalue"},Jt={class:"kpi-subvalue"},Qt=C({__name:"LeverageKPIs",props:{leverage:{},leverageStats:{}},setup(e){const a=$(()=>{if(!e.leverage||e.leverage.bins.length===0)return;const n=[...e.leverage.bins].sort((t,s)=>s.userCount-t.userCount)[0];return{range:n.rangeLabel,users:n.userCount}}),i=$(()=>{if(!e.leverage||e.leverage.bins.length===0)return;const n=[...e.leverage.bins].sort((t,s)=>s.totalDebt-t.totalDebt)[0];return{range:n.rangeLabel,debt:n.totalDebt}});return(n,t)=>{var r,u;const s=V,o=Q;return m(),P("div",zt,[d(o,{label:"Most Common Range","has-value":!!l(a)},{default:g(()=>{var c,_;return[b("div",null,w(((c=l(a))==null?void 0:c.range)??"N/A"),1),b("div",Wt,[d(s,{value:((_=l(a))==null?void 0:_.users)??"?",precision:0},null,8,["value"]),t[0]||(t[0]=L(" users "))])]}),_:1},8,["has-value"]),d(o,{label:"Highest Debt Range","has-value":!!l(i)},{default:g(()=>{var c,_;return[b("div",null,w((c=l(i))==null?void 0:c.range),1),b("div",jt,[d(s,{type:"dollar",value:(_=l(i))==null?void 0:_.debt,precision:2},null,8,["value"])])]}),_:1},8,["has-value"]),d(o,{label:"Leveraged Users","has-value":!!((r=n.leverageStats)!=null&&r.stats)},{default:g(()=>{var c,_;return[d(s,{value:(c=n.leverageStats)==null?void 0:c.stats.leveragedUsersCount,precision:0},null,8,["value"]),b("div",Gt,[d(s,{type:"percentage",value:(_=n.leverageStats)==null?void 0:_.stats.leveragedUsersPercentage,precision:2},null,8,["value"]),t[1]||(t[1]=L(" of total "))])]}),_:1},8,["has-value"]),d(o,{label:"Leveraged Debt","has-value":!!((u=n.leverageStats)!=null&&u.stats)},{default:g(()=>{var c,_;return[d(s,{type:"dollar",value:(c=n.leverageStats)==null?void 0:c.stats.leveragedDebt,precision:2,"show-symbol":!1},null,8,["value"]),b("div",Jt,[d(s,{type:"percentage",value:(_=n.leverageStats)==null?void 0:_.stats.leveragedDebtPercentage,precision:2},null,8,["value"]),t[2]||(t[2]=L(" of total "))])]}),_:1},8,["has-value"])])}}}),Yt=D(Qt,[["__scopeId","data-v-ae4a0874"]]),Xt={class:"dashboard-grid"},Zt=C({__name:"Health",props:{pair:{}},setup(e){const{isFetching:a,data:i}=qt(O(()=>({pair_id:e.pair.pairId}))),{isFetching:n,data:t}=Tt(O(()=>({pair_id:e.pair.pairId}))),{data:s}=Ft(O(()=>({pair_id:e.pair.pairId}))),{isFetching:o,data:r}=Lt(O(()=>({pair_id:e.pair.pairId})));return(u,c)=>(m(),P("div",Xt,[c[0]||(c[0]=b("div",{style:{"grid-area":"title-leverage-distribution"},class:"title"}," Leverage Distribution ",-1)),d(Yt,{style:{"grid-area":"kpis-leverage"},leverage:l(i),"leverage-stats":l(s)},null,8,["leverage","leverage-stats"]),d(xt,{style:{"grid-area":"chart-leverage-distribution"},data:l(i),loading:l(a)},null,8,["data","loading"]),c[1]||(c[1]=b("div",{style:{"grid-area":"title-debt-distribution"},class:"title"}," Debt Distribution ",-1)),d(Ot,{style:{"grid-area":"kpis-debt"},debt:l(t)},null,8,["debt"]),d(Ut,{style:{"grid-area":"chart-debt-distribution"},data:l(t),loading:l(n)},null,8,["data","loading"]),c[2]||(c[2]=b("div",{style:{"grid-area":"title-collateral-ratio-distribution"},class:"title"}," Collateral Ratio Distribution ",-1)),d(Vt,{style:{"grid-area":"kpis-collateral-ratio"},"collateral-ratio":l(r)},null,8,["collateral-ratio"]),d(St,{style:{"grid-area":"chart-collateral-ratio-distribution"},data:l(r),loading:l(o)},null,8,["data","loading"])]))}}),ea=D(Zt,[["__scopeId","data-v-aa4d047e"]]),ta=["href"],aa=["href"],sa={class:"end"},oa={class:"end"},ra={class:"end"},na={class:"end"},la=["href"],ia=C({__name:"TableLiquidations",props:{liquidations:{},count:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:a}){const i=a,{page:n,onPage:t}=oe(),s=ee(n,200);z(s,r=>{i("page",r)});const{relativeTime:o}=ne();return(r,u)=>{const c=re,_=V,T=se,F=ae,K=I;return m(),h(K,{title:"Liquidations"},{actions:g(()=>[d(c,{"items-count":r.count,"items-per-page":10,page:l(n),onPage:l(t)},null,8,["items-count","page","onPage"])]),default:g(()=>[e.liquidations.length>0?(m(),h(T,{key:0,rows:e.liquidations,columns:["Borrower","Liquidator",{label:"Shares liquidated",align:"end"},{label:"Collat for liquidator",align:"end"},{label:"Amount to repay (reUSD)",align:"end"},{label:"Time",align:"end"}]},{row:g(({item:f})=>[b("div",null,[b("a",{target:"_blank",href:`https://etherscan.io/address/${f.borrower}`,onClick:u[0]||(u[0]=E(()=>{},["stop"]))},w(f.borrower.ens||("addressShort"in r?r.addressShort:l(Y))(f.borrower.address)),9,ta)]),b("div",null,[b("a",{target:"_blank",href:`https://etherscan.io/address/${f.liquidator}`,onClick:u[1]||(u[1]=E(()=>{},["stop"]))},w(f.liquidator.ens||("addressShort"in r?r.addressShort:l(Y))(f.liquidator.address)),9,aa)]),b("div",sa,[d(_,{type:"dollar",value:f.sharesLiquidated/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),b("div",oa,[d(_,{type:"dollar",value:f.collateralForLiquidator/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),b("div",ra,[d(_,{type:"dollar",value:f.amountLiquidatorToRepay/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),b("div",na,[b("a",{target:"_blank",href:`https://etherscan.io/tx/${f.txHash}`,onClick:u[2]||(u[2]=E(()=>{},["stop"]))},w(l(o)(f.blockTime.getUTCTimestamp())),9,la)])]),_:1},8,["rows"])):r.loading?q("",!0):(m(),h(F,{key:1,message:"There are no liquidations"}))]),_:1})}}}),da=D(ia,[["__scopeId","data-v-f3133012"]]),ca={class:"dashboard-grid"},ua=C({__name:"Liquidations",props:{pair:{}},setup(e){const a=te(1),{isFetching:i,data:n}=et($(()=>({pair_id:e.pair.pairId,page:a.value,per_page:15})));return(t,s)=>{var o,r;return m(),P("div",ca,[d(da,{liquidations:((o=l(n))==null?void 0:o.events)??[],count:((r=l(n))==null?void 0:r.count)??0,loading:l(i),onPage:s[0]||(s[0]=u=>a.value=u)},null,8,["liquidations","count","loading"])])}}}),pa=D(ua,[["__scopeId","data-v-0dd6af85"]]),ma={style:{display:"flex"}},_a={ref:"chartRef",class:"chart"},ba=C({__name:"ChartBorrowCostApr",props:{apr:{}},setup(e){const a=ce(),i=ue("card"),{chart:n,series:t}=me({createChartOptions:be(),series:_e({name:"apr",color:$(()=>a.value.colors.red),formatter:o=>`${k(o,2,"percentage")}%`,minMove:.01})});pe(s);function s(){if(!n.value||!t.apr)return;const o=e.apr.map(r=>({time:r.timestamp.getUTCTimestamp(),value:r.apr})).uniqWith((r,u)=>r.time===u.time).orderBy(r=>r.time,"asc");o.length>0&&t.apr.setData(o),n.value.timeScale().fitContent()}return(o,r)=>{const u=ve,c=ge,_=I;return m(),h(_,{ref_key:"card",ref:i,title:"APR"},{actions:g(()=>[b("div",ma,[d(u,{filename:"apr",series:l(t)},null,8,["series"]),d(c,{chart:l(n),target:l(i)},null,8,["chart","target"])])]),default:g(()=>[b("div",_a,null,512)]),_:1},512)}}}),ga={style:{display:"flex"}},va={ref:"chartRef",class:"chart"},ha=C({__name:"ChartTvl",props:{tvl:{}},setup(e){const a=ce(),i=ue("card"),{chart:n,series:t}=me({createChartOptions:be(),series:_e({name:"tvl",color:$(()=>a.value.colors.blue),formatter:o=>`$${k(o,1,"dollar")}${R(o)}`})});pe(s);function s(){if(!n.value||!t.tvl)return;const o=e.tvl.map(r=>({time:r.timestamp.getUTCTimestamp(),value:r.tvl})).uniqWith((r,u)=>r.time===u.time).orderBy(r=>r.time,"asc");o.length>0&&t.tvl.setData(o),n.value.timeScale().fitContent()}return(o,r)=>{const u=ve,c=ge,_=I;return m(),h(_,{ref_key:"card",ref:i,title:"TVL"},{actions:g(()=>[b("div",ga,[d(u,{filename:"tvl",series:l(t)},null,8,["series"]),d(c,{chart:l(n),target:l(i)},null,8,["chart","target"])])]),default:g(()=>[b("div",va,null,512)]),_:1},512)}}}),fa={class:"kpis"},ya={class:"two-sides"},$a=C({__name:"OverviewKPIs",props:{pair:{}},setup(e){return(a,i)=>{const n=V,t=Q;return m(),P("div",fa,[d(t,{label:"Positions","has-value":!!a.pair},{default:g(()=>{var s;return[d(n,{precision:0,value:(s=a.pair)==null?void 0:s.activePositionsCount},null,8,["value"])]}),_:1},8,["has-value"]),d(t,{label:"TVL","has-value":!!a.pair},{default:g(()=>{var s;return[d(n,{type:"dollar",precision:2,value:(s=a.pair)==null?void 0:s.totalUnderlying,"show-symbol":!1},null,8,["value"]),L(" "+w(a.pair.tokenPairUnderyling.symbol),1)]}),_:1},8,["has-value"]),d(t,{label:"Debt","has-value":!!a.pair},{default:g(()=>{var s;return[d(n,{type:"dollar",precision:2,value:(s=a.pair)==null?void 0:s.totalDebt,"show-symbol":!1},null,8,["value"]),L(" "+w(a.pair.tokenDebt.symbol),1)]}),_:1},8,["has-value"]),d(t,{label:"Borrow Rate / Reward Rate","has-value":!!a.pair},{default:g(()=>{var s;return[b("div",ya,[d(n,{type:"percentage",precision:2,value:(s=a.pair)==null?void 0:s.aprBorrowCost},null,8,["value"]),d(Le,{pair:a.pair},null,8,["pair"])])]}),_:1},8,["has-value"]),d(t,{label:"Utilization Rate","has-value":!!a.pair},{default:g(()=>{var s;return[d(n,{type:"percentage",precision:2,value:(s=a.pair)==null?void 0:s.utilizationRate},null,8,["value"])]}),_:1},8,["has-value"])])}}}),Ca=D($a,[["__scopeId","data-v-0b31edc7"]]),Da={class:"dashboard-grid"},wa=C({__name:"Overview",props:{pair:{}},setup(e){const{isFetching:a,data:i}=Ye(O(()=>({pair_id:e.pair.pairId}))),n=$(()=>(i.value??[]).map(o=>({timestamp:o.time,tvl:o.totalUnderlying}))),t=$(()=>(i.value??[]).map(o=>({timestamp:o.time,apr:o.aprBorrowCost}))),s=$(()=>{const o=(i.value??[]).filter(c=>c.rewards.length>0),r=o.map(c=>({timestamp:c.time,apr:c.aprBase,tokenAddress:"0x0",tokenSymbol:"Base APR"})),u=o.flatMap(c=>c.rewards.map(_=>({..._,timestamp:c.time})));return r.concat(u).groupBy(c=>c.tokenAddress).entries().filter(([c,_])=>c==="0x0"||_.length>0&&_.sumBy(T=>T.apr)/_.length>=1).map(([,c])=>({symbol:c[0].tokenSymbol,balances:c.map(_=>({timestamp:_.timestamp,balance:_.apr,tokenPrice:1}))}))});return(o,r)=>{const u=qe,c=I;return m(),P("div",Da,[d(Ca,{style:{"grid-area":"kpis"},pair:o.pair},null,8,["pair"]),l(a)?(m(),h(c,{key:1,loading:"",title:"APR",style:ye(`grid-area: apr; min-height: ${l(Te)}`)},null,8,["style"])):(m(),h(u,{key:0,style:{"grid-area":"apr"},title:"APR",balances:l(s),"show-dollars":!1},null,8,["balances"])),d(ba,{style:{"grid-area":"borrow-cost-apr"},apr:l(t),loading:l(a)},null,8,["apr","loading"]),d(ha,{style:{"grid-area":"tvl"},tvl:l(n),loading:l(a)},null,8,["tvl","loading"])])}}}),ka=D(wa,[["__scopeId","data-v-d84bbad8"]]),Ra=["href"],Pa={class:"end"},Fa={class:"end"},qa={class:"end",style:{display:"flex",gap:"1ch"}},Ta={class:"end"},La={class:"end"},Ia=["href"],Sa=C({__name:"TableRedemptions",props:{redemptions:{},count:{},pair:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:a}){const i=a,{page:n,onPage:t}=oe(),s=ee(n,200);z(s,r=>{i("page",r)});const{relativeTime:o}=ne();return(r,u)=>{const c=re,_=V,T=se,F=ae,K=I;return m(),h(K,{title:"Redemptions"},{actions:g(()=>[d(c,{"items-count":r.count,"items-per-page":10,page:l(n),onPage:l(t)},null,8,["items-count","page","onPage"])]),default:g(()=>[e.redemptions.length>0?(m(),h(T,{key:0,rows:e.redemptions,columns:["Caller",{label:"reUSD",align:"end"},{label:"Debt reduction",align:"end"},{label:"Collateral freed",align:"end"},{label:"Protocol fee",align:"end"},{label:"Time",align:"end"}]},{row:g(({item:f})=>[b("div",null,[b("a",{target:"_blank",href:`https://etherscan.io/address/${f.caller}`,onClick:u[0]||(u[0]=E(()=>{},["stop"]))},w(f.caller.ens||("addressShort"in r?r.addressShort:l(Y))(f.caller.address)),9,Ra)]),b("div",Pa,[d(_,{type:"dollar",value:f.amount/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),b("div",Fa,[d(_,{type:"dollar",value:f.debtReduction/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),b("div",qa,[d(_,{type:"dollar",value:f.collateralFreed/10**18,precision:2,"show-symbol":!1},null,8,["value"]),L(" "+w(r.pair.tokenCollateral.symbol),1)]),b("div",Ta,[d(_,{type:"dollar",value:f.protocolFee/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),b("div",La,[b("a",{target:"_blank",href:`https://etherscan.io/tx/${f.txHash}`,onClick:u[1]||(u[1]=E(()=>{},["stop"]))},w(l(o)(f.blockTime.getUTCTimestamp())),9,Ia)])]),_:1},8,["rows"])):r.loading?q("",!0):(m(),h(F,{key:1,message:"There are no redemptions"}))]),_:1})}}}),Aa=D(Sa,[["__scopeId","data-v-bbc74a72"]]),Ua={class:"dashboard-grid"},Ba=C({__name:"Redemptions",props:{pair:{}},setup(e){const a=te(1),{isFetching:i,data:n}=Ze($(()=>({pair_id:e.pair.pairId,page:a.value,per_page:15})));return(t,s)=>{var o,r;return m(),P("div",Ua,[d(Aa,{redemptions:((o=l(n))==null?void 0:o.events)??[],count:((r=l(n))==null?void 0:r.count)??0,loading:l(i),pair:t.pair,onPage:s[0]||(s[0]=u=>a.value=u)},null,8,["redemptions","count","loading","pair"])])}}}),xa=D(Ba,[["__scopeId","data-v-eda307c4"]]),Na={class:"dashboard"},Ka=C({__name:"Pair.page",setup(e){const a=de("protocolName"),i=de("pairId",void 0,{transform:Number}),{isFetching:n,data:t}=we($(()=>({chain:"ethereum",protocol_name:a.value})),$(()=>!!a.value)),s=$(()=>(t.value??[]).find(c=>c.pairId===i.value)),{crumbs:o}=$e(Ce());z(s,c=>{o.value=[{id:"protocols",label:"Protocols",pathName:"protocols",params:()=>({protocolName:a.value})},{id:"protocol",label:a.value,pathName:"protocols",params:()=>({protocolName:a.value})},{id:"pair",label:`Pair: ${c!=null&&c.name?ke(c.name):"?"}`}]},{immediate:!0});const{tabActive:r,tabActiveIndex:u}=Ie(["overview","collateral","redemptions","liquidations","health"],"pair",void 0,{tabParamName:"pairTab"});return(c,_)=>{const T=De,F=he,K=fe;return m(),P("div",Na,[d(T,{loading:l(n)},null,8,["loading"]),!l(n)&&l(s)?(m(),h(K,{key:0,active:l(u),onTab:_[0]||(_[0]=f=>u.value=f.index)},{default:g(()=>[d(F,{header:"Overview"},{default:g(()=>[(m(),h(H,null,[l(r)==="overview"?(m(),h(ka,{key:0,pair:l(s)},null,8,["pair"])):q("",!0)],1024))]),_:1}),d(F,{header:"Collateral"},{default:g(()=>[(m(),h(H,null,[l(r)==="collateral"?(m(),h(ut,{key:0,pair:l(s)},null,8,["pair"])):q("",!0)],1024))]),_:1}),d(F,{header:"Redemptions"},{default:g(()=>[(m(),h(H,null,[l(r)==="redemptions"?(m(),h(xa,{key:0,pair:l(s)},null,8,["pair"])):q("",!0)],1024))]),_:1}),d(F,{header:"Liquidation"},{default:g(()=>[(m(),h(H,null,[l(r)==="liquidations"?(m(),h(pa,{key:0,pair:l(s)},null,8,["pair"])):q("",!0)],1024))]),_:1}),d(F,{header:"Health"},{default:g(()=>[(m(),h(H,null,[l(r)==="health"?(m(),h(ea,{key:0,pair:l(s)},null,8,["pair"])):q("",!0)],1024))]),_:1})]),_:1},8,["active"])):q("",!0)])}}}),ns=D(Ka,[["__scopeId","data-v-9fb4fef3"]]);export{ns as default};
