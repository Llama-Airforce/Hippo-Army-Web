import{_ as H}from"./DashboardHeader-BRJ85zSY.js";import{d as b,u as T,ai as q,c as _,w as k,b as w,o as f,e as g,f as C,g as p,h as n,k as N,_ as B,l as D,a as E,aR as j,aS as z,t as y,i as G,j as R,aC as J,m as K,n as $}from"./index-CUxH3Ppq.js";import{a as Q,b as X,c as Y,d as Z}from"./stablecoin-C50lq5Eb.js";import{a as ee,_ as te}from"./ChartBalances-CVKyjZ-7.js";import{u as M,a as F,S as oe,c as I,_ as V,D as ae}from"./UseLightweightChart-BOdyq67m.js";import{r as U,u as P}from"./timestamp-CJsqb-wj.js";import{_ as O}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-Bri0yxN6.js";import"./UseLegend-B8r6FWmJ.js";import"./Tooltip-Dbf44SJA.js";const se={class:"controls"},ne={ref:"chartRef",class:"chart"},le=b({__name:"ChartPrice",props:{ohlc:{},minMove:{default:()=>{}}},setup(m){const d=T(),c=q(!1);let r=1,u=0;const{chart:h,series:s}=M({createChartOptions:F(),series:{type:oe,name:"ohlc",options:_(()=>{const{colors:e}=d.value;return{priceFormat:{type:"custom",formatter:i,minMove:m.minMove},upColor:e.green,borderUpColor:e.green,wickUpColor:e.green,downColor:e.red,borderDownColor:e.red,wickDownColor:e.red}})}});k(t);function t(){if(!h.value||!s.ohlc)return;const e=c.value?-1:1,o=m.ohlc.map(a=>({time:a.time.getUTCTimestamp(),open:Math.pow(a.open,e),high:Math.pow(a.high,e),low:Math.pow(a.low,e),close:Math.pow(a.close,e)})).uniqWith((a,v)=>a.time===v.time).orderBy(a=>a.time,"asc");s.ohlc.setData(o),u=Math.min(...o.map(a=>a.low)),r=Math.max(...o.map(a=>a.high)),h.value.timeScale().fitContent()}function i(e){const o=r-u,a=o>1?o-Math.floor(o):o,v=-Math.floor(Math.log10(a)+1)+2;return`${U(e,v,"dollar")}${P(e)}`}return(e,o)=>{const a=ee,v=B;return f(),w(v,{title:"Price"},{actions:g(()=>[C("div",se,[p(a,{"model-value":n(c),onClick:o[0]||(o[0]=x=>c.value=!n(c))},{default:g(()=>o[1]||(o[1]=[N(" Invert ")])),_:1,__:[1]},8,["model-value"])])]),default:g(()=>[C("div",ne,null,512)]),_:1})}}}),re=D(le,[["__scopeId","data-v-13cc1234"]]),ce={style:{display:"flex"}},ie={ref:"chartRef",class:"chart"},me=b({__name:"ChartTvl",props:{tvl:{}},setup(m){const d=T(),c=E("card"),{chart:r,series:u}=M({createChartOptions:F(),series:I({name:"tvl",color:_(()=>d.value.colors.blue),formatter:s=>`$${U(s,1,"dollar")}${P(s)}`})});k(h);function h(){if(!r.value||!u.tvl)return;const s=m.tvl.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.tvl})).uniqWith((t,i)=>t.time===i.time).orderBy(t=>t.time,"asc");s.length>0&&u.tvl.setData(s),r.value.timeScale().fitContent()}return(s,t)=>{const i=O,e=V,o=B;return f(),w(o,{ref_key:"card",ref:c,title:"TVL"},{actions:g(()=>[C("div",ce,[p(i,{filename:"tvl",series:n(u)},null,8,["series"]),p(e,{chart:n(r),target:n(c)},null,8,["chart","target"])])]),default:g(()=>[C("div",ie,null,512)]),_:1},512)}}}),ue={style:{display:"flex"}},de={ref:"chartRef",class:"chart"},pe=b({__name:"ChartVolume",props:{volume:{}},setup(m){const d=T(),c=E("card"),{chart:r,series:u}=M({createChartOptions:F(),series:I({name:"volume",color:_(()=>d.value.colors.blue),formatter:s=>`$${U(s,1,"dollar")}${P(s)}`})});k(h);function h(){if(!r.value||!u.volume)return;const s=m.volume.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.volume})).uniqWith((t,i)=>t.time===i.time).orderBy(t=>t.time,"asc");s.length>0&&u.volume.setData(s),r.value.timeScale().fitContent()}return(s,t)=>{const i=O,e=V,o=B;return f(),w(o,{ref_key:"card",ref:c,title:"Volume"},{actions:g(()=>[C("div",ue,[p(i,{filename:"volume",series:n(u)},null,8,["series"]),p(e,{chart:n(r),target:n(c)},null,8,["chart","target"])])]),default:g(()=>[C("div",de,null,512)]),_:1},512)}}}),_e=b({__name:"Pool",props:{pool:{}},setup(m){const d=_(()=>{switch(m.pool){case"scrvusd":return"0xc522A6606BBA746d7960404F22a3DB936B6F4F50";case"sfrxusd":return"0xed785Af60bEd688baa8990cD5c4166221599A441";default:throw new Error(`Unknown pool: ${m.pool}`)}}),c=_(()=>{switch(m.pool){case"scrvusd":return z;case"sfrxusd":return j;default:throw new Error(`Unknown pool: ${m.pool}`)}}),{isFetching:r,data:u}=Q(y(()=>"ethereum"),d,c,y(()=>G)),{isFetching:h,data:s}=X(y(()=>"ethereum"),d),{isFetching:t,data:i}=Y(y(()=>"ethereum"),d),{isFetching:e,data:o}=Z(y(()=>"ethereum"),d.value),a=_(()=>s.value.map(l=>({timestamp:l.timestamp,volume:l.volume}))),v=_(()=>i.value.map(l=>({timestamp:l.timestamp,tvl:l.tvlUSD}))),x=_(()=>!o.value||i.value.length===0?[]:o.value.coins.map(l=>({symbol:l.symbol,balances:i.value.map(S=>({timestamp:S.timestamp,balance:S.balances[l.poolIndex],tokenPrice:S.tokenPrices[l.poolIndex]}))}))),A=_(()=>e.value||t.value);return(l,S)=>{const W=B;return f(),R(J,null,[C("div",{class:"title",style:$(`grid-area: title-${l.pool}`)}," Pool: "+K(l.pool),5),p(re,{style:$(`grid-area: price-${l.pool}`),ohlc:n(u),loading:n(r),"min-move":.001},null,8,["style","ohlc","loading"]),p(pe,{style:$(`grid-area: volume-${l.pool}`),volume:n(a),loading:n(h)},null,8,["style","volume","loading"]),p(me,{style:$(`grid-area: tvl-${l.pool}`),tvl:n(v),loading:n(t)},null,8,["style","tvl","loading"]),n(A)?(f(),w(W,{key:1,loading:"",title:"Balances",style:$(`grid-area: balances-${l.pool}; min-height: ${n(ae)}`)},null,8,["style"])):(f(),w(te,{key:0,style:$(`grid-area: balances-${l.pool}`),balances:n(x),loading:n(A)},null,8,["style","balances","loading"]))],64)}}}),L=D(_e,[["__scopeId","data-v-b59a0214"]]),he={class:"dashboard"},ve=b({__name:"Stablecoin.page",setup(m){return(d,c)=>{const r=H;return f(),R("div",he,[p(r,{style:{"grid-area":"header"},title:"Stablecoin",description:"reUSD stablecoin metrics and liquidity pool analytics"}),p(L,{pool:"scrvusd"}),p(L,{pool:"sfrxusd"})])}}}),Te=D(ve,[["__scopeId","data-v-70317081"]]);export{Te as default};
