import{a as H,_ as q}from"./TabItem.vue_vue_type_script_setup_true_lang-Da-3Aqt-.js";import{_ as G}from"./DashboardHeader-uaWxnsjV.js";import{_ as J}from"./KPI-P5Tjq05N.js";import{_ as V}from"./AsyncValue-Drfpo5Bi.js";import{b as K,c as j,a as M}from"./protocols-DvsMd1VC.js";import{d as w,u as Q,a as X,c as b,w as Y,b as h,o as m,e as u,f as _,g as o,h as t,_ as A,aD as Z,ar as ee,l as T,t as te,aE as oe,m as L,k as D,j as F,aF as ae,aG as ne,aA as se,av as re,aH as le,aI as B,an as k}from"./index-V38PSwR-.js";import{b as ie,u as ce,c as ue,J as de,r as me,a as pe,d as _e,_ as ve}from"./UseLightweightChart-CLSj911F.js";import{_ as ge}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-CdRPzAYG.js";import{r as N,u as R}from"./timestamp-CFR8-yJ3.js";import{_ as he}from"./Table-BbxGOwPz.js";import{_ as fe}from"./TokenIcon-Dqfg-nxh.js";import{u as be,_ as ye}from"./UsePagination-B4VYoLDH.js";import{p as S}from"./util-CVNQ9WdU.js";import{T as we,u as Ce}from"./UseTabNavigation-O1tLT8Fw.js";import{u as Pe}from"./UseSort-BLjwE6c_.js";import"./Tooltip-Dyx_j7GF.js";import"./Pagination-vgbH7lYO.js";import"./index-BsSJClOC.js";const Te={style:{display:"flex"}},$e={ref:"chartRef",class:"chart"},xe=w({__name:"ChartTvl",props:{tvl:{}},setup(d){const s=Q(),{items:v,toggles:a,disabled:y}=ie(()=>[{id:"underlying",label:"Underlying",color:s.value.colorsArray[0],togglable:!0},{id:"debt",label:"Debt",color:s.value.colorsArray[1],togglable:!0}]),c=X("card"),{chart:p,series:r}=ce({createChartOptions:pe(),series:[ue({name:"underlying",color:b(()=>s.value.colors.blue),formatter:e=>`$${N(e,1,"dollar")}${R(e)}`}),{type:de,name:"debt",options:b(()=>({priceFormat:{type:"custom",formatter:e=>`$${N(e,1,"dollar")}${R(e)}`},lineWidth:2,lineType:me.WithSteps,color:s.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});Y(n);function n(){!p.value||!r.underlying||!r.debt||(r.underlying.setData(d.tvl.map(e=>({time:e.timestamp.getUTCTimestamp(),value:e.underlying})).uniqWith((e,l)=>e.time===l.time).orderBy(e=>e.time,"asc")),r.debt.setData(d.tvl.map(e=>({time:e.timestamp.getUTCTimestamp(),value:e.debt})).uniqWith((e,l)=>e.time===l.time).orderBy(e=>e.time,"asc")),r.underlying.applyOptions({visible:a.underlying.value}),r.debt.applyOptions({visible:a.debt.value}),p.value.timeScale().fitContent())}return(e,l)=>{const g=ge,$=ve,i=_e,C=A;return m(),h(C,{ref_key:"card",ref:c,title:"TVL"},{actions:u(()=>[_("div",Te,[o(g,{filename:"tvl",series:t(r)},null,8,["series"]),o($,{chart:t(p),target:t(c)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[o(i,{items:t(v),disabled:t(y),onToggle:l[0]||(l[0]=P=>t(a)[P].value=!t(a)[P].value)},null,8,["items","disabled"])]),default:u(()=>[_("div",$e,null,512)]),_:1},512)}}}),Le=w({__name:"IconExpander",props:{expanded:{type:Boolean,default:!1}},setup(d){return(s,v)=>{const a=Z;return m(),h(a,{class:ee(["expander",{expanded:s.expanded}])},null,8,["class"])}}}),Be=T(Le,[["__scopeId","data-v-7caf48cb"]]),ke={class:"token"},Ne={class:"end",style:{display:"flex",gap:"1ch"}},Re={class:"end"},Se={class:"end"},Ie={class:"end"},I=20,Ue=w({__name:"TablePairs",props:{protocolName:{}},setup(d){const{isFetching:s,data:v}=K(te(()=>({chain:"ethereum",protocol_name:d.protocolName||""})),b(()=>!!d.protocolName)),a=b(()=>v.value?.filter(i=>i.borrowLimit>0)),y=["","",{id:"name",label:"Name",sort:!0},{id:"tvl",label:"TVL",sort:!0,align:"end"},{id:"rewardRate",label:"Reward Rate",sort:!0,align:"end"},{id:"borrowRate",label:"Borrow Rate",sort:!0,align:"end"},{id:"util",label:"Util",sort:!0,align:"end"}],{sorting:c,onSort:p}=Pe("tvl"),r=b(()=>(a.value??[]).orderBy(i=>{switch(c.value.column){case"name":return S(i.name);case"tvl":return i.totalUnderlying;case"rewardRate":return i.aprBase+i.rewards.sumBy(C=>C.apr);case"borrowRate":return i.aprBorrowCost;case"util":return i.utilizationRate}},c.value.order)),{page:n,rowsPage:e,onPage:l}=be(r,I),g=oe(),$=async i=>{await g.push({name:"pair",params:{protocolName:d.protocolName?.toLocaleLowerCase(),pairId:i.pairId.toString()}})};return(i,C)=>{const P=ye,z=Be,E=fe,x=V,W=he,O=A;return m(),h(O,{title:"Pairs",loading:t(s)},{actions:u(()=>[o(P,{"items-count":t(r).length,"items-per-page":I,page:t(n),onPage:t(l)},null,8,["items-count","page","onPage"])]),default:u(()=>[o(W,{class:"pairs-table",rows:t(e),columns:y,sorting:t(c),onSortColumn:t(p),onSelect:$},{row:u(({item:f})=>[o(z),_("div",ke,[(m(),h(E,{key:f.tokenPairCollateral.symbol,chain:"ethereum",address:f.tokenPairCollateral.address},null,8,["address"]))]),_("div",null,L(t(S)(f.name)),1),_("div",Ne,[o(x,{"show-zero":"",type:"dollar",value:f.totalUnderlying,precision:2,"show-symbol":!1},null,8,["value"]),D(" "+L(f.tokenPairUnderyling.symbol),1)]),_("div",Re,[o(we,{pair:f},null,8,["pair"])]),_("div",Se,[o(x,{"show-zero":"",type:"percentage",value:f.aprBorrowCost,precision:2},null,8,["value"])]),_("div",Ie,[o(x,{"show-zero":"",type:"percentage",value:f.utilizationRate,precision:2},null,8,["value"])])]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),Ve=T(Ue,[["__scopeId","data-v-8428af24"]]),Ae={class:"dashboard-grid root"},De={class:"kpis"},Fe={class:"dashboard-grid charts"},ze=w({__name:"Protocol",props:{protocol:{}},setup(d){const{isFetching:s,data:v}=j({chain:"ethereum"}),a=b(()=>(v.value?.protocols??[]).find(n=>n.name.toLocaleLowerCase()===d.protocol)),{isFetching:y,data:c}=M({chain:"ethereum"}),p=b(()=>(c.value?.snapshots??[]).filter(n=>n.name.toLocaleLowerCase()===d.protocol).groupBy(n=>n.timestamp.getTime()).entries()),r=b(()=>p.value.flatMap(([,n])=>({timestamp:n[0].timestamp,underlying:n.sumBy(e=>e.totalUnderlying),debt:n.sumBy(e=>e.totalDebt)})));return(n,e)=>{const l=V,g=J;return m(),F("div",Ae,[_("div",De,[o(g,{label:"Pairs","has-value":!t(s)},{default:u(()=>[o(l,{value:t(a)?.pairsCount,precision:0},null,8,["value"])]),_:1},8,["has-value"]),o(g,{label:"Total collateral","has-value":!t(s)},{default:u(()=>[o(l,{type:"dollar",value:t(a)?.totalUnderlying?t(a).totalUnderlying:void 0,precision:2},null,8,["value"])]),_:1},8,["has-value"]),o(g,{label:"Total debt","has-value":!t(s)},{default:u(()=>[o(l,{value:t(a)?.totalDebt,precision:0},null,8,["value"]),e[0]||(e[0]=D(" reUSD "))]),_:1,__:[0]},8,["has-value"])]),o(Ve,{"protocol-name":t(a)?.name},null,8,["protocol-name"]),_("div",Fe,[o(xe,{style:{"grid-area":"chart-tvl"},tvl:t(r),loading:t(y)},null,8,["tvl","loading"])])])}}}),U=T(ze,[["__scopeId","data-v-30028cd7"]]),Ee={key:1,class:"dashboard"},We=w({__name:"Protocols.page",setup(d){const{tabActive:s,tabActiveIndex:v}=Ce(["curvelend","fraxlend"],"protocols",void 0,{tabParamName:"protocolName"}),{crumbs:a}=ae(ne()),y=se();return re(()=>y.name,c=>{c!=="pair"&&(a.value=[{id:"protocols",label:"Protocols",pathName:"protocols"}])},{immediate:!0}),(c,p)=>{const r=le("router-view"),n=G,e=H,l=q;return c.$route.name==="pair"?(m(),h(r,{key:0})):(m(),F("div",Ee,[o(n,{style:{"grid-area":"header"},title:"Protocols",description:"Lending markets metrics for Curve Lend and Frax Lend protocols"}),o(l,{active:t(v),onTab:p[0]||(p[0]=g=>v.value=g.index)},{default:u(()=>[o(e,{header:"Curve Lend"},{default:u(()=>[(m(),h(B,null,[t(s)==="curvelend"?(m(),h(U,{key:0,protocol:"curvelend"})):k("",!0)],1024))]),_:1}),o(e,{header:"Frax Lend"},{default:u(()=>[(m(),h(B,null,[t(s)==="fraxlend"?(m(),h(U,{key:0,protocol:"fraxlend"})):k("",!0)],1024))]),_:1})]),_:1},8,["active"])]))}}}),rt=T(We,[["__scopeId","data-v-90d9b0e2"]]);export{rt as default};
