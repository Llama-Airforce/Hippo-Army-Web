var ut=i=>{throw TypeError(i)};var G=(i,t,e)=>t.has(i)||ut("Cannot "+e);var s=(i,t,e)=>(G(i,t,"read from private field"),e?e.call(i):t.get(i)),p=(i,t,e)=>t.has(i)?ut("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),u=(i,t,e,n)=>(G(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e),l=(i,t,e)=>(G(i,t,"access private method"),e);import{aL as Ot,bI as lt,bJ as m,bK as Y,bL as Z,bM as St,bN as dt,bO as ft,bP as wt,bQ as Ct,bR as Tt,bS as pt,aM as Dt,aO as It,c as Qt,aP as Et,bT as Ft,b6 as Mt,av as V,bU as bt,aj as Ut,bV as gt,aR as xt,ak as Lt,b5 as Pt}from"./index-BYo41Xup.js";var g,r,W,b,Q,L,w,C,z,P,j,E,F,T,_,c,A,X,q,tt,et,st,it,nt,mt,Rt,jt=(Rt=class extends Ot{constructor(t,e){super();p(this,c);p(this,g);p(this,r);p(this,W);p(this,b);p(this,Q);p(this,L);p(this,w);p(this,C);p(this,z);p(this,P);p(this,j);p(this,E);p(this,F);p(this,T);p(this,_,new Set);this.options=e,u(this,g,t),u(this,C,null),u(this,w,lt()),this.options.experimental_prefetchInRender||s(this,w).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(s(this,r).addObserver(this),vt(s(this,r),this.options)?l(this,c,A).call(this):this.updateResult(),l(this,c,et).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return rt(s(this,r),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return rt(s(this,r),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,l(this,c,st).call(this),l(this,c,it).call(this),s(this,r).removeObserver(this)}setOptions(t){const e=this.options,n=s(this,r);if(this.options=s(this,g).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof m(this.options.enabled,s(this,r))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");l(this,c,nt).call(this),s(this,r).setOptions(this.options),e._defaulted&&!Y(this.options,e)&&s(this,g).getQueryCache().notify({type:"observerOptionsUpdated",query:s(this,r),observer:this});const o=this.hasListeners();o&&yt(s(this,r),n,this.options,e)&&l(this,c,A).call(this),this.updateResult(),o&&(s(this,r)!==n||m(this.options.enabled,s(this,r))!==m(e.enabled,s(this,r))||Z(this.options.staleTime,s(this,r))!==Z(e.staleTime,s(this,r)))&&l(this,c,X).call(this);const h=l(this,c,q).call(this);o&&(s(this,r)!==n||m(this.options.enabled,s(this,r))!==m(e.enabled,s(this,r))||h!==s(this,T))&&l(this,c,tt).call(this,h)}getOptimisticResult(t){const e=s(this,g).getQueryCache().build(s(this,g),t),n=this.createResult(e,t);return kt(this,n)&&(u(this,b,n),u(this,L,this.options),u(this,Q,s(this,r).state)),n}getCurrentResult(){return s(this,b)}trackResult(t,e){return new Proxy(t,{get:(n,o)=>(this.trackProp(o),e==null||e(o),Reflect.get(n,o))})}trackProp(t){s(this,_).add(t)}getCurrentQuery(){return s(this,r)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=s(this,g).defaultQueryOptions(t),n=s(this,g).getQueryCache().build(s(this,g),e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return l(this,c,A).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),s(this,b)))}createResult(t,e){var ct;const n=s(this,r),o=this.options,h=s(this,b),d=s(this,Q),O=s(this,L),k=t!==n?t.state:s(this,W),{state:$}=t;let f={...$},I=!1,a;if(e._optimisticResults){const v=this.hasListeners(),B=!v&&vt(t,e),x=v&&yt(t,n,e,o);(B||x)&&(f={...f,...Tt($.data,t.options)}),e._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:S,errorUpdatedAt:M,status:y}=f;a=f.data;let N=!1;if(e.placeholderData!==void 0&&a===void 0&&y==="pending"){let v;h!=null&&h.isPlaceholderData&&e.placeholderData===(O==null?void 0:O.placeholderData)?(v=h.data,N=!0):v=typeof e.placeholderData=="function"?e.placeholderData((ct=s(this,j))==null?void 0:ct.state.data,s(this,j)):e.placeholderData,v!==void 0&&(y="success",a=pt(h==null?void 0:h.data,v,e),I=!0)}if(e.select&&a!==void 0&&!N)if(h&&a===(d==null?void 0:d.data)&&e.select===s(this,z))a=s(this,P);else try{u(this,z,e.select),a=e.select(a),a=pt(h==null?void 0:h.data,a,e),u(this,P,a),u(this,C,null)}catch(v){u(this,C,v)}s(this,C)&&(S=s(this,C),a=s(this,P),M=Date.now(),y="error");const U=f.fetchStatus==="fetching",H=y==="pending",K=y==="error",ot=H&&U,ht=a!==void 0,R={status:y,fetchStatus:f.fetchStatus,isPending:H,isSuccess:y==="success",isError:K,isInitialLoading:ot,isLoading:ot,data:a,dataUpdatedAt:f.dataUpdatedAt,error:S,errorUpdatedAt:M,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>k.dataUpdateCount||f.errorUpdateCount>k.errorUpdateCount,isFetching:U,isRefetching:U&&!H,isLoadingError:K&&!ht,isPaused:f.fetchStatus==="paused",isPlaceholderData:I,isRefetchError:K&&ht,isStale:at(t,e),refetch:this.refetch,promise:s(this,w)};if(this.options.experimental_prefetchInRender){const v=J=>{R.status==="error"?J.reject(R.error):R.data!==void 0&&J.resolve(R.data)},B=()=>{const J=u(this,w,R.promise=lt());v(J)},x=s(this,w);switch(x.status){case"pending":t.queryHash===n.queryHash&&v(x);break;case"fulfilled":(R.status==="error"||R.data!==x.value)&&B();break;case"rejected":(R.status!=="error"||R.error!==x.reason)&&B();break}}return R}updateResult(){const t=s(this,b),e=this.createResult(s(this,r),this.options);if(u(this,Q,s(this,r).state),u(this,L,this.options),s(this,Q).data!==void 0&&u(this,j,s(this,r)),Y(e,t))return;u(this,b,e);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:o}=this.options,h=typeof o=="function"?o():o;if(h==="all"||!h&&!s(this,_).size)return!0;const d=new Set(h??s(this,_));return this.options.throwOnError&&d.add("error"),Object.keys(s(this,b)).some(O=>{const D=O;return s(this,b)[D]!==t[D]&&d.has(D)})};l(this,c,mt).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&l(this,c,et).call(this)}},g=new WeakMap,r=new WeakMap,W=new WeakMap,b=new WeakMap,Q=new WeakMap,L=new WeakMap,w=new WeakMap,C=new WeakMap,z=new WeakMap,P=new WeakMap,j=new WeakMap,E=new WeakMap,F=new WeakMap,T=new WeakMap,_=new WeakMap,c=new WeakSet,A=function(t){l(this,c,nt).call(this);let e=s(this,r).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(St)),e},X=function(){l(this,c,st).call(this);const t=Z(this.options.staleTime,s(this,r));if(dt||s(this,b).isStale||!ft(t))return;const n=wt(s(this,b).dataUpdatedAt,t)+1;u(this,E,setTimeout(()=>{s(this,b).isStale||this.updateResult()},n))},q=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(s(this,r)):this.options.refetchInterval)??!1},tt=function(t){l(this,c,it).call(this),u(this,T,t),!(dt||m(this.options.enabled,s(this,r))===!1||!ft(s(this,T))||s(this,T)===0)&&u(this,F,setInterval(()=>{(this.options.refetchIntervalInBackground||Ct.isFocused())&&l(this,c,A).call(this)},s(this,T)))},et=function(){l(this,c,X).call(this),l(this,c,tt).call(this,l(this,c,q).call(this))},st=function(){s(this,E)&&(clearTimeout(s(this,E)),u(this,E,void 0))},it=function(){s(this,F)&&(clearInterval(s(this,F)),u(this,F,void 0))},nt=function(){const t=s(this,g).getQueryCache().build(s(this,g),this.options);if(t===s(this,r))return;const e=s(this,r);u(this,r,t),u(this,W,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},mt=function(t){Dt.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(s(this,b))}),s(this,g).getQueryCache().notify({query:s(this,r),type:"observerResultsUpdated"})})},Rt);function _t(i,t){return m(t.enabled,i)!==!1&&i.state.data===void 0&&!(i.state.status==="error"&&t.retryOnMount===!1)}function vt(i,t){return _t(i,t)||i.state.data!==void 0&&rt(i,t,t.refetchOnMount)}function rt(i,t,e){if(m(t.enabled,i)!==!1){const n=typeof e=="function"?e(i):e;return n==="always"||n!==!1&&at(i,t)}return!1}function yt(i,t,e,n){return(i!==t||m(n.enabled,i)===!1)&&(!e.suspense||i.state.status!=="error")&&at(i,e)}function at(i,t){return m(t.enabled,i)!==!1&&i.isStaleByTime(Z(t.staleTime,i))}function kt(i,t){return!Y(i.getCurrentResult(),t)}function Nt(i,t,e){const n=It(),o=Qt(()=>{const a=Et(t);typeof a.enabled=="function"&&(a.enabled=a.enabled());const S=n.defaultQueryOptions(a);return S._optimisticResults=n.isRestoring.value?"isRestoring":"optimistic",S}),h=new i(n,o.value),d=o.value.shallow?Ft(h.getCurrentResult()):Mt(h.getCurrentResult());let O=()=>{};V(n.isRestoring,a=>{a||(O(),O=h.subscribe(S=>{bt(d,S)}))},{immediate:!0});const D=()=>{h.setOptions(o.value),bt(d,h.getCurrentResult())};V(o,D),Ut(()=>{O()});const k=(...a)=>(D(),d.refetch(...a)),$=()=>new Promise((a,S)=>{let M=()=>{};const y=()=>{if(o.value.enabled!==!1){h.setOptions(o.value);const N=h.getOptimisticResult(o.value);N.isStale?(M(),h.fetchOptimistic(o.value).then(a,U=>{gt(o.value.throwOnError,[U,h.getCurrentQuery()])?S(U):a(h.getCurrentResult())})):(M(),a(N))}};y(),M=V(o,y)});V(()=>d.error,a=>{if(d.isError&&!d.isFetching&&gt(o.value.throwOnError,[a,h.getCurrentQuery()]))throw a});const f=o.value.shallow?xt(d):Lt(d),I=Pt(f);for(const a in d)typeof d[a]=="function"&&(I[a]=d[a]);return I.suspense=$,I.refetch=k,I}function Zt(i,t){return Nt(jt,i)}function Ht(i){const t=["","k","m","b","t"],e=Math.max(0,Math.min(t.length-1,Math.floor(Math.log10(Math.abs(i))/3)));return t[e]}function Kt(i,t=0,e=""){if(e==="dollar"){const o=Math.floor(Math.log10(Math.abs(i))/3)*3;i/=o>0?10**o:1}const n=t===1/0?void 0:{minimumFractionDigits:t,maximumFractionDigits:t};return i.toLocaleString(void 0,n)}const Gt=i=>{const t=new URLSearchParams(Object.entries(i).filter(([e,n])=>n!=null).map(([e,n])=>[e,n.toString()])).toString();return t&&`?${t}`};class At extends Error{constructor(t,e){super(e),this.status=t}}async function Wt(i,t,e){const n=await fetch(i,{method:t?"POST":"GET",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t),signal:e});if(!n.ok)throw new At(n.status,`Fetch error ${n.status} for URL: ${i}`);return n}async function Yt(i,t,e){return await(await Wt(i,t,e)).json()}const zt=/[+-]\d{2}:?\d{2}$/;function Xt(i){if(typeof i=="number")return new Date(i*1e3);const t=Number(i);if(!Number.isNaN(t))return new Date(t*1e3);const n=i.endsWith("Z")||zt.test(i)?i:`${i}Z`;return new Date(n)}const $t=24*60*60;function qt({end:i,start:t,daysRange:e=10}={}){return i??(i=Math.floor(Date.now()/1e3)),t??(t=i-e*$t),{end:i,start:t}}export{At as F,jt as Q,Zt as a,Gt as b,Yt as f,qt as g,Kt as r,Xt as t,Ht as u};
