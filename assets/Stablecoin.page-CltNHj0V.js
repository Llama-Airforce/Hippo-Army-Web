import{_ as q}from"./DashboardHeader-Ci7jZZVU.js";import{d as C,u as S,a as P,c as p,w as T,b as $,o as f,e as y,f as v,g as c,h as o,_ as B,t as b,j as R,aC as H,m as N,n as g,l as A}from"./index-DI-_SjLK.js";import{a as j,b as z,c as G}from"./stablecoin-DfvE6y6F.js";import{_ as J}from"./ChartBalances-CQ4pgoF4.js";import{u as w,c as D,a as F,_ as k,D as K}from"./UseLightweightChart-DoaEjcAr.js";import{_ as x}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-DYmAZovD.js";import{r as E,u as L}from"./timestamp-CM3_kXC8.js";import{d as Q}from"./protocols-Dpgppd_T.js";import"./Tooltip-BRnUACQp.js";import"./Pagination-vgbH7lYO.js";const X={style:{display:"flex"}},Y={ref:"chartRef",class:"chart"},Z=C({__name:"ChartTvl",props:{tvl:{}},setup(l){const u=S(),i=P("card"),{chart:s,series:n}=w({createChartOptions:F(),series:D({name:"tvl",color:p(()=>u.value.colors.blue),formatter:e=>`$${E(e,1,"dollar")}${L(e)}`})});T(_);function _(){if(!s.value||!n.tvl)return;const e=l.tvl.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.tvl})).uniqWith((t,r)=>t.time===r.time).orderBy(t=>t.time,"asc");e.length>0&&n.tvl.setData(e),s.value.timeScale().fitContent()}return(e,t)=>{const r=x,h=k,d=B;return f(),$(d,{ref_key:"card",ref:i,title:"TVL"},{actions:y(()=>[v("div",X,[c(r,{filename:"tvl",series:o(n)},null,8,["series"]),c(h,{chart:o(s),target:o(i)},null,8,["chart","target"])])]),default:y(()=>[v("div",Y,null,512)]),_:1},512)}}}),ee={style:{display:"flex"}},te={ref:"chartRef",class:"chart"},ae=C({__name:"ChartVolume",props:{volume:{}},setup(l){const u=S(),i=P("card"),{chart:s,series:n}=w({createChartOptions:F(),series:D({name:"volume",color:p(()=>u.value.colors.blue),formatter:e=>`$${E(e,1,"dollar")}${L(e)}`})});T(_);function _(){if(!s.value||!n.volume)return;const e=l.volume.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.volume})).uniqWith((t,r)=>t.time===r.time).orderBy(t=>t.time,"asc");e.length>0&&n.volume.setData(e),s.value.timeScale().fitContent()}return(e,t)=>{const r=x,h=k,d=B;return f(),$(d,{ref_key:"card",ref:i,title:"Volume"},{actions:y(()=>[v("div",ee,[c(r,{filename:"volume",series:o(n)},null,8,["series"]),c(h,{chart:o(s),target:o(i)},null,8,["chart","target"])])]),default:y(()=>[v("div",te,null,512)]),_:1},512)}}}),oe={style:{display:"flex"}},se={ref:"chartRef",class:"chart"},re=C({__name:"ChartPrice",props:{prices:{}},setup(l){const u=S(),i=P("card"),{chart:s,series:n}=w({createChartOptions:F(),series:D({name:"prices",color:p(()=>u.value.colors.purple),formatter:e=>`$${E(e,4,"dollar")}${L(e)}`,minMove:.001,autoscaleInfoProvider:()=>({priceRange:{minValue:Math.max(Math.min(...l.prices.map(e=>e.price)),.8),maxValue:Math.min(Math.max(...l.prices.map(e=>e.price)),1.2)}})})});T(_);function _(){if(!s.value||!n.prices)return;const e=l.prices.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.price})).uniqWith((t,r)=>t.time===r.time).orderBy(t=>t.time,"asc");e.length>0&&n.prices.setData(e),s.value.timeScale().fitContent()}return(e,t)=>{const r=x,h=k,d=B;return f(),$(d,{ref_key:"card",ref:i,title:"Price"},{actions:y(()=>[v("div",oe,[c(r,{filename:"tvl",series:o(n)},null,8,["series"]),c(h,{chart:o(s),target:o(i)},null,8,["chart","target"])])]),default:y(()=>[v("div",se,null,512)]),_:1},512)}}}),ne=C({__name:"Pool",props:{pool:{}},setup(l){const u=p(()=>{switch(l.pool){case"scrvusd":return"0xc522A6606BBA746d7960404F22a3DB936B6F4F50";case"sfrxusd":return"0xed785Af60bEd688baa8990cD5c4166221599A441";default:throw new Error(`Unknown pool: ${l.pool}`)}}),{isFetching:i,data:s}=Q(b(()=>({chain:"ethereum"}))),n=p(()=>{const a=l.pool==="scrvusd"?m=>m.crvusd:m=>m.frxusd;return(s.value?.prices??[]).map(m=>({timestamp:m.timestamp,price:a(m)}))}),{isFetching:_,data:e}=j(b(()=>"ethereum"),u),{isFetching:t,data:r}=z(b(()=>"ethereum"),u),{isFetching:h,data:d}=G(b(()=>"ethereum"),u.value),I=p(()=>e.value.map(a=>({timestamp:a.timestamp,volume:a.volume}))),U=p(()=>r.value.map(a=>({timestamp:a.timestamp,tvl:a.tvlUSD}))),M=p(()=>!d.value||r.value.length===0?[]:d.value.coins.map(a=>({symbol:a.symbol,balances:r.value.map(m=>({timestamp:m.timestamp,balance:m.balances[a.poolIndex],tokenPrice:m.tokenPrices[a.poolIndex]}))}))),V=p(()=>h.value||t.value);return(a,m)=>{const O=B;return f(),R(H,null,[v("div",{class:"title",style:g(`grid-area: title-${a.pool}`)}," Pool: "+N(a.pool),5),c(re,{style:g(`grid-area: price-${a.pool}`),prices:o(n),loading:o(i),"min-move":.001},null,8,["style","prices","loading"]),c(ae,{style:g(`grid-area: volume-${a.pool}`),volume:o(I),loading:o(_)},null,8,["style","volume","loading"]),c(Z,{style:g(`grid-area: tvl-${a.pool}`),tvl:o(U),loading:o(t)},null,8,["style","tvl","loading"]),o(V)?(f(),$(O,{key:1,loading:"",title:"Balances",style:g(`grid-area: balances-${a.pool}; min-height: ${o(K)}`)},null,8,["style"])):(f(),$(J,{key:0,style:g(`grid-area: balances-${a.pool}`),balances:o(M),loading:o(V)},null,8,["style","balances","loading"]))],64)}}}),W=A(ne,[["__scopeId","data-v-f1c10df2"]]),le={class:"dashboard"},ce=C({__name:"Stablecoin.page",setup(l){return(u,i)=>{const s=q;return f(),R("div",le,[c(s,{style:{"grid-area":"header"},title:"Stablecoin",description:"reUSD stablecoin metrics and liquidity pool analytics"}),c(W,{pool:"scrvusd"}),c(W,{pool:"sfrxusd"})])}}}),ye=A(ce,[["__scopeId","data-v-70317081"]]);export{ye as default};
