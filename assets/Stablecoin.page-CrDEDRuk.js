import{_ as q}from"./DashboardHeader-CMVhByqu.js";import{d as b,u as P,a as T,c as u,w,b as C,o as v,e as $,f as g,g as c,h as o,_ as S,t as B,j as A,aC as H,m as N,n as y,l as I}from"./index-DwSotjAb.js";import{a as j,b as z,c as G}from"./stablecoin-CQFHCPTo.js";import{_ as J}from"./ChartBalances-CT7zD_fR.js";import{u as D,c as F,a as k,_ as x,D as K}from"./UseLightweightChart-fT5MLJif.js";import{_ as E}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-DBJxZk61.js";import{r as L,u as V}from"./timestamp-BYVxXSJt.js";import{d as Q}from"./protocols-BopcUmaZ.js";import"./Tooltip-dGeKlIzS.js";import"./Pagination-vgbH7lYO.js";const X={style:{display:"flex"}},Y={ref:"chartRef",class:"chart"},Z=b({__name:"ChartTvl",props:{tvl:{}},setup(l){const m=P(),i=T("card"),{chart:s,series:n}=D({createChartOptions:k(),series:F({name:"tvl",color:u(()=>m.value.colors.blue),formatter:e=>`$${L(e,1,"dollar")}${V(e)}`})});w(_);function _(){if(!s.value||!n.tvl)return;const e=l.tvl.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.tvl})).uniqWith((t,r)=>t.time===r.time).orderBy(t=>t.time,"asc");e.length>0&&n.tvl.setData(e),s.value.timeScale().fitContent()}return(e,t)=>{const r=E,h=x,p=S;return v(),C(p,{ref_key:"card",ref:i,title:"TVL"},{actions:$(()=>[g("div",X,[c(r,{filename:"tvl",series:o(n)},null,8,["series"]),c(h,{chart:o(s),target:o(i)},null,8,["chart","target"])])]),default:$(()=>[g("div",Y,null,512)]),_:1},512)}}}),ee={style:{display:"flex"}},te={ref:"chartRef",class:"chart"},ae=b({__name:"ChartVolume",props:{volume:{}},setup(l){const m=P(),i=T("card"),{chart:s,series:n}=D({createChartOptions:k(),series:F({name:"volume",color:u(()=>m.value.colors.blue),formatter:e=>`$${L(e,1,"dollar")}${V(e)}`})});w(_);function _(){if(!s.value||!n.volume)return;const e=l.volume.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.volume})).uniqWith((t,r)=>t.time===r.time).orderBy(t=>t.time,"asc");e.length>0&&n.volume.setData(e),s.value.timeScale().fitContent()}return(e,t)=>{const r=E,h=x,p=S;return v(),C(p,{ref_key:"card",ref:i,title:"Volume"},{actions:$(()=>[g("div",ee,[c(r,{filename:"volume",series:o(n)},null,8,["series"]),c(h,{chart:o(s),target:o(i)},null,8,["chart","target"])])]),default:$(()=>[g("div",te,null,512)]),_:1},512)}}}),oe={style:{display:"flex"}},se={ref:"chartRef",class:"chart"},re=b({__name:"ChartPrice",props:{prices:{}},setup(l){const m=P(),i=T("card"),{chart:s,series:n}=D({createChartOptions:k(),series:F({name:"prices",color:u(()=>m.value.colors.purple),formatter:e=>`$${L(e,4,"dollar")}${V(e)}`,minMove:.001,autoscaleInfoProvider:()=>({priceRange:{minValue:Math.max(Math.min(...l.prices.map(e=>e.price)),.8),maxValue:Math.min(Math.max(...l.prices.map(e=>e.price)),1.2)}})})});w(_);function _(){if(!s.value||!n.prices)return;const e=l.prices.map(t=>({time:t.timestamp.getUTCTimestamp(),value:t.price})).uniqWith((t,r)=>t.time===r.time).orderBy(t=>t.time,"asc");e.length>0&&n.prices.setData(e),s.value.timeScale().fitContent()}return(e,t)=>{const r=E,h=x,p=S;return v(),C(p,{ref_key:"card",ref:i,title:"Price"},{actions:$(()=>[g("div",oe,[c(r,{filename:"tvl",series:o(n)},null,8,["series"]),c(h,{chart:o(s),target:o(i)},null,8,["chart","target"])])]),default:$(()=>[g("div",se,null,512)]),_:1},512)}}}),ne=b({__name:"Pool",props:{pool:{}},setup(l){const m=u(()=>{switch(l.pool){case"scrvusd":return"0xc522A6606BBA746d7960404F22a3DB936B6F4F50";case"sfrxusd":return"0xed785Af60bEd688baa8990cD5c4166221599A441";default:throw new Error(`Unknown pool: ${l.pool}`)}}),{isFetching:i,data:s}=Q(B(()=>({chain:"ethereum"}))),n=u(()=>{var f;const a=l.pool==="scrvusd"?d=>d.crvusd:d=>d.frxusd;return(((f=s.value)==null?void 0:f.prices)??[]).map(d=>({timestamp:d.timestamp,price:a(d)}))}),{isFetching:_,data:e}=j(B(()=>"ethereum"),m),{isFetching:t,data:r}=z(B(()=>"ethereum"),m),{isFetching:h,data:p}=G(B(()=>"ethereum"),m.value),U=u(()=>e.value.map(a=>({timestamp:a.timestamp,volume:a.volume}))),M=u(()=>r.value.map(a=>({timestamp:a.timestamp,tvl:a.tvlUSD}))),O=u(()=>!p.value||r.value.length===0?[]:p.value.coins.map(a=>({symbol:a.symbol,balances:r.value.map(f=>({timestamp:f.timestamp,balance:f.balances[a.poolIndex],tokenPrice:f.tokenPrices[a.poolIndex]}))}))),W=u(()=>h.value||t.value);return(a,f)=>{const d=S;return v(),A(H,null,[g("div",{class:"title",style:y(`grid-area: title-${a.pool}`)}," Pool: "+N(a.pool),5),c(re,{style:y(`grid-area: price-${a.pool}`),prices:o(n),loading:o(i),"min-move":.001},null,8,["style","prices","loading"]),c(ae,{style:y(`grid-area: volume-${a.pool}`),volume:o(U),loading:o(_)},null,8,["style","volume","loading"]),c(Z,{style:y(`grid-area: tvl-${a.pool}`),tvl:o(M),loading:o(t)},null,8,["style","tvl","loading"]),o(W)?(v(),C(d,{key:1,loading:"",title:"Balances",style:y(`grid-area: balances-${a.pool}; min-height: ${o(K)}`)},null,8,["style"])):(v(),C(J,{key:0,style:y(`grid-area: balances-${a.pool}`),balances:o(O),loading:o(W)},null,8,["style","balances","loading"]))],64)}}}),R=I(ne,[["__scopeId","data-v-f1c10df2"]]),le={class:"dashboard"},ce=b({__name:"Stablecoin.page",setup(l){return(m,i)=>{const s=q;return v(),A("div",le,[c(s,{style:{"grid-area":"header"},title:"Stablecoin",description:"reUSD stablecoin metrics and liquidity pool analytics"}),c(R,{pool:"scrvusd"}),c(R,{pool:"sfrxusd"})])}}}),ye=I(ce,[["__scopeId","data-v-70317081"]]);export{ye as default};
