import{a as G,_ as H}from"./TabItem.vue_vue_type_script_setup_true_lang-CV4YwKbP.js";import{_ as q}from"./DashboardHeader-BnQW4vtJ.js";import{_ as K}from"./KPI-BvN3V6VI.js";import{_ as D}from"./AsyncValue-72I0koFs.js";import{b as j,c as M,a as J}from"./protocols-DqBE4PL0.js";import{d as P,u as Q,a as X,c as f,w as Y,b as g,o as m,e as u,f as h,g as a,h as t,_ as R,aD as Z,ar as ee,l as $,t as te,aE as oe,m as L,k as A,j as F,aF as ae,aG as ne,aA as se,av as re,aH as le,aI as k,an as N}from"./index-BDFWrBCq.js";import{u as ie,_ as ce}from"./UseLegend-Dgt-_x-t.js";import{u as ue,c as de,G as me,r as pe,a as _e,_ as ve}from"./UseLightweightChart-Ctl-uUfg.js";import{_ as ge}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-CSBUjxzr.js";import{r as I,u as S}from"./timestamp-DTASjiY2.js";import{_ as he}from"./Table-KuCRwqam.js";import{_ as fe}from"./TokenIcon-D3JKa7Jx.js";import{u as be,_ as ye}from"./UsePagination-rVZ9jNJ6.js";import{p as B}from"./util-CVNQ9WdU.js";import{u as Ce}from"./UseSort-DUPgjSCn.js";import{u as we}from"./UseTabNavigation-c6i3J36E.js";import"./Tooltip-Dgclb_Dm.js";import"./Pagination-vgbH7lYO.js";import"./index-C9rrvHVv.js";const Pe={style:{display:"flex"}},Te={ref:"chartRef",class:"chart"},$e=P({__name:"ChartTvl",props:{tvl:{}},setup(d){const l=Q(),{items:_,toggles:s,disabled:b}=ie(()=>[{id:"underlying",label:"Underlying",color:l.value.colorsArray[0],togglable:!0},{id:"debt",label:"Debt",color:l.value.colorsArray[1],togglable:!0}]),c=X("card"),{chart:p,series:i}=ue({createChartOptions:_e(),series:[de({name:"underlying",color:f(()=>l.value.colors.blue),formatter:e=>`$${I(e,1,"dollar")}${S(e)}`}),{type:me,name:"debt",options:f(()=>({priceFormat:{type:"custom",formatter:e=>`$${I(e,1,"dollar")}${S(e)}`},lineWidth:2,lineType:pe.WithSteps,color:l.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});Y(r);function r(){!p.value||!i.underlying||!i.debt||(i.underlying.setData(d.tvl.map(e=>({time:e.timestamp.getUTCTimestamp(),value:e.underlying})).uniqWith((e,n)=>e.time===n.time).orderBy(e=>e.time,"asc")),i.debt.setData(d.tvl.map(e=>({time:e.timestamp.getUTCTimestamp(),value:e.debt})).uniqWith((e,n)=>e.time===n.time).orderBy(e=>e.time,"asc")),i.underlying.applyOptions({visible:s.underlying.value}),i.debt.applyOptions({visible:s.debt.value}),p.value.timeScale().fitContent())}return(e,n)=>{const v=ge,w=ve,o=ce,y=R;return m(),g(y,{ref_key:"card",ref:c,title:"TVL"},{actions:u(()=>[h("div",Pe,[a(v,{filename:"tvl",series:t(i)},null,8,["series"]),a(w,{chart:t(p),target:t(c)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[a(o,{items:t(_),disabled:t(b),onToggle:n[0]||(n[0]=T=>t(s)[T].value=!t(s)[T].value)},null,8,["items","disabled"])]),default:u(()=>[h("div",Te,null,512)]),_:1},512)}}}),xe=P({__name:"IconExpander",props:{expanded:{type:Boolean,default:!1}},setup(d){return(l,_)=>{const s=Z;return m(),g(s,{class:ee(["expander",{expanded:l.expanded}])},null,8,["class"])}}}),Le=$(xe,[["__scopeId","data-v-7caf48cb"]]),ke={class:"token"},Ne={class:"end",style:{display:"flex",gap:"1ch"}},Ie={class:"end"},Se={class:"end"},U=20,Be=P({__name:"TablePairs",props:{protocolName:{}},setup(d){const{isFetching:l,data:_}=j(te(()=>({chain:"ethereum",protocol_name:d.protocolName||""})),f(()=>!!d.protocolName)),s=f(()=>{var o;return(o=_.value)==null?void 0:o.filter(y=>y.borrowLimit>0)}),b=["","",{id:"name",label:"Name",sort:!0},{id:"tvl",label:"TVL",sort:!0,align:"end"},{id:"rate",label:"Interest Rate",sort:!0,align:"end"},{id:"util",label:"Util",sort:!0,align:"end"}],{sorting:c,onSort:p}=Ce("tvl"),i=f(()=>(s.value??[]).orderBy(o=>{switch(c.value.column){case"name":return B(o.name);case"tvl":return o.totalUnderlying;case"rate":return o.interestRate;case"util":return o.utilizationRate}},c.value.order)),{page:r,rowsPage:e,onPage:n}=be(i,U),v=oe(),w=async o=>{var y;await v.push({name:"pair",params:{protocolName:(y=d.protocolName)==null?void 0:y.toLocaleLowerCase(),pairId:o.pairId.toString()}})};return(o,y)=>{const T=ye,z=Le,E=fe,x=D,W=he,O=R;return m(),g(O,{title:"Pairs",loading:t(l)},{actions:u(()=>[a(T,{"items-count":t(i).length,"items-per-page":U,page:t(r),onPage:t(n)},null,8,["items-count","page","onPage"])]),default:u(()=>[a(W,{class:"pairs-table",rows:t(e),columns:b,sorting:t(c),onSortColumn:t(p),onSelect:w},{row:u(({item:C})=>[a(z),h("div",ke,[(m(),g(E,{key:C.tokenPairCollateral.symbol,chain:"ethereum",address:C.tokenPairCollateral.address},null,8,["address"]))]),h("div",null,L(t(B)(C.name)),1),h("div",Ne,[a(x,{"show-zero":"",type:"dollar",value:C.totalUnderlying,precision:2,"show-symbol":!1},null,8,["value"]),A(" "+L(C.tokenPairUnderyling.symbol),1)]),h("div",Ie,[a(x,{"show-zero":"",type:"percentage",value:C.aprBorrowCost,precision:2},null,8,["value"])]),h("div",Se,[a(x,{"show-zero":"",type:"percentage",value:C.utilizationRate,precision:2},null,8,["value"])])]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),Ue=$(Be,[["__scopeId","data-v-ac713c9b"]]),Ve={class:"dashboard-grid root"},De={class:"kpis"},Re={class:"dashboard-grid charts"},Ae=P({__name:"Protocol",props:{protocol:{}},setup(d){const{isFetching:l,data:_}=M({chain:"ethereum"}),s=f(()=>{var r;return(((r=_.value)==null?void 0:r.protocols)??[]).find(e=>e.name.toLocaleLowerCase()===d.protocol)}),{isFetching:b,data:c}=J({chain:"ethereum"}),p=f(()=>{var r;return(((r=c.value)==null?void 0:r.snapshots)??[]).filter(e=>e.name.toLocaleLowerCase()===d.protocol).groupBy(e=>e.timestamp.getTime()).entries()}),i=f(()=>p.value.flatMap(([,r])=>({timestamp:r[0].timestamp,underlying:r.reduce((e,n)=>e+n.totalUnderlying,0),debt:r.reduce((e,n)=>e+n.totalDebt,0)})));return(r,e)=>{var w;const n=D,v=K;return m(),F("div",Ve,[h("div",De,[a(v,{label:"Pairs","has-value":!t(l)},{default:u(()=>{var o;return[a(n,{value:(o=t(s))==null?void 0:o.pairsCount,precision:0},null,8,["value"])]}),_:1},8,["has-value"]),a(v,{label:"Total collateral","has-value":!t(l)},{default:u(()=>{var o;return[a(n,{type:"dollar",value:(o=t(s))!=null&&o.totalUnderlying?t(s).totalUnderlying:void 0,precision:2},null,8,["value"])]}),_:1},8,["has-value"]),a(v,{label:"Total debt","has-value":!t(l)},{default:u(()=>{var o;return[a(n,{value:(o=t(s))==null?void 0:o.totalDebt,precision:0},null,8,["value"]),e[0]||(e[0]=A(" reUSD "))]}),_:1,__:[0]},8,["has-value"])]),a(Ue,{"protocol-name":(w=t(s))==null?void 0:w.name},null,8,["protocol-name"]),h("div",Re,[a($e,{style:{"grid-area":"chart-tvl"},tvl:t(i),loading:t(b)},null,8,["tvl","loading"])])])}}}),V=$(Ae,[["__scopeId","data-v-c77b921b"]]),Fe={key:1,class:"dashboard"},ze=P({__name:"Protocols.page",setup(d){const{tabActive:l,tabActiveIndex:_}=we(["curvelend","fraxlend"],"protocols",void 0,{tabParamName:"protocolName"}),{crumbs:s}=ae(ne()),b=se();return re(()=>b.name,c=>{c!=="pair"&&(s.value=[{id:"protocols",label:"Protocols",pathName:"protocols"}])},{immediate:!0}),(c,p)=>{const i=le("router-view"),r=q,e=G,n=H;return c.$route.name==="pair"?(m(),g(i,{key:0})):(m(),F("div",Fe,[a(r,{style:{"grid-area":"header"},title:"Protocols",description:"Lending markets metrics for Curve Lend and Frax Lend protocols"}),a(n,{active:t(_),onTab:p[0]||(p[0]=v=>_.value=v.index)},{default:u(()=>[a(e,{header:"Curve Lend"},{default:u(()=>[(m(),g(k,null,[t(l)==="curvelend"?(m(),g(V,{key:0,protocol:"curvelend"})):N("",!0)],1024))]),_:1}),a(e,{header:"Frax Lend"},{default:u(()=>[(m(),g(k,null,[t(l)==="fraxlend"?(m(),g(V,{key:0,protocol:"fraxlend"})):N("",!0)],1024))]),_:1})]),_:1},8,["active"])]))}}}),st=$(ze,[["__scopeId","data-v-90d9b0e2"]]);export{st as default};
