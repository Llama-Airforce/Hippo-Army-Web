import{a as he,_ as fe}from"./TabItem.vue_vue_type_script_setup_true_lang-BMmvivUn.js";import{am as S,aJ as Z,d as C,at as ee,av as z,b as v,o as m,_ as I,e as b,an as q,f as _,m as w,j as P,g as i,k as L,aw as E,h as n,l as D,ai as te,c as $,t as O,ao as Y,u as ce,a as ue,w as pe,n as ye,aF as $e,aG as Ce,ay as De,aI as H}from"./index-DI-_SjLK.js";import{b as we}from"./protocols-Dpgppd_T.js";import{p as ke}from"./util-CVNQ9WdU.js";import{_ as Re,o as y,s as c,b as A,n as g,t as W,k as X,p as j,d as G,h as U,g as B,i as J,f as x,a as N,j as Pe,r as k,u as R}from"./timestamp-CM3_kXC8.js";import{p as Fe}from"./Pagination-vgbH7lYO.js";import{_ as ae}from"./NoData-zHgHapin.js";import{_ as se}from"./Table-BB2e66VV.js";import{_ as V}from"./AsyncValue-DBJZfHef.js";import{a as oe,_ as re}from"./UsePagination-BG1X7B9b.js";import{u as ne}from"./UseRelativeTime-BWKH3rW4.js";import{_ as le}from"./ChartApex-OPqTXW4P.js";import{c as ie}from"./ChartStylesApex-CmfbRoYi.js";import{_ as Q}from"./KPI-D8-nCjKW.js";import{_ as qe}from"./ChartBalances-CQ4pgoF4.js";import{u as me,c as _e,a as be,_ as ge,D as Te}from"./UseLightweightChart-DoaEjcAr.js";import{_ as ve}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-DYmAZovD.js";import{T as Le,u as Ie}from"./UseTabNavigation-CuWRSTF3.js";import{a as de}from"./index-KMornB4x.js";import"./Tooltip-BRnUACQp.js";const Se=Re(["borrow","add_collateral","remove_collateral","repay","redeem","liquidate","leveraged_position","repay_with_collateral"]),Ae=y({token_address:c(),token_symbol:c(),apr:c()}).transform(e=>({tokenAddress:e.token_address,tokenSymbol:e.token_symbol,apr:parseFloat(e.apr)})),Ue=y({date_timestamp:g(),total_collateral:c(),total_underlying:c(),exchange_rate:c(),total_debt:c(),active_positions_count:g(),borrow_limit:c(),utilization_rate:c(),interest_rate:c(),claimable_fees:c(),claimable_other_fees:c(),borrow_cost_apr:c(),base_apr:c(),rewards:A(Ae)}).transform(e=>({time:W(e.date_timestamp),totalCollateral:parseFloat(e.total_collateral),totalUnderlying:parseFloat(e.total_underlying),exchangeRate:parseFloat(e.exchange_rate),totalDebt:parseFloat(e.total_debt),activePositionsCount:e.active_positions_count,borrowLimit:parseFloat(e.borrow_limit),utilizationRate:parseFloat(e.utilization_rate),interestRate:parseFloat(e.interest_rate),claimableFees:parseFloat(e.claimable_fees),claimableOtherFees:parseFloat(e.claimable_other_fees),aprBorrowCost:parseFloat(e.borrow_cost_apr),aprBase:parseFloat(e.base_apr),rewards:e.rewards})),Be=y({snapshots:A(Ue),count:g(),page:g(),total_pages:g()}).transform(e=>({snapshots:e.snapshots,count:e.count,page:e.page,totalPages:e.total_pages})),xe=y({event_type:Se,block_timestamp:g(),tx_hash:c(),block_number:g(),collateral_change:c(),debt_change:c()}).transform(e=>({eventType:e.event_type,blockTime:W(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,collateralChange:parseFloat(e.collateral_change),debtChange:parseFloat(e.debt_change)})),Ne=y({events:A(xe),count:g(),page:g(),total_pages:g()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),Ke=y({block_timestamp:g(),tx_hash:c(),block_number:g(),caller:X,amount:c(),collateral_freed:c(),protocol_fee:c(),debt_reduction:c()}).transform(e=>({blockTime:W(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,caller:e.caller,amount:parseFloat(e.amount),collateralFreed:parseFloat(e.collateral_freed),protocolFee:parseFloat(e.protocol_fee),debtReduction:parseFloat(e.debt_reduction)})),Me=y({events:A(Ke),count:g(),page:g(),total_pages:g()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),Ve=y({block_timestamp:g(),tx_hash:c(),block_number:g(),borrower:X,liquidator:X,collateral_for_liquidator:c(),shares_liquidated:c(),amount_liquidator_to_repay:c()}).transform(e=>({blockTime:W(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,borrower:e.borrower,liquidator:e.liquidator,collateralForLiquidator:parseFloat(e.collateral_for_liquidator),sharesLiquidated:parseFloat(e.shares_liquidated),amountLiquidatorToRepay:parseFloat(e.amount_liquidator_to_repay)})),Ee=y({events:A(Ve),count:g(),page:g(),total_pages:g()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),He=y({...U,...G,...j});async function Oe(e,a){const l=B(a),{pair_id:s,...t}=He.parse(e),r=J(t),o=await x(`${l}/v1/pairs/${s}/snapshots${r}`,void 0,a?.signal);return Be.parse(o)}const ze=y({...U,...G,...j});async function We(e,a){const l=B(a),{pair_id:s,...t}=ze.parse(e),r=J(t),o=await x(`${l}/v1/pairs/${s}/collateral_events${r}`,void 0,a?.signal);return Ne.parse(o)}const je=y({...U,...G,...j});async function Ge(e,a){const l=B(a),{pair_id:s,...t}=je.parse(e),r=J(t),o=await x(`${l}/v1/pairs/${s}/redemptions${r}`,void 0,a?.signal);return Me.parse(o)}const Je=y({...U,...G,...j});async function Qe(e,a){const l=B(a),{pair_id:s,...t}=Je.parse(e),r=J(t),o=await x(`${l}/v1/pairs/${s}/liquidations${r}`,void 0,a?.signal);return Ee.parse(o)}function Ye(e){const{start:a,end:l}=Pe({daysRange:90});return N({queryKey:["pairs-snapshots",e],queryFn:()=>Fe((t,r)=>Oe({...S(e),page:t,per_page:r,start:a,end:l}).then(o=>o.snapshots),1,100)})}function Xe(e){return N({queryKey:["pairs-collateral-events",e],queryFn:()=>We(S(e)),placeholderData:Z})}function Ze(e){return N({queryKey:["pairs-redemptions",e],queryFn:()=>Ge(S(e)),placeholderData:Z})}function et(e){return N({queryKey:["pairs-liquidations",e],queryFn:()=>Qe(S(e)),placeholderData:Z})}const tt={class:"end"},at={key:0,style:{display:"flex",gap:"1ch"}},st={class:"end"},ot={key:0,style:{display:"flex",gap:"1ch"}},rt={class:"end"},nt=["href"],lt=C({__name:"TableCollateralEvents",props:{events:{},count:{},pair:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:a}){const l=a,{page:s,onPage:t}=oe(),r=ee(s,200);z(r,u=>{l("page",u)});const{relativeTime:o}=ne(),d=u=>{switch(u.eventType){case"add_collateral":return"Add collateral";case"borrow":return"Borrow";case"remove_collateral":return"Remove collateral";case"repay":return"Repay";case"redeem":return"Redeem";case"liquidate":return"Liquidate";case"leveraged_position":return"Lev. position";case"repay_with_collateral":return"Repay with col"}};return(u,p)=>{const h=re,T=V,F=se,K=ae,f=I;return m(),v(f,{title:"Events"},{actions:b(()=>[i(h,{"items-count":u.count,"items-per-page":10,page:n(s),onPage:n(t)},null,8,["items-count","page","onPage"])]),default:b(()=>[e.events.length>0?(m(),v(F,{key:0,rows:e.events,columns:["Type",{label:"Δ Debt",align:"end"},{label:"Δ Collateral",align:"end"},{label:"Time",align:"end"}]},{row:b(({item:M})=>[_("div",null,w(d(M)),1),_("div",tt,[M.debtChange!==0?(m(),P("div",at,[i(T,{type:"dollar",value:M.debtChange/10**18,precision:2,"show-symbol":!1},null,8,["value"]),L(" "+w(u.pair.tokenDebt.symbol),1)])):q("",!0)]),_("div",st,[M.collateralChange!==0?(m(),P("div",ot,[i(T,{type:"dollar",value:M.collateralChange/10**18,precision:2,"show-symbol":!1},null,8,["value"]),L(" "+w(u.pair.tokenCollateral.symbol),1)])):q("",!0)]),_("div",rt,[_("a",{target:"_blank",href:`https://etherscan.io/tx/${M.txHash}`,onClick:p[0]||(p[0]=E(()=>{},["stop"]))},w(n(o)(M.blockTime.getUTCTimestamp())),9,nt)])]),_:1},8,["rows"])):u.loading?q("",!0):(m(),v(K,{key:1,message:"There are no events"}))]),_:1})}}}),it=D(lt,[["__scopeId","data-v-f018f232"]]),dt={class:"dashboard-grid"},ct=C({__name:"Collateral",props:{pair:{}},setup(e){const a=te(1),{isFetching:l,data:s}=Xe($(()=>({pair_id:e.pair.pairId,page:a.value,per_page:15})));return(t,r)=>(m(),P("div",dt,[i(it,{events:n(s)?.events??[],count:n(s)?.count??0,loading:n(l),pair:t.pair,onPage:r[0]||(r[0]=o=>a.value=o)},null,8,["events","count","loading","pair"])]))}}),ut=D(ct,[["__scopeId","data-v-ff086716"]]),pt=y({range_label:c(),user_count:g(),total_debt:c()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),mt=y({bins:A(pt),total_users:g(),total_debt:c(),min_ratio:c(),max_ratio:c(),median_ratio:c()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),minRatio:parseFloat(e.min_ratio),maxRatio:parseFloat(e.max_ratio),medianRatio:parseFloat(e.median_ratio)})),_t=y({range_label:c(),user_count:g(),total_debt:c()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),bt=y({bins:A(_t),total_users:g(),total_debt:c(),min_debt:c(),max_debt:c(),median_debt:c()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),minDebt:parseFloat(e.min_debt),maxDebt:parseFloat(e.max_debt),medianDebt:parseFloat(e.median_debt)})),gt=y({leveraged_users_count:g(),non_leveraged_users_count:g(),leveraged_debt:c(),non_leveraged_debt:c(),total_users:g(),total_debt:c(),leveraged_users_percentage:c(),leveraged_debt_percentage:c()}).transform(e=>({leveragedUsersCount:e.leveraged_users_count,nonLeveragedUsersCount:e.non_leveraged_users_count,leveragedDebt:parseFloat(e.leveraged_debt),nonLeveragedDebt:parseFloat(e.non_leveraged_debt),totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt),leveragedUsersPercentage:parseFloat(e.leveraged_users_percentage),leveragedDebtPercentage:parseFloat(e.leveraged_debt_percentage)})),vt=y({stats:gt}).transform(e=>({stats:e.stats})),ht=y({range_label:c(),user_count:g(),total_debt:c()}).transform(e=>({rangeLabel:e.range_label,userCount:e.user_count,totalDebt:parseFloat(e.total_debt)})),ft=y({bins:A(ht),total_users:g(),total_debt:c()}).transform(e=>({bins:e.bins,totalUsers:e.total_users,totalDebt:parseFloat(e.total_debt)})),yt=y(U);async function $t(e,a){const l=B(a),{pair_id:s}=yt.parse(e),t=await x(`${l}/v1/health/${s}/leverage_stats`,void 0,a?.signal);return vt.parse(t)}const Ct=y(U);async function Dt(e,a){const l=B(a),{pair_id:s}=Ct.parse(e),t=await x(`${l}/v1/health/${s}/leverage_distribution`,void 0,a?.signal);return ft.parse(t)}const wt=y(U);async function kt(e,a){const l=B(a),{pair_id:s}=wt.parse(e),t=await x(`${l}/v1/health/${s}/debt_distribution`,void 0,a?.signal);return bt.parse(t)}const Rt=y(U);async function Pt(e,a){const l=B(a),{pair_id:s}=Rt.parse(e),t=await x(`${l}/v1/health/${s}/collateral_ratio_distribution`,void 0,a?.signal);return mt.parse(t)}function Ft(e){return N({queryKey:["health-leverage-stats",e],queryFn:()=>$t(S(e))})}function qt(e){return N({queryKey:["health-leverage-distribution",e],queryFn:()=>Dt(S(e))})}function Tt(e){return N({queryKey:["health-debt-distribution",e],queryFn:()=>kt(S(e))})}function Lt(e){return N({queryKey:["health-collateral-ratio-distribution",e],queryFn:()=>Pt(S(e))})}const It=C({__name:"ChartCollateralRatioDistribution",props:{data:{}},setup(e){const a=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1},stacked:!1},xaxis:{categories:l.value,labels:{formatter:t=>t,rotate:-30,offsetY:10,rotateAlways:!0},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${k(t,0,"dollar")}${R(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const r=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${l.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${r}</div>
                <div><b>Debt:</b></div><div>$${k(o,2,"dollar")}${R(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${k(o/r,2,"dollar")}${R(o/r)}</div>
                </div>`}},legend:{show:!0}})),l=$(()=>(e.data?.bins??[]).map(t=>{const[r,o]=t.rangeLabel.split(" - ").map(parseFloat),d=`${Math.round(r*100)}%`,u=`${Math.round(o*100)}%`;return`${d} - ${u}`})),s=$(()=>[{name:"Users",type:"column",data:(e.data?.bins??[]).map(t=>t.userCount)},{name:"Debt",type:"line",data:(e.data?.bins??[]).map(t=>t.totalDebt)}]);return(t,r)=>{const o=le,d=I;return m(),v(d,null,{default:b(()=>[i(o,{options:n(a),series:n(s)},null,8,["options","series"])]),_:1})}}}),St=D(It,[["__scopeId","data-v-022e67af"]]),At=C({__name:"ChartDebtDistribution",props:{data:{}},setup(e){const a=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1},stacked:!1},xaxis:{categories:l.value,labels:{formatter:t=>t,rotate:-30,offsetY:10,rotateAlways:!0},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${k(t,0,"dollar")}${R(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const r=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${l.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${r}</div>
                <div><b>Debt:</b></div><div>$${k(o,2,"dollar")}${R(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${k(o/r,2,"dollar")}${R(o/r)}</div>
                </div>`}},legend:{show:!0}})),l=$(()=>(e.data?.bins??[]).map(t=>{const[r,o]=t.rangeLabel.split(" - ").map(parseFloat),d=`$${k(r,0,"dollar")}${R(r)}`,u=`$${k(o,0,"dollar")}${R(o)}`;return`${d} - ${u}`})),s=$(()=>[{name:"Users",type:"column",data:(e.data?.bins??[]).map(t=>t.userCount)},{name:"Debt",type:"line",data:(e.data?.bins??[]).map(t=>t.totalDebt)}]);return(t,r)=>{const o=le,d=I;return m(),v(d,null,{default:b(()=>[i(o,{options:n(a),series:n(s)},null,8,["options","series"])]),_:1})}}}),Ut=D(At,[["__scopeId","data-v-73ee7851"]]),Bt=C({__name:"ChartLeverageDistribution",props:{data:{}},setup(e){const a=$(()=>ie({chart:{type:"bar",animations:{enabled:!1},zoom:{enabled:!1}},xaxis:{categories:l.value,labels:{formatter:t=>t,rotate:-30},tickPlacement:"on"},yaxis:[{title:{text:"Users"},labels:{formatter:t=>t}},{opposite:!0,title:{text:"Total Debt ($)"},labels:{formatter:t=>`$${k(t,0,"dollar")}${R(t)}`}}],plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:t=>{const r=t.series[0][t.dataPointIndex],o=t.series[1][t.dataPointIndex];return`<div style="display: grid; grid-template-columns: auto 1fr; gap: 1ch; align-items: center;">
                <div><b>Range:</b></div><div>${l.value[t.dataPointIndex]}</div>
                <div><b>Users:</b></div><div>${r}</div>
                <div><b>Debt:</b></div><div>$${k(o,2,"dollar")}${R(o)}</div>
                <div><b>Avg Debt/User:</b></div><div>$${k(o/r,2,"dollar")}${R(o/r)}</div>
                </div>`}},legend:{show:!0}})),l=$(()=>(e.data?.bins??[]).map(t=>t.rangeLabel)),s=$(()=>[{name:"Users",type:"column",data:(e.data?.bins??[]).map(t=>t.userCount)},{name:"Debt",type:"line",data:(e.data?.bins??[]).map(t=>t.totalDebt)}]);return(t,r)=>{const o=le,d=I;return m(),v(d,null,{default:b(()=>[i(o,{options:n(a),series:n(s)},null,8,["options","series"])]),_:1})}}}),xt=D(Bt,[["__scopeId","data-v-80deb86d"]]),Nt={class:"kpis"},Kt={class:"kpi-subvalue"},Mt=C({__name:"CollateralRatioKPIs",props:{collateralRatio:{}},setup(e){const a=$(()=>{if(!e.collateralRatio||e.collateralRatio.bins.length===0)return;const l=[...e.collateralRatio.bins].sort((o,d)=>d.userCount-o.userCount)[0],[s,t]=l.rangeLabel.split(" - ").map(parseFloat);return{range:`${Math.round(s*100)}% - ${Math.round(t*100)}%`,users:l.userCount}});return(l,s)=>{const t=V,r=Q;return m(),P("div",Nt,[i(r,{label:"Median Collateral Ratio","has-value":!!l.collateralRatio?.medianRatio},{default:b(()=>[i(t,{type:"percentage",value:l.collateralRatio?.medianRatio?l.collateralRatio.medianRatio*100:"?",precision:2},null,8,["value"])]),_:1},8,["has-value"]),i(r,{label:"Most Common Collateral Ratio","has-value":!!n(a)},{default:b(()=>[_("div",null,w(n(a)?.range??"N/A"),1),_("div",Kt,[i(t,{value:n(a)?.users??"?",precision:0},null,8,["value"]),s[0]||(s[0]=L(" users "))])]),_:1},8,["has-value"])])}}}),Vt=D(Mt,[["__scopeId","data-v-cd75baa0"]]),Et={class:"kpis"},Ht=C({__name:"DebtKPIs",props:{debt:{}},setup(e){return(a,l)=>{const s=V,t=Q;return m(),P("div",Et,[i(t,{label:"Max Debt","has-value":!!a.debt?.maxDebt},{default:b(()=>[i(s,{type:"dollar",value:a.debt?.maxDebt,precision:2,"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"]),i(t,{label:"Median Debt","has-value":!!a.debt?.medianDebt},{default:b(()=>[i(s,{type:"dollar",value:a.debt?.medianDebt,precision:2,"show-symbol":!1},null,8,["value"])]),_:1},8,["has-value"])])}}}),Ot=D(Ht,[["__scopeId","data-v-8ffe283b"]]),zt={class:"kpis"},Wt={class:"kpi-subvalue"},jt={class:"kpi-subvalue"},Gt={class:"kpi-subvalue"},Jt={class:"kpi-subvalue"},Qt=C({__name:"LeverageKPIs",props:{leverage:{},leverageStats:{}},setup(e){const a=$(()=>{if(!e.leverage||e.leverage.bins.length===0)return;const s=[...e.leverage.bins].sort((t,r)=>r.userCount-t.userCount)[0];return{range:s.rangeLabel,users:s.userCount}}),l=$(()=>{if(!e.leverage||e.leverage.bins.length===0)return;const s=[...e.leverage.bins].sort((t,r)=>r.totalDebt-t.totalDebt)[0];return{range:s.rangeLabel,debt:s.totalDebt}});return(s,t)=>{const r=V,o=Q;return m(),P("div",zt,[i(o,{label:"Most Common Range","has-value":!!n(a)},{default:b(()=>[_("div",null,w(n(a)?.range??"N/A"),1),_("div",Wt,[i(r,{value:n(a)?.users??"?",precision:0},null,8,["value"]),t[0]||(t[0]=L(" users "))])]),_:1},8,["has-value"]),i(o,{label:"Highest Debt Range","has-value":!!n(l)},{default:b(()=>[_("div",null,w(n(l)?.range),1),_("div",jt,[i(r,{type:"dollar",value:n(l)?.debt,precision:2},null,8,["value"])])]),_:1},8,["has-value"]),i(o,{label:"Leveraged Users","has-value":!!s.leverageStats?.stats},{default:b(()=>[i(r,{value:s.leverageStats?.stats.leveragedUsersCount,precision:0},null,8,["value"]),_("div",Gt,[i(r,{type:"percentage",value:s.leverageStats?.stats.leveragedUsersPercentage,precision:2},null,8,["value"]),t[1]||(t[1]=L(" of total "))])]),_:1},8,["has-value"]),i(o,{label:"Leveraged Debt","has-value":!!s.leverageStats?.stats},{default:b(()=>[i(r,{type:"dollar",value:s.leverageStats?.stats.leveragedDebt,precision:2,"show-symbol":!1},null,8,["value"]),_("div",Jt,[i(r,{type:"percentage",value:s.leverageStats?.stats.leveragedDebtPercentage,precision:2},null,8,["value"]),t[2]||(t[2]=L(" of total "))])]),_:1},8,["has-value"])])}}}),Yt=D(Qt,[["__scopeId","data-v-ae4a0874"]]),Xt={class:"dashboard-grid"},Zt=C({__name:"Health",props:{pair:{}},setup(e){const{isFetching:a,data:l}=qt(O(()=>({pair_id:e.pair.pairId}))),{isFetching:s,data:t}=Tt(O(()=>({pair_id:e.pair.pairId}))),{data:r}=Ft(O(()=>({pair_id:e.pair.pairId}))),{isFetching:o,data:d}=Lt(O(()=>({pair_id:e.pair.pairId})));return(u,p)=>(m(),P("div",Xt,[p[0]||(p[0]=_("div",{style:{"grid-area":"title-leverage-distribution"},class:"title"}," Leverage Distribution ",-1)),i(Yt,{style:{"grid-area":"kpis-leverage"},leverage:n(l),"leverage-stats":n(r)},null,8,["leverage","leverage-stats"]),i(xt,{style:{"grid-area":"chart-leverage-distribution"},data:n(l),loading:n(a)},null,8,["data","loading"]),p[1]||(p[1]=_("div",{style:{"grid-area":"title-debt-distribution"},class:"title"}," Debt Distribution ",-1)),i(Ot,{style:{"grid-area":"kpis-debt"},debt:n(t)},null,8,["debt"]),i(Ut,{style:{"grid-area":"chart-debt-distribution"},data:n(t),loading:n(s)},null,8,["data","loading"]),p[2]||(p[2]=_("div",{style:{"grid-area":"title-collateral-ratio-distribution"},class:"title"}," Collateral Ratio Distribution ",-1)),i(Vt,{style:{"grid-area":"kpis-collateral-ratio"},"collateral-ratio":n(d)},null,8,["collateral-ratio"]),i(St,{style:{"grid-area":"chart-collateral-ratio-distribution"},data:n(d),loading:n(o)},null,8,["data","loading"])]))}}),ea=D(Zt,[["__scopeId","data-v-aa4d047e"]]),ta=["href"],aa=["href"],sa={class:"end"},oa={class:"end"},ra={class:"end"},na={class:"end"},la=["href"],ia=C({__name:"TableLiquidations",props:{liquidations:{},count:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:a}){const l=a,{page:s,onPage:t}=oe(),r=ee(s,200);z(r,d=>{l("page",d)});const{relativeTime:o}=ne();return(d,u)=>{const p=re,h=V,T=se,F=ae,K=I;return m(),v(K,{title:"Liquidations"},{actions:b(()=>[i(p,{"items-count":d.count,"items-per-page":10,page:n(s),onPage:n(t)},null,8,["items-count","page","onPage"])]),default:b(()=>[e.liquidations.length>0?(m(),v(T,{key:0,rows:e.liquidations,columns:["Borrower","Liquidator",{label:"Shares liquidated",align:"end"},{label:"Collat for liquidator",align:"end"},{label:"Amount to repay (reUSD)",align:"end"},{label:"Time",align:"end"}]},{row:b(({item:f})=>[_("div",null,[_("a",{target:"_blank",href:`https://etherscan.io/address/${f.borrower}`,onClick:u[0]||(u[0]=E(()=>{},["stop"]))},w(f.borrower.ens||("addressShort"in d?d.addressShort:n(Y))(f.borrower.address)),9,ta)]),_("div",null,[_("a",{target:"_blank",href:`https://etherscan.io/address/${f.liquidator}`,onClick:u[1]||(u[1]=E(()=>{},["stop"]))},w(f.liquidator.ens||("addressShort"in d?d.addressShort:n(Y))(f.liquidator.address)),9,aa)]),_("div",sa,[i(h,{type:"dollar",value:f.sharesLiquidated/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),_("div",oa,[i(h,{type:"dollar",value:f.collateralForLiquidator/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),_("div",ra,[i(h,{type:"dollar",value:f.amountLiquidatorToRepay/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),_("div",na,[_("a",{target:"_blank",href:`https://etherscan.io/tx/${f.txHash}`,onClick:u[2]||(u[2]=E(()=>{},["stop"]))},w(n(o)(f.blockTime.getUTCTimestamp())),9,la)])]),_:1},8,["rows"])):d.loading?q("",!0):(m(),v(F,{key:1,message:"There are no liquidations"}))]),_:1})}}}),da=D(ia,[["__scopeId","data-v-f3133012"]]),ca={class:"dashboard-grid"},ua=C({__name:"Liquidations",props:{pair:{}},setup(e){const a=te(1),{isFetching:l,data:s}=et($(()=>({pair_id:e.pair.pairId,page:a.value,per_page:15})));return(t,r)=>(m(),P("div",ca,[i(da,{liquidations:n(s)?.events??[],count:n(s)?.count??0,loading:n(l),onPage:r[0]||(r[0]=o=>a.value=o)},null,8,["liquidations","count","loading"])]))}}),pa=D(ua,[["__scopeId","data-v-0dd6af85"]]),ma={style:{display:"flex"}},_a={ref:"chartRef",class:"chart"},ba=C({__name:"ChartBorrowCostApr",props:{apr:{}},setup(e){const a=ce(),l=ue("card"),{chart:s,series:t}=me({createChartOptions:be(),series:_e({name:"apr",color:$(()=>a.value.colors.red),formatter:o=>`${k(o,2,"percentage")}%`,minMove:.01})});pe(r);function r(){if(!s.value||!t.apr)return;const o=e.apr.map(d=>({time:d.timestamp.getUTCTimestamp(),value:d.apr})).uniqWith((d,u)=>d.time===u.time).orderBy(d=>d.time,"asc");o.length>0&&t.apr.setData(o),s.value.timeScale().fitContent()}return(o,d)=>{const u=ve,p=ge,h=I;return m(),v(h,{ref_key:"card",ref:l,title:"APR"},{actions:b(()=>[_("div",ma,[i(u,{filename:"apr",series:n(t)},null,8,["series"]),i(p,{chart:n(s),target:n(l)},null,8,["chart","target"])])]),default:b(()=>[_("div",_a,null,512)]),_:1},512)}}}),ga={style:{display:"flex"}},va={ref:"chartRef",class:"chart"},ha=C({__name:"ChartTvl",props:{tvl:{}},setup(e){const a=ce(),l=ue("card"),{chart:s,series:t}=me({createChartOptions:be(),series:_e({name:"tvl",color:$(()=>a.value.colors.blue),formatter:o=>`$${k(o,1,"dollar")}${R(o)}`})});pe(r);function r(){if(!s.value||!t.tvl)return;const o=e.tvl.map(d=>({time:d.timestamp.getUTCTimestamp(),value:d.tvl})).uniqWith((d,u)=>d.time===u.time).orderBy(d=>d.time,"asc");o.length>0&&t.tvl.setData(o),s.value.timeScale().fitContent()}return(o,d)=>{const u=ve,p=ge,h=I;return m(),v(h,{ref_key:"card",ref:l,title:"TVL"},{actions:b(()=>[_("div",ga,[i(u,{filename:"tvl",series:n(t)},null,8,["series"]),i(p,{chart:n(s),target:n(l)},null,8,["chart","target"])])]),default:b(()=>[_("div",va,null,512)]),_:1},512)}}}),fa={class:"kpis"},ya={class:"two-sides"},$a=C({__name:"OverviewKPIs",props:{pair:{}},setup(e){return(a,l)=>{const s=V,t=Q;return m(),P("div",fa,[i(t,{label:"Positions","has-value":!!a.pair},{default:b(()=>[i(s,{precision:0,value:a.pair?.activePositionsCount},null,8,["value"])]),_:1},8,["has-value"]),i(t,{label:"TVL","has-value":!!a.pair},{default:b(()=>[i(s,{type:"dollar",precision:2,value:a.pair?.totalUnderlying,"show-symbol":!1},null,8,["value"]),L(" "+w(a.pair.tokenPairUnderyling.symbol),1)]),_:1},8,["has-value"]),i(t,{label:"Debt","has-value":!!a.pair},{default:b(()=>[i(s,{type:"dollar",precision:2,value:a.pair?.totalDebt,"show-symbol":!1},null,8,["value"]),L(" "+w(a.pair.tokenDebt.symbol),1)]),_:1},8,["has-value"]),i(t,{label:"Borrow Rate / Reward Rate","has-value":!!a.pair},{default:b(()=>[_("div",ya,[i(s,{type:"percentage",precision:2,value:a.pair?.aprBorrowCost},null,8,["value"]),i(Le,{pair:a.pair},null,8,["pair"])])]),_:1},8,["has-value"]),i(t,{label:"Utilization Rate","has-value":!!a.pair},{default:b(()=>[i(s,{type:"percentage",precision:2,value:a.pair?.utilizationRate},null,8,["value"])]),_:1},8,["has-value"])])}}}),Ca=D($a,[["__scopeId","data-v-0b31edc7"]]),Da={class:"dashboard-grid"},wa=C({__name:"Overview",props:{pair:{}},setup(e){const{isFetching:a,data:l}=Ye(O(()=>({pair_id:e.pair.pairId}))),s=$(()=>(l.value??[]).map(o=>({timestamp:o.time,tvl:o.totalUnderlying}))),t=$(()=>(l.value??[]).map(o=>({timestamp:o.time,apr:o.aprBorrowCost}))),r=$(()=>{const o=(l.value??[]).filter(p=>p.rewards.length>0),d=o.map(p=>({timestamp:p.time,apr:p.aprBase,tokenAddress:"0x0",tokenSymbol:"Base APR"})),u=o.flatMap(p=>p.rewards.map(h=>({...h,timestamp:p.time})));return d.concat(u).groupBy(p=>p.tokenAddress).entries().filter(([p,h])=>p==="0x0"||h.length>0&&h.sumBy(T=>T.apr)/h.length>=1).map(([,p])=>({symbol:p[0].tokenSymbol,balances:p.map(h=>({timestamp:h.timestamp,balance:h.apr,tokenPrice:1}))}))});return(o,d)=>{const u=qe,p=I;return m(),P("div",Da,[i(Ca,{style:{"grid-area":"kpis"},pair:o.pair},null,8,["pair"]),n(a)?(m(),v(p,{key:1,loading:"",title:"APR",style:ye(`grid-area: apr; min-height: ${n(Te)}`)},null,8,["style"])):(m(),v(u,{key:0,style:{"grid-area":"apr"},title:"APR",balances:n(r),"show-dollars":!1},null,8,["balances"])),i(ba,{style:{"grid-area":"borrow-cost-apr"},apr:n(t),loading:n(a)},null,8,["apr","loading"]),i(ha,{style:{"grid-area":"tvl"},tvl:n(s),loading:n(a)},null,8,["tvl","loading"])])}}}),ka=D(wa,[["__scopeId","data-v-d84bbad8"]]),Ra=["href"],Pa={class:"end"},Fa={class:"end"},qa={class:"end",style:{display:"flex",gap:"1ch"}},Ta={class:"end"},La={class:"end"},Ia=["href"],Sa=C({__name:"TableRedemptions",props:{redemptions:{},count:{},pair:{},loading:{type:Boolean}},emits:["page"],setup(e,{emit:a}){const l=a,{page:s,onPage:t}=oe(),r=ee(s,200);z(r,d=>{l("page",d)});const{relativeTime:o}=ne();return(d,u)=>{const p=re,h=V,T=se,F=ae,K=I;return m(),v(K,{title:"Redemptions"},{actions:b(()=>[i(p,{"items-count":d.count,"items-per-page":10,page:n(s),onPage:n(t)},null,8,["items-count","page","onPage"])]),default:b(()=>[e.redemptions.length>0?(m(),v(T,{key:0,rows:e.redemptions,columns:["Caller",{label:"reUSD",align:"end"},{label:"Debt reduction",align:"end"},{label:"Collateral freed",align:"end"},{label:"Protocol fee",align:"end"},{label:"Time",align:"end"}]},{row:b(({item:f})=>[_("div",null,[_("a",{target:"_blank",href:`https://etherscan.io/address/${f.caller}`,onClick:u[0]||(u[0]=E(()=>{},["stop"]))},w(f.caller.ens||("addressShort"in d?d.addressShort:n(Y))(f.caller.address)),9,Ra)]),_("div",Pa,[i(h,{type:"dollar",value:f.amount/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),_("div",Fa,[i(h,{type:"dollar",value:f.debtReduction/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),_("div",qa,[i(h,{type:"dollar",value:f.collateralFreed/10**18,precision:2,"show-symbol":!1},null,8,["value"]),L(" "+w(d.pair.tokenCollateral.symbol),1)]),_("div",Ta,[i(h,{type:"dollar",value:f.protocolFee/10**18,precision:2,"show-symbol":!1},null,8,["value"])]),_("div",La,[_("a",{target:"_blank",href:`https://etherscan.io/tx/${f.txHash}`,onClick:u[1]||(u[1]=E(()=>{},["stop"]))},w(n(o)(f.blockTime.getUTCTimestamp())),9,Ia)])]),_:1},8,["rows"])):d.loading?q("",!0):(m(),v(F,{key:1,message:"There are no redemptions"}))]),_:1})}}}),Aa=D(Sa,[["__scopeId","data-v-bbc74a72"]]),Ua={class:"dashboard-grid"},Ba=C({__name:"Redemptions",props:{pair:{}},setup(e){const a=te(1),{isFetching:l,data:s}=Ze($(()=>({pair_id:e.pair.pairId,page:a.value,per_page:15})));return(t,r)=>(m(),P("div",Ua,[i(Aa,{redemptions:n(s)?.events??[],count:n(s)?.count??0,loading:n(l),pair:t.pair,onPage:r[0]||(r[0]=o=>a.value=o)},null,8,["redemptions","count","loading","pair"])]))}}),xa=D(Ba,[["__scopeId","data-v-eda307c4"]]),Na={class:"dashboard"},Ka=C({__name:"Pair.page",setup(e){const a=de("protocolName"),l=de("pairId",void 0,{transform:Number}),{isFetching:s,data:t}=we($(()=>({chain:"ethereum",protocol_name:a.value})),$(()=>!!a.value)),r=$(()=>(t.value??[]).find(p=>p.pairId===l.value)),{crumbs:o}=$e(Ce());z(r,p=>{o.value=[{id:"protocols",label:"Protocols",pathName:"protocols",params:()=>({protocolName:a.value})},{id:"protocol",label:a.value,pathName:"protocols",params:()=>({protocolName:a.value})},{id:"pair",label:`Pair: ${p?.name?ke(p.name):"?"}`}]},{immediate:!0});const{tabActive:d,tabActiveIndex:u}=Ie(["overview","collateral","redemptions","liquidations","health"],"pair",void 0,{tabParamName:"pairTab"});return(p,h)=>{const T=De,F=he,K=fe;return m(),P("div",Na,[i(T,{loading:n(s)},null,8,["loading"]),!n(s)&&n(r)?(m(),v(K,{key:0,active:n(u),onTab:h[0]||(h[0]=f=>u.value=f.index)},{default:b(()=>[i(F,{header:"Overview"},{default:b(()=>[(m(),v(H,null,[n(d)==="overview"?(m(),v(ka,{key:0,pair:n(r)},null,8,["pair"])):q("",!0)],1024))]),_:1}),i(F,{header:"Collateral"},{default:b(()=>[(m(),v(H,null,[n(d)==="collateral"?(m(),v(ut,{key:0,pair:n(r)},null,8,["pair"])):q("",!0)],1024))]),_:1}),i(F,{header:"Redemptions"},{default:b(()=>[(m(),v(H,null,[n(d)==="redemptions"?(m(),v(xa,{key:0,pair:n(r)},null,8,["pair"])):q("",!0)],1024))]),_:1}),i(F,{header:"Liquidation"},{default:b(()=>[(m(),v(H,null,[n(d)==="liquidations"?(m(),v(pa,{key:0,pair:n(r)},null,8,["pair"])):q("",!0)],1024))]),_:1}),i(F,{header:"Health"},{default:b(()=>[(m(),v(H,null,[n(d)==="health"?(m(),v(ea,{key:0,pair:n(r)},null,8,["pair"])):q("",!0)],1024))]),_:1})]),_:1},8,["active"])):q("",!0)])}}}),ns=D(Ka,[["__scopeId","data-v-9fb4fef3"]]);export{ns as default};
