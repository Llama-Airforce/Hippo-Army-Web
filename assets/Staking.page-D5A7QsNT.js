import{_ as he}from"./DashboardHeader-BZxATxlq.js";import{t as D,b as I,f as C,a as P,g as te,r as A,u as Q}from"./Number-D-_ywgC3.js";import{o as h,e as se,s as p,n as g,d as ve,a as F,p as O,t as K,f as S,g as V,_ as N}from"./AsyncValue-Brd_Goit.js";import{p as ae}from"./Pagination-vgbH7lYO.js";import{aJ as fe,aw as q,d as T,u as ne,a as oe,c as k,w as re,b as R,o as w,e as f,f as d,g as u,h as n,_ as H,l as B,t as W,ar as E,m as U,at as j,ao as ye,aq as be,am as ke,ah as $e,j as Te}from"./index-C4bxLmri.js";import{u as le,c as ie,a as ce,_ as ue,b as we}from"./UseLightweightChart-C12vCX9v.js";import{_ as pe}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-CH9iGe7u.js";import{_ as Ue}from"./ChartApex-DyJKELTz.js";import{c as Ce}from"./ChartStylesApex-DE9w9qVh.js";import{u as Pe,_ as Fe}from"./UseLegend-p1jgbDxG.js";import{_ as z}from"./Table-CDZZfuyN.js";import{u as Se,_ as de,a as Ve}from"./UsePagination-C4qACSg2.js";import{u as me}from"./UseRelativeTime-BFrqfvoq.js";const qe=h({event_type:ve(["stake","unstake"]),block_timestamp:g(),tx_hash:p(),block_number:g(),amount:p(),amount_usd:p(),account:se}).transform(e=>({eventType:e.event_type,blockTime:D(e.block_timestamp),txHash:e.tx_hash,blockNumber:e.block_number,amount:parseFloat(e.amount),amountUsd:parseFloat(e.amount_usd),account:e.account})),Re=h({events:F(qe),count:g(),page:g(),total_pages:g()}).transform(e=>({events:e.events,count:e.count,page:e.page,totalPages:e.total_pages})),He=h({account:se,amount:p(),amount_usd:p(),end_timestamp:g(),block_timestamp:g(),tx_hash:p()}).transform(e=>({account:e.account,amount:parseFloat(e.amount),amountUsd:parseFloat(e.amount_usd),end:D(e.end_timestamp),blockTime:D(e.block_timestamp),txHash:e.tx_hash})),xe=h({entries:F(He)}).transform(e=>({entries:e.entries})),De=h({timestamp:g(),token_address:p(),token_symbol:p(),apr:p()}).transform(e=>({timestamp:D(e.timestamp),tokenAddress:e.token_address,tokenSymbol:e.token_symbol,apr:parseFloat(e.apr)})),Ae=h({snapshots:F(De),count:g(),page:g(),total_pages:g()}).transform(e=>({snapshots:e.snapshots,count:e.count,page:e.page,totalPages:e.total_pages})),Ee=h({timestamp:g(),tvl:p(),tvl_usd:p()}).transform(e=>({timestamp:D(e.timestamp),tvl:parseFloat(e.tvl),tvlUsd:parseFloat(e.tvl_usd)})),Be=h({data:F(Ee),count:g(),page:g(),total_pages:g()}).transform(e=>({data:e.data,count:e.count,page:e.page,totalPages:e.total_pages})),Le=h({address:p(),label:p().nullable(),ens:p().nullable(),position_value:p(),position_value_usd:p()}).transform(e=>({address:e.address,label:e.label,ens:e.ens,positionValue:parseFloat(e.position_value),positionValueUsd:parseFloat(e.position_value_usd)})),We=h({total_tvl:p(),total_tvl_usd:p(),top_users_tvl:p(),top_users_tvl_usd:p(),others_tvl:p(),others_tvl_usd:p(),users:F(Le)}).transform(e=>({totalTvl:parseFloat(e.total_tvl),totalTvlUsd:parseFloat(e.total_tvl_usd),topUsersTvl:parseFloat(e.top_users_tvl),topUsersTvlUsd:parseFloat(e.top_users_tvl_usd),othersTvl:parseFloat(e.others_tvl),othersTvlUsd:parseFloat(e.others_tvl_usd),users:e.users})),Qe=h({min_value_usd:p(),max_value_usd:p(),count:g()}).transform(e=>({minValueUsd:parseFloat(e.min_value_usd),maxValueUsd:parseFloat(e.max_value_usd),count:e.count})),Ie=h({bins:F(Qe),total_users:g()}).transform(e=>({bins:e.bins,totalUsers:e.total_users})),Oe=h({...S,...K,...O});async function Ke(e,t){const r=V(t),{chain:o,...s}=Oe.parse(e),l=I(s),a=await C(`${r}/v1/staking/${o}/events${l}`,void 0,t==null?void 0:t.signal);return Re.parse(a)}const Ne=h(S);async function je(e,t){const r=V(t),{chain:o}=Ne.parse(e),s=await C(`${r}/v1/staking/${o}/cooldown_queue`,void 0,t==null?void 0:t.signal);return xe.parse(s)}const ze=h({...S,...K,...O});async function Je(e,t){const r=V(t),{chain:o,...s}=ze.parse(e),l=I(s),a=await C(`${r}/v1/staking/${o}/apr_history${l}`,void 0,t==null?void 0:t.signal);return Ae.parse(a)}const Me=h({...S,...K,...O});async function Ge(e,t){const r=V(t),{chain:o,...s}=Me.parse(e),l=I(s),a=await C(`${r}/v1/staking/${o}/tvl_history${l}`,void 0,t==null?void 0:t.signal);return Be.parse(a)}const Xe=h(S);async function Ye(e,t){const r=V(t),{chain:o}=Xe.parse(e),s=await C(`${r}/v1/staking/${o}/top_users`,void 0,t==null?void 0:t.signal);return We.parse(s)}const Ze=h({...S,bin_count:g().int().positive().optional()});async function et(e,t){const r=V(t),{chain:o,...s}=Ze.parse(e),l=I(s),a=await C(`${r}/v1/staking/${o}/position_histogram${l}`,void 0,t==null?void 0:t.signal);return Ie.parse(a)}function tt(e){return P({queryKey:["staking-events",e],queryFn:()=>Ke(q(e)),placeholderData:fe})}function st(e){return P({queryKey:["staking-cooldown-queue",e],queryFn:()=>je(q(e))})}function at(e){const{start:t,end:r}=te({daysRange:90});return P({queryKey:["staking-apr-history",e],queryFn:()=>ae((s,l)=>Je({...q(e),page:s,per_page:l,start:t,end:r}).then(a=>a.snapshots),1,100)})}function nt(e){const{start:t,end:r}=te({daysRange:90});return P({queryKey:["staking-tvl-history",e],queryFn:()=>ae((s,l)=>Ge({...q(e),page:s,per_page:l,start:t,end:r}).then(a=>a.data),1,100)})}function ot(e){return P({queryKey:["staking-top-users",e],queryFn:()=>Ye(q(e))})}function rt(e){return P({queryKey:["staking-position-hist",e],queryFn:()=>et(q(e))})}const lt={style:{display:"flex"}},it={ref:"chartRef",class:"chart"},ct=T({__name:"ChartApr",props:{apr:{}},setup(e){const t=ne(),r=oe("card"),{chart:o,series:s}=le({createChartOptions:ce(),series:ie({name:"apr",color:k(()=>t.value.colors.blue),formatter:a=>`${A(a,0,"percentage")}%`,minMove:.01})});re(l);function l(){if(!o.value||!s.apr)return;const a=e.apr.map(c=>({time:c.timestamp.getUTCTimestamp(),value:c.apr})).uniqWith((c,_)=>c.time===_.time).orderBy(c=>c.time,"asc");a.length>0&&s.apr.setData(a),o.value.timeScale().fitContent()}return(a,c)=>{const _=pe,m=ue,y=H;return w(),R(y,{ref_key:"card",ref:r,title:"APR"},{actions:f(()=>[d("div",lt,[u(_,{filename:"apr",series:n(s)},null,8,["series"]),u(m,{chart:n(o),target:n(r)},null,8,["chart","target"])])]),default:f(()=>[d("div",it,null,512)]),_:1},512)}}}),ut=T({__name:"ChartPositions",props:{bins:{}},setup(e){const t=k(()=>Ce({chart:{type:"bar",animations:{enabled:!1},toolbar:{show:!1},zoom:{enabled:!1}},xaxis:{categories:r.value,labels:{formatter:s=>s,rotate:-60},tickPlacement:"on"},yaxis:{labels:{formatter:s=>s}},plotOptions:{bar:{columnWidth:"50%"}},dataLabels:{enabled:!1},tooltip:{followCursor:!1,enabled:!0,intersect:!0,custom:s=>{const l=s.series[0][s.dataPointIndex];return`<div><b>Range</b>: ${r.value[s.dataPointIndex]}</div><div><b>Users</b>: ${l}</div>`}}})),r=k(()=>e.bins.map(s=>{const l=s.minValueUsd?`${A(s.minValueUsd,0,"dollar")}${Q(s.minValueUsd)}`:"0",a=s.maxValueUsd?`${A(s.maxValueUsd,0,"dollar")}${Q(s.maxValueUsd)}`:"0";return`${l} - ${a}`})),o=k(()=>[{name:"Users",data:e.bins.map(s=>s.count)}]);return(s,l)=>{const a=Ue,c=H;return w(),R(c,{title:"User positions"},{default:f(()=>[u(a,{options:n(t),series:n(o)},null,8,["options","series"])]),_:1})}}}),pt=B(ut,[["__scopeId","data-v-791d1a3d"]]),dt={style:{display:"flex"}},mt={ref:"chartRef",class:"chart"},_t=T({__name:"ChartTvl",props:{tvl:{}},setup(e){const t=ne(),{items:r,toggles:o,disabled:s}=Pe(()=>[{id:"rsup",label:"RSUP",color:t.value.colorsArray[0],togglable:!0},{id:"dollars",label:"Dollars",color:t.value.colorsArray[1],togglable:!0}]),l=oe("card"),{chart:a,series:c}=le({createChartOptions:ce(),series:[ie({name:"rsup",color:k(()=>t.value.colors.blue),formatter:m=>`${A(m,1,"dollar")}${Q(m)}`}),{type:"Line",name:"dollars",options:k(()=>({priceFormat:{type:"custom",formatter:m=>`$${A(m,1,"dollar")}${Q(m)}`},lineWidth:2,lineType:we.WithSteps,color:t.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});re(_);function _(){if(!a.value||!c.rsup||!c.dollars)return;const m=e.tvl.map(i=>({time:i.timestamp.getUTCTimestamp(),value:i.tvl})).uniqWith((i,b)=>i.time===b.time).orderBy(i=>i.time,"asc"),y=e.tvl.map(i=>({time:i.timestamp.getUTCTimestamp(),value:i.tvlUsd})).uniqWith((i,b)=>i.time===b.time).orderBy(i=>i.time,"asc");c.rsup.setData(m),c.dollars.setData(y),c.rsup.applyOptions({visible:o.rsup.value}),c.dollars.applyOptions({visible:o.dollars.value}),a.value.timeScale().fitContent()}return(m,y)=>{const i=pe,b=ue,x=Fe,v=H;return w(),R(v,{ref_key:"card",ref:l,title:"TVL"},{actions:f(()=>[d("div",dt,[u(i,{filename:"tvl",series:n(c)},null,8,["series"]),u(b,{chart:n(a),target:n(l)},null,8,["chart","target"])])]),"actions-secondary":f(()=>[u(x,{items:n(r),disabled:n(s),onToggle:y[0]||(y[0]=L=>n(o)[L].value=!n(o)[L].value)},null,8,["items","disabled"])]),default:f(()=>[d("div",mt,null,512)]),_:1},512)}}}),gt=["href"],ht={class:"end"},vt={class:"end"},ft={class:"end"},yt=["href"],ee=10,bt=T({__name:"TableCooldowns",props:{cooldowns:{}},setup(e){const{page:t,rowsPage:r,onPage:o}=Se(W(()=>e.cooldowns),ee),{relativeTime:s}=me();return(l,a)=>{const c=de,_=N,m=z,y=H;return w(),R(y,{title:"Cooldown Queue"},{actions:f(()=>[u(c,{"items-count":l.cooldowns.length,"items-per-page":ee,page:n(t),onPage:n(o)},null,8,["items-count","page","onPage"])]),default:f(()=>[u(m,{rows:n(r),columns:["User",{label:"RSUP",align:"end"},{label:"Dollars",align:"end"},{label:"Time",align:"end"}]},{row:f(({item:i})=>[d("div",null,[d("a",{target:"_blank",href:`https://etherscan.io/address/${i.account.address}`,onClick:a[0]||(a[0]=E(()=>{},["stop"]))},U(i.account.ens||("addressShort"in l?l.addressShort:n(j))(i.account.address)),9,gt)]),d("div",ht,[u(_,{type:"dollar",value:i.amount,precision:2,"show-symbol":!1},null,8,["value"])]),d("div",vt,[u(_,{type:"dollar",value:i.amountUsd,precision:2},null,8,["value"])]),d("div",ft,[d("a",{target:"_blank",href:`https://etherscan.io/tx/${i.txHash}`,onClick:a[1]||(a[1]=E(()=>{},["stop"]))},U(n(s)(i.end.getUTCTimestamp())),9,yt)])]),_:1},8,["rows"])]),_:1})}}}),kt=B(bt,[["__scopeId","data-v-6228b228"]]),$t=["href"],Tt={class:"end"},wt={class:"end"},Ut={class:"end"},Ct=["href"],Pt=T({__name:"TableEvents",props:{events:{},count:{}},emits:["page"],setup(e,{emit:t}){const r=t,{page:o,onPage:s}=Ve(),l=ye(o,200);be(l,_=>{r("page",_)});const{relativeTime:a}=me(),c=_=>{switch(_.eventType){case"stake":return"Stake";case"unstake":return"Unstake"}};return(_,m)=>{const y=de,i=N,b=z,x=H;return w(),R(x,{title:"Events"},{actions:f(()=>[u(y,{"items-count":_.count,"items-per-page":10,page:n(o),onPage:n(s)},null,8,["items-count","page","onPage"])]),default:f(()=>[u(b,{rows:_.events,columns:["Type","Owner",{label:"RSUP",align:"end"},{label:"Dollars",align:"end"},{label:"Time",align:"end"}]},{row:f(({item:v})=>[d("div",{class:ke({green:v.eventType==="stake",red:v.eventType==="unstake"})},U(c(v)),3),d("div",null,[d("a",{target:"_blank",href:`https://etherscan.io/address/${v.account.address}`,onClick:m[0]||(m[0]=E(()=>{},["stop"]))},U(v.account.ens||("addressShort"in _?_.addressShort:n(j))(v.account.address)),9,$t)]),d("div",Tt,[u(i,{type:"dollar",value:v.amount,precision:2,"show-symbol":!1},null,8,["value"])]),d("div",wt,[u(i,{type:"dollar",value:v.amountUsd,precision:2},null,8,["value"])]),d("div",Ut,[d("a",{target:"_blank",href:`https://etherscan.io/tx/${v.txHash}`,onClick:m[1]||(m[1]=E(()=>{},["stop"]))},U(n(a)(v.blockTime.getUTCTimestamp())),9,Ct)])]),_:1},8,["rows"])]),_:1})}}}),Ft=B(Pt,[["__scopeId","data-v-a959b9d4"]]),St=["href"],Vt={class:"end"},qt={class:"end"},Rt=T({__name:"TableTopUsers",props:{topUsers:{}},setup(e){return(t,r)=>{const o=N,s=z,l=H;return w(),R(l,{title:"Top Users"},{default:f(()=>[u(s,{rows:t.topUsers,columns:["Address",{label:"RSUP",align:"end"},{label:"Dollars",align:"end"}]},{row:f(({item:a})=>[d("div",null,[d("a",{target:"_blank",href:`https://etherscan.io/address/${a.address}`,onClick:r[0]||(r[0]=E(()=>{},["stop"]))},U(a.ens||("addressShort"in t?t.addressShort:n(j))(a.address)),9,St)]),d("div",Vt,[u(o,{type:"dollar",value:a.positionValue,precision:2,"show-symbol":!1},null,8,["value"])]),d("div",qt,[u(o,{type:"dollar",value:a.positionValueUsd,precision:2},null,8,["value"])])]),_:1},8,["rows"])]),_:1})}}}),Ht=B(Rt,[["__scopeId","data-v-d5d8af2d"]]),xt={class:"dashboard"},Dt=T({__name:"Staking.page",setup(e){const{isFetching:t,data:r}=at({chain:"ethereum"}),o=k(()=>(r.value??[]).map($=>({timestamp:$.timestamp,apr:$.apr}))),{isFetching:s,data:l}=nt({chain:"ethereum"}),a=k(()=>(l.value??[]).map($=>({timestamp:$.timestamp,tvl:$.tvl,tvlUsd:$.tvlUsd}))),c=$e(1),{isFetching:_,data:m}=tt(k(()=>({chain:"ethereum",page:c.value,per_page:10}))),{isFetching:y,data:i}=ot(W(()=>({chain:"ethereum"}))),{isFetching:b,data:x}=st(W(()=>({chain:"ethereum"}))),{isFetching:v,data:L}=rt(W(()=>({chain:"ethereum"})));return($,J)=>{var M,G,X,Y,Z;const _e=he;return w(),Te("div",xt,[u(_e,{style:{"grid-area":"header"},title:"Staking",description:"User governance staking metrics (RSUP)"}),u(ct,{style:{"grid-area":"apr"},apr:n(o),loading:n(t)},null,8,["apr","loading"]),u(_t,{style:{"grid-area":"tvl"},tvl:n(a),loading:n(s)},null,8,["tvl","loading"]),u(Ft,{style:{"grid-area":"events"},events:((M=n(m))==null?void 0:M.events)??[],count:((G=n(m))==null?void 0:G.count)??0,loading:n(_),onPage:J[0]||(J[0]=ge=>c.value=ge)},null,8,["events","count","loading"]),u(Ht,{style:{"grid-area":"top-users"},"top-users":((X=n(i))==null?void 0:X.users)??[],loading:n(y)},null,8,["top-users","loading"]),u(kt,{style:{"grid-area":"cooldowns"},cooldowns:((Y=n(x))==null?void 0:Y.entries)??[],loading:n(b)},null,8,["cooldowns","loading"]),u(pt,{style:{"grid-area":"positions"},bins:((Z=n(L))==null?void 0:Z.bins)??[],loading:n(v)},null,8,["bins","loading"])])}}}),Mt=B(Dt,[["__scopeId","data-v-2fb19d6b"]]);export{Mt as default};
