import{a as G,_ as H}from"./TabItem.vue_vue_type_script_setup_true_lang-CitRpzKi.js";import{_ as q}from"./DashboardHeader-CMVhByqu.js";import{_ as K}from"./KPI-BbDo3yd5.js";import{_ as V}from"./AsyncValue-Dbxinhn4.js";import{b as j,c as M,a as J}from"./protocols-BopcUmaZ.js";import{d as P,u as Q,a as X,c as y,w as Y,b as f,o as m,e as u,f as _,g as a,h as t,_ as A,aD as Z,ar as ee,l as $,t as te,aE as oe,m as L,k as D,j as F,aF as ae,aG as ne,aA as se,av as re,aH as le,aI as B,an as k}from"./index-DwSotjAb.js";import{b as ie,u as ce,c as ue,G as de,r as me,a as pe,d as _e,_ as ve}from"./UseLightweightChart-fT5MLJif.js";import{_ as ge}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-DBJxZk61.js";import{r as N,u as R}from"./timestamp-BYVxXSJt.js";import{_ as he}from"./Table-DsnJIl-C.js";import{_ as fe}from"./TokenIcon-DXvXAltk.js";import{u as be,_ as ye}from"./UsePagination-CuCgqoAz.js";import{p as S}from"./util-CVNQ9WdU.js";import{T as we,u as Ce}from"./UseTabNavigation-BiWtD0MZ.js";import{u as Pe}from"./UseSort-Hd9QRwC_.js";import"./Tooltip-dGeKlIzS.js";import"./Pagination-vgbH7lYO.js";import"./index-Bkhjjd7F.js";const Te={style:{display:"flex"}},$e={ref:"chartRef",class:"chart"},xe=P({__name:"ChartTvl",props:{tvl:{}},setup(d){const r=Q(),{items:v,toggles:n,disabled:w}=ie(()=>[{id:"underlying",label:"Underlying",color:r.value.colorsArray[0],togglable:!0},{id:"debt",label:"Debt",color:r.value.colorsArray[1],togglable:!0}]),c=X("card"),{chart:p,series:l}=ce({createChartOptions:pe(),series:[ue({name:"underlying",color:y(()=>r.value.colors.blue),formatter:e=>`$${N(e,1,"dollar")}${R(e)}`}),{type:de,name:"debt",options:y(()=>({priceFormat:{type:"custom",formatter:e=>`$${N(e,1,"dollar")}${R(e)}`},lineWidth:2,lineType:me.WithSteps,color:r.value.colors.yellow,lastValueVisible:!1,priceLineVisible:!1}))}]});Y(s);function s(){!p.value||!l.underlying||!l.debt||(l.underlying.setData(d.tvl.map(e=>({time:e.timestamp.getUTCTimestamp(),value:e.underlying})).uniqWith((e,i)=>e.time===i.time).orderBy(e=>e.time,"asc")),l.debt.setData(d.tvl.map(e=>({time:e.timestamp.getUTCTimestamp(),value:e.debt})).uniqWith((e,i)=>e.time===i.time).orderBy(e=>e.time,"asc")),l.underlying.applyOptions({visible:n.underlying.value}),l.debt.applyOptions({visible:n.debt.value}),p.value.timeScale().fitContent())}return(e,i)=>{const g=ge,C=ve,o=_e,h=A;return m(),f(h,{ref_key:"card",ref:c,title:"TVL"},{actions:u(()=>[_("div",Te,[a(g,{filename:"tvl",series:t(l)},null,8,["series"]),a(C,{chart:t(p),target:t(c)},null,8,["chart","target"])])]),"actions-secondary":u(()=>[a(o,{items:t(v),disabled:t(w),onToggle:i[0]||(i[0]=T=>t(n)[T].value=!t(n)[T].value)},null,8,["items","disabled"])]),default:u(()=>[_("div",$e,null,512)]),_:1},512)}}}),Le=P({__name:"IconExpander",props:{expanded:{type:Boolean,default:!1}},setup(d){return(r,v)=>{const n=Z;return m(),f(n,{class:ee(["expander",{expanded:r.expanded}])},null,8,["class"])}}}),Be=$(Le,[["__scopeId","data-v-7caf48cb"]]),ke={class:"token"},Ne={class:"end",style:{display:"flex",gap:"1ch"}},Re={class:"end"},Se={class:"end"},Ie={class:"end"},I=20,Ue=P({__name:"TablePairs",props:{protocolName:{}},setup(d){const{isFetching:r,data:v}=j(te(()=>({chain:"ethereum",protocol_name:d.protocolName||""})),y(()=>!!d.protocolName)),n=y(()=>{var o;return(o=v.value)==null?void 0:o.filter(h=>h.borrowLimit>0)}),w=["","",{id:"name",label:"Name",sort:!0},{id:"tvl",label:"TVL",sort:!0,align:"end"},{id:"rewardRate",label:"Reward Rate",sort:!0,align:"end"},{id:"borrowRate",label:"Borrow Rate",sort:!0,align:"end"},{id:"util",label:"Util",sort:!0,align:"end"}],{sorting:c,onSort:p}=Pe("tvl"),l=y(()=>(n.value??[]).orderBy(o=>{switch(c.value.column){case"name":return S(o.name);case"tvl":return o.totalUnderlying;case"rewardRate":return o.aprBase+o.rewards.sumBy(h=>h.apr);case"borrowRate":return o.aprBorrowCost;case"util":return o.utilizationRate}},c.value.order)),{page:s,rowsPage:e,onPage:i}=be(l,I),g=oe(),C=async o=>{var h;await g.push({name:"pair",params:{protocolName:(h=d.protocolName)==null?void 0:h.toLocaleLowerCase(),pairId:o.pairId.toString()}})};return(o,h)=>{const T=ye,z=Be,E=fe,x=V,W=he,O=A;return m(),f(O,{title:"Pairs",loading:t(r)},{actions:u(()=>[a(T,{"items-count":t(l).length,"items-per-page":I,page:t(s),onPage:t(i)},null,8,["items-count","page","onPage"])]),default:u(()=>[a(W,{class:"pairs-table",rows:t(e),columns:w,sorting:t(c),onSortColumn:t(p),onSelect:C},{row:u(({item:b})=>[a(z),_("div",ke,[(m(),f(E,{key:b.tokenPairCollateral.symbol,chain:"ethereum",address:b.tokenPairCollateral.address},null,8,["address"]))]),_("div",null,L(t(S)(b.name)),1),_("div",Ne,[a(x,{"show-zero":"",type:"dollar",value:b.totalUnderlying,precision:2,"show-symbol":!1},null,8,["value"]),D(" "+L(b.tokenPairUnderyling.symbol),1)]),_("div",Re,[a(we,{pair:b},null,8,["pair"])]),_("div",Se,[a(x,{"show-zero":"",type:"percentage",value:b.aprBorrowCost,precision:2},null,8,["value"])]),_("div",Ie,[a(x,{"show-zero":"",type:"percentage",value:b.utilizationRate,precision:2},null,8,["value"])])]),_:1},8,["rows","sorting","onSortColumn"])]),_:1},8,["loading"])}}}),Ve=$(Ue,[["__scopeId","data-v-8428af24"]]),Ae={class:"dashboard-grid root"},De={class:"kpis"},Fe={class:"dashboard-grid charts"},ze=P({__name:"Protocol",props:{protocol:{}},setup(d){const{isFetching:r,data:v}=M({chain:"ethereum"}),n=y(()=>{var s;return(((s=v.value)==null?void 0:s.protocols)??[]).find(e=>e.name.toLocaleLowerCase()===d.protocol)}),{isFetching:w,data:c}=J({chain:"ethereum"}),p=y(()=>{var s;return(((s=c.value)==null?void 0:s.snapshots)??[]).filter(e=>e.name.toLocaleLowerCase()===d.protocol).groupBy(e=>e.timestamp.getTime()).entries()}),l=y(()=>p.value.flatMap(([,s])=>({timestamp:s[0].timestamp,underlying:s.sumBy(e=>e.totalUnderlying),debt:s.sumBy(e=>e.totalDebt)})));return(s,e)=>{var C;const i=V,g=K;return m(),F("div",Ae,[_("div",De,[a(g,{label:"Pairs","has-value":!t(r)},{default:u(()=>{var o;return[a(i,{value:(o=t(n))==null?void 0:o.pairsCount,precision:0},null,8,["value"])]}),_:1},8,["has-value"]),a(g,{label:"Total collateral","has-value":!t(r)},{default:u(()=>{var o;return[a(i,{type:"dollar",value:(o=t(n))!=null&&o.totalUnderlying?t(n).totalUnderlying:void 0,precision:2},null,8,["value"])]}),_:1},8,["has-value"]),a(g,{label:"Total debt","has-value":!t(r)},{default:u(()=>{var o;return[a(i,{value:(o=t(n))==null?void 0:o.totalDebt,precision:0},null,8,["value"]),e[0]||(e[0]=D(" reUSD "))]}),_:1,__:[0]},8,["has-value"])]),a(Ve,{"protocol-name":(C=t(n))==null?void 0:C.name},null,8,["protocol-name"]),_("div",Fe,[a(xe,{style:{"grid-area":"chart-tvl"},tvl:t(l),loading:t(w)},null,8,["tvl","loading"])])])}}}),U=$(ze,[["__scopeId","data-v-30028cd7"]]),Ee={key:1,class:"dashboard"},We=P({__name:"Protocols.page",setup(d){const{tabActive:r,tabActiveIndex:v}=Ce(["curvelend","fraxlend"],"protocols",void 0,{tabParamName:"protocolName"}),{crumbs:n}=ae(ne()),w=se();return re(()=>w.name,c=>{c!=="pair"&&(n.value=[{id:"protocols",label:"Protocols",pathName:"protocols"}])},{immediate:!0}),(c,p)=>{const l=le("router-view"),s=q,e=G,i=H;return c.$route.name==="pair"?(m(),f(l,{key:0})):(m(),F("div",Ee,[a(s,{style:{"grid-area":"header"},title:"Protocols",description:"Lending markets metrics for Curve Lend and Frax Lend protocols"}),a(i,{active:t(v),onTab:p[0]||(p[0]=g=>v.value=g.index)},{default:u(()=>[a(e,{header:"Curve Lend"},{default:u(()=>[(m(),f(B,null,[t(r)==="curvelend"?(m(),f(U,{key:0,protocol:"curvelend"})):k("",!0)],1024))]),_:1}),a(e,{header:"Frax Lend"},{default:u(()=>[(m(),f(B,null,[t(r)==="fraxlend"?(m(),f(U,{key:0,protocol:"fraxlend"})):k("",!0)],1024))]),_:1})]),_:1},8,["active"])]))}}}),rt=$(We,[["__scopeId","data-v-90d9b0e2"]]);export{rt as default};
