import{d as v,u as U,a as A,c as b,w as R,b as y,o as d,e as f,f as p,g as c,h as r,_ as D,E,t as P,R as V,i as q,j as C,k as K,l as H,n as w}from"./index-PoaDd28P.js";import{_ as $}from"./ChartBalances-hSvwKw-i.js";import{u as L,c as M,a as F,_ as N,D as S}from"./UseLightweightChart-v9UZ1eMO.js";import{u as O,a as Q}from"./protocols-B4h3rQ8D.js";import{u as W}from"./stablecoin-CkySCZnl.js";import{_ as j}from"./BtnChartLWExport.vue_vue_type_script_setup_true_lang-CWTFpjdc.js";import{r as z,u as G,f as B,a as I,g as J}from"./timestamp-CnCs2YLF.js";import{_ as X}from"./KPI-CgrOCMEj.js";import{_ as Y}from"./AsyncValue-CRYfR47y.js";import"./Tooltip-BACmjZtt.js";import"./Pagination-vgbH7lYO.js";const Z="/assets/hippo-ghibli-DCzfPtIQ.png",ee={style:{display:"flex"}},te={ref:"chartRef",class:"chart"},ae=v({__name:"ChartPrice",props:{price:{}},setup(t){const e=U(),a=A("card"),{chart:s,series:l}=L({createChartOptions:F(),series:M({name:"price",color:b(()=>e.value.colors.purple),formatter:n=>`$${z(n,4,"dollar")}${G(n)}`,minMove:.001,autoscaleInfoProvider:()=>({priceRange:{minValue:Math.max(Math.min(...t.price.map(n=>n.price)),.95),maxValue:Math.min(Math.max(...t.price.map(n=>n.price)),1.05)}})})});R(u);function u(){if(!s.value||!l.price)return;const n=t.price.map(o=>({time:o.timestamp.getUTCTimestamp(),value:o.price})).uniqWith((o,h)=>o.time===h.time).orderBy(o=>o.time,"asc");n.length>0&&l.price.setData(n),s.value.timeScale().fitContent()}return(n,o)=>{const h=j,i=N,_=D;return d(),y(_,{ref_key:"card",ref:a,title:"Stablecoin Price (reUSD)"},{actions:f(()=>[p("div",ee,[c(h,{filename:"tvl",series:r(l)},null,8,["series"]),c(i,{chart:r(s),target:r(a)},null,8,["chart","target"])])]),default:f(()=>[p("div",te,null,512)]),_:1},512)}}});class se{async fetch(e,a,s){return B(e,a,s)}}class re extends se{host;constructor(e){super(),this.host=e}async getHost(){return await this.host}}class ne extends re{async getPrice(e){const a=await this.getHost(),s=`ethereum:${e}`;return this.fetch(`${a}/price/${e}`).then(l=>l[s])}async getPrices(e){const a=await this.getHost(),s=e.join(",");return this.fetch(`${a}/price/${s}`)}}const oe={laf:"https://api.llama.airforce",ha:"https://api2.hippo.army",cb:void 0,cm:"https://api2.curvemonitor.com"},ie=["cb","laf","ha","cm"];function ce(){const t="ha";if(!ie.includes(t)){const e=`Unknown app for useApp(): ${t}`;throw E({text:e,type:"error"}),new Error(e)}return t}const g={};function le(t){return oe[t]}async function x(t){const e=ce(),a=e;if(g[a])return Promise.resolve(g[a]);const s=le(e);return g[a]=s,g[a]}const pe=new ne(x());function k(t){return I({queryKey:["token-price",t],queryFn:async({queryKey:[,e]})=>pe.getPrice(e),enabled:b(()=>!!t.value),initialDataUpdatedAt:0})}async function ue(t){const e=J(t);return await B(`${e}/stats`,void 0,t?.signal)}function me(){return I({queryKey:["stats"],queryFn:async()=>{const t=await x();return ue({host:t})}})}const de={class:"kpis"},he=v({__name:"KPIs",setup(t){const{data:e}=k(P(()=>V)),{data:a}=k(P(()=>q)),{data:s}=me();return(l,u)=>{const n=Y,o=X;return d(),C("div",de,[c(o,{class:"border-special",label:"RSUP Price","has-value":!!r(e)},{default:f(()=>[c(n,{type:"dollar",value:r(e)?.price??1/0,precision:3},null,8,["value"])]),_:1},8,["has-value"]),c(o,{class:"border-special",label:"reUSD Price","has-value":!!r(a)},{default:f(()=>[c(n,{type:"dollar",value:r(a)?.price??1/0,precision:3},null,8,["value"])]),_:1},8,["has-value"]),c(o,{class:"border-special",label:"Total reUSD borrowed","has-value":!!r(s)?.borrowed},{default:f(()=>[c(n,{type:"dollar",value:r(s)?.borrowed??1/0,precision:0,"show-symbol":!1},null,8,["value"]),u[0]||(u[0]=K(" reUSD "))]),_:1,__:[0]},8,["has-value"]),c(o,{class:"border-special",label:"Total collateral","has-value":!!r(s)?.collateral},{default:f(()=>[c(n,{type:"dollar",value:r(s)?.collateral??1/0,precision:0},null,8,["value"])]),_:1},8,["has-value"])])}}}),_e=H(he,[["__scopeId","data-v-a8311ac2"]]),fe={class:"dashboard"},ye={class:"highlights"},ge={class:"dashboard-grid charts"},be=v({__name:"Home.page",setup(t){O();const{isFetching:e,data:a}=W(),{isFetching:s,data:l}=Q({chain:"ethereum"}),u=h=>(l.value?.snapshots??[]).map(i=>({symbol:i.name,balances:[{timestamp:i.timestamp,balance:i[h],tokenPrice:1}]})).groupBy(i=>i.symbol).entries().map(([i,_])=>({symbol:i,balances:_.flatMap(m=>m.balances).groupBy(m=>m.timestamp.getTime()).entries().map(([,m])=>({timestamp:m[0].timestamp,balance:m.sumBy(T=>T.balance),tokenPrice:m[0].tokenPrice}))})),n=b(()=>u("totalUnderlying")),o=b(()=>u("totalDebt"));return(h,i)=>{const _=D;return d(),C("div",fe,[i[0]||(i[0]=p("div",{class:"description"},[p("span",{class:"title"},"Hippo Army"),p("span",{class:"tag"},"Resupplying your portobello with hippo insights.")],-1)),i[1]||(i[1]=p("img",{class:"hippo",src:Z},null,-1)),p("div",ye,[c(_e)]),p("div",ge,[c(ae,{style:{"grid-area":"price"},price:r(a),loading:r(e)},null,8,["price","loading"]),r(s)?(d(),y(_,{key:1,loading:"",title:"TVL",style:w(`grid-area: underlying; min-height: ${r(S)}`)},null,8,["style"])):(d(),y($,{key:0,style:{"grid-area":"underlying"},title:"TVL",balances:r(n),"show-dollars":!1},null,8,["balances"])),r(s)?(d(),y(_,{key:3,loading:"",title:"Debt",style:w(`grid-area: debt; min-height: ${r(S)}`)},null,8,["style"])):(d(),y($,{key:2,style:{"grid-area":"debt"},title:"Debt",balances:r(o),"show-dollars":!1},null,8,["balances"]))])])}}}),xe=H(be,[["__scopeId","data-v-4aad93f4"]]);export{xe as default};
